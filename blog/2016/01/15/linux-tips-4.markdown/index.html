
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Linux Tips(4) - Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="### 1. Run ansible commands
Run commands in all hosts: ```
# ansible all -i inventory.ini -m command -u root --args "uptime"
``` ### 2. mesos &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/blog/2016/01/15/linux-tips-4.markdown">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//fonts.googleapis.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Linux Tips(4)</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-15T18:37:03+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>6:37 pm</span></time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content">### 1. Run ansible commands
Run commands in all hosts:    

```
# ansible all -i inventory.ini -m command -u root --args "uptime"
```

### 2. mesos introduction
[http://www.infoq.com/cn/articles/analyse-mesos-part-02](http://www.infoq.com/cn/articles/analyse-mesos-part-02)    

### 3. Limit ansible run hosts

```
# ansible-playbook -i inventory_mesos_cluster changehostname.yml -u root -k
-vvvv --list-hosts

playbook: changehostname.yml

  play #1 (master1): host count=1
    10.47.58.31

#  ansible-playbook -i
inventory_mesos_cluster changehostname.yml -u root -k -vvvv --limit="master1"

```

### 4. Configure the dhcp configuration of libvirtd
First edit the net configuration:    

```
# virsh net-edit xxxxx
```

![/images/2016_01_16_20_23_08_715x270.jpg](/images/2016_01_16_20_23_08_715x270.jpg)    
### 5. Copy items into clipboard in vim
Hit `Ctrl+v` to visual model, then select the items you want to copy, after select
them, click `"*y` will copy whatever you selected into your clipbard.     

Copy from clipboard---- simply hit `p` in command mode.    

### 6. mesos.cli
When you meet `no module named mesos`, install it via pip:    

```
$ pip install mesos.cli
```

### 7. Startdict In Command Line

```
$ sudo apt-get install -y sdcv
$ wget
https://web.archive.org/web/20140917131745/http://abloz.com/huzheng/stardict-dic/dict.org/stardict-dictd_www.dict.org_gcide-2.4.2.tar.bz2
$ sudo mkdir -p /usr/share/stardict/dic/
$ sudo tar xjvf stardict-dictd_www.dict.org_gcide-2.4.2.tar.bz2 -C /usr/share/stardict/dic 

```

### 8. Golden Dict
Golden Dict.   

### 9. Latest Info On OpenStack
[https://mp.weixin.qq.com/s?__biz=MzA3MjkwMDY5OA==&mid=404253985&idx=1&sn=0d6c544dfb129e35bde7d19a0de8887b&scene=1&srcid=01267Etq7arAdYaFqbUG5BNa&pass_ticket=qT7Nk3zsTIegBKqnPTUL%2FTtS%2FMNDH%2F07Fz%2Bfua9RcTwSHVO5OLo5wDpfeb%2FBLCEH#rd](https://mp.weixin.qq.com/s?__biz=MzA3MjkwMDY5OA==&mid=404253985&idx=1&sn=0d6c544dfb129e35bde7d19a0de8887b&scene=1&srcid=01267Etq7arAdYaFqbUG5BNa&pass_ticket=qT7Nk3zsTIegBKqnPTUL%2FTtS%2FMNDH%2F07Fz%2Bfua9RcTwSHVO5OLo5wDpfeb%2FBLCEH#rd)    

### 10. Quickly Configure vagrant machine
Via following you could get outside world:     

```
ip route del default gw 10.0.2.2 dev enp0s3
ip a del 192.168.10.199/24 dev enp0s8
ip a add 192.168.10.199/16 dev enp0s8
ip route add default via 192.168.0.79 dev enp0s8
```

### 11. Change the default gateway On CentOS 7
Default gateway should go here:    

```
$ cat /etc/sysconfig/network
# Created by anaconda
GATEWAY=192.168.0.79
```

And remove the origin default gateway by adding following definitions :    

```
$ cat /etc/sysconfig/network-scripts/ifcfg-enp0s3 
# Generated by dracut initrd
NAME="enp0s3"
DEVICE="enp0s3"
BOOTPROTO=dhcp
# This one is not the default gw
DEFROUTE=no
# Do not override the dns
PEERDNS=no
```
Thus the default gateway won't go from enp0s3, but from enp0s8, won't configure the dns
address to 10.0.x.x.    

### 12. On VPNs

```
http://linsir.org/post/how_to_install_IPSec_IKEV2_base_on_strongswan_with_CentOS7
https://quericy.me/blog/512
https://quericy.me/blog/699
http://lifehacker.io/post/108814979111/%E5%9C%A8%E6%90%AC%E7%93%A6%E5%B7%A5%E7%9A%84centos7%E4%B8%8B%E6%90%AD%E5%BB%BAstrongswan%E5%AE%9E%E7%8E%B0%E5%9C%A8ios%E4%B8%8A%E6%8C%89%E9%9C%80%E8%BF%9E%E6%8E%A5vpn
https://raymii.org/s/tutorials/IPSEC_vpn_with_CentOS_7.html
https://linux.cn/article-5938-weibo.html
```

MMC snap-in:    
[https://technet.microsoft.com/en-us/library/cc722035.aspx](https://technet.microsoft.com/en-us/library/cc722035.aspx)    

### 13. Use iptables On CentOS7
Use  following steps for disable firewalld and use iptables.    

```
$ systemctl stop firewalld
$ systemctl mask firewalld
$ yum install iptables-services
$ systemctl enable iptables
$ systemctl start iptables

```

### 14. Quickly Goes kernel configuration
When you want to configure the newer kernel source tree using your old kernel
configuration, simply do following:    

```
# yes "" | make oldconfig
```

### 15. iptables problem
After installing the newest kernel, I cannot use iptables, showing ` can't initialize iptables : table does not exist`.       

Solution: compile the modules again, select nat.     

![/images/2016_01_28_16_05_52_496x361.jpg](/images/2016_01_28_16_05_52_496x361.jpg)    

Selecting from:     
Networking Support    
Network Options     
Network packet filtering framework(Netfilter)    
IP: Netfilter Configuration    


Then you should `make modules_install` under your kernel source building directory.     

### 16. DistCC For Building Kernel DEB
On configurating distcc:    
[http://linuxdeveloper.blogspot.tw/2012/03/distributed-kernel-compilation-in.html](http://linuxdeveloper.blogspot.tw/2012/03/distributed-kernel-compilation-in.html)    

On building Linux kernel deb files:    

[http://www.cyberciti.biz/faq/debian-ubuntu-building-installing-a-custom-linux-kernel/](http://www.cyberciti.biz/faq/debian-ubuntu-building-installing-a-custom-linux-kernel/)     

And:    

[https://help.ubuntu.com/community/Kernel/Compile](https://help.ubuntu.com/community/Kernel/Compile)     

Actual command:    

```
$ time sudo make -j12 CC=distcc
$ sudo MAKEFLAGS="CC=distcc" make-kpkg --rootcmd fakeroot --initrd --append-to-version=-suspend2 kernel-image kernel-headers kernel-source -j16
```

Really takes long time for building the kernel out, but the iptables won't works.    


### 17. dmenu On Ubuntu
dmenu is in the package of suckless-tools.    

```
$ sudo apt-get install suckless-tools
```

### 18. Virtio-GPU How-to
[https://www.kraxel.org/blog/2015/06/virtio-gpu-on-the-way-upstream/](https://www.kraxel.org/blog/2015/06/virtio-gpu-on-the-way-upstream/)    

### 20. Use Latest Dev Kernel On Fedora
Refers to
[http://fedoraproject.org/wiki/Kernel_Vanilla_Repositories](http://fedoraproject.org/wiki/Kernel_Vanilla_Repositories)     

```
$ curl -s https://repos.fedorapeople.org/repos/thl/kernel-vanilla.repo | sudo tee /etc/yum.repos.d/kernel-vanilla.repo
$ sudo dnf --enablerepo=kernel-vanilla-mainline update
```

Fall back to the stable one:    

```
$ sudo dnf --enablerepo=kernel-vanilla-stable update
```

### 21. Install grub on usb disk/ArchLinux

```
# chattr -i /boot/grub/i386-pc/core.img 
# grub-install --target=i386-pc --recheck --debug --force /dev/sdb
# chattr +i /boot/grub/i386-pc/core.img 
```
### 22. fcitx-gtk3
Since now firefox using gtk3, so if you want to input chinese in firefox, simply install `fcitx-gtk3` then you get fcitx working.     

### 23. Polkit And Virt-manager
Problem:    

```
$ virsh -c qemu:///system
error: failed to connect to the hypervisor
error: authentication failed: no agent is available to authenticate
```

Add the configuration for the polkit and restart the service:    

```
$ sudo vim /etc/polkit-1/rules.d/49-org.libvirt.unix.manager.rules
polkit.addRule(function(action, subject) {
    if (action.id == "org.libvirt.unix.manage" &&
        subject.isInGroup("kvm")) {
            return polkit.Result.YES;
        }
});
```

And also you have to add your current user into the group of `kvm`:    

```
$ sudo usermod -a -G kvm <user name>
```

Restar the polkit service via:    

```
$ sudo systemctl restart polkit.service
```

### 24. Running tasks in byobu
[http://superuser.com/questions/623432/transfer-current-command-to-a-detachable-session-tmux-screen](http://superuser.com/questions/623432/transfer-current-command-to-a-detachable-session-tmux-screen)    

### 25. GPU Pass-Through
[http://www.gitztalk.com/posts/2014/06/30/gaming-in-a-vm/](http://www.gitztalk.com/posts/2014/06/30/gaming-in-a-vm/)    

### 26. yaourt build error
Reason: gpg checking error, solution is:    

```
$ proxychains4 gpg --recv-key  79BE3E4300411886
```

### 27. libvirtd and polkit
Bypass the password prompt:    

[https://wiki.archlinux.org/index.php/Polkit#Bypass_password_prompt](https://wiki.archlinux.org/index.php/Polkit#Bypass_password_prompt)     


### 28. virgl repository
[https://www.kraxel.org/repos/](https://www.kraxel.org/repos/)    

### 29. pass-through howto
[http://vfio.blogspot.com.au/2015/05/vfio-gpu-how-to-series-part-3-host.html](http://vfio.blogspot.com.au/2015/05/vfio-gpu-how-to-series-part-3-host.html)     

### 30. Control the USB port power
[http://stackoverflow.com/questions/4702216/controlling-a-usb-power-supply-on-off-with-linux](http://stackoverflow.com/questions/4702216/controlling-a-usb-power-supply-on-off-with-linux)     

### 31. On how to reverse usb device
[http://www.linuxjournal.com/article/7353?page=0,0](http://www.linuxjournal.com/article/7353?page=0,0)    
[https://www.reddit.com/r/linuxmasterrace/comments/2zveiw/question_about_wine/](https://www.reddit.com/r/linuxmasterrace/comments/2zveiw/question_about_wine/)    

### 32. Set/Unset keyboard LED
Turn on/off the Scroll LED of the keyboard(USB):    

```
xset led 3
xset -led 3
```

### 33. USB In a NutShell
[http://www.beyondlogic.org/usbnutshell/usb1.shtml](http://www.beyondlogic.org/usbnutshell/usb1.shtml)    

### 34. Arduino USB Tutorial
[http://codeandlife.com/2012/01/22/avr-attiny-usb-tutorial-part-1/](http://codeandlife.com/2012/01/22/avr-attiny-usb-tutorial-part-1/)     

### 35. Auduino USB Project
[https://www.obdev.at/products/vusb/projects.html](https://www.obdev.at/products/vusb/projects.html)    

### 36. Detecting mouse events
Using evtest for detecting mouse events:    

```
$ sudo apt-get install evtest
$ sudo evtest
```

### 37. SteelSeries Mouse (RAW) DEMO

[https://www.youtube.com/watch?v=yvvybR6oyvs](https://www.youtube.com/watch?v=yvvybR6oyvs)    

### 38. USB Device Driver
[http://blog.chinaunix.net/uid-20587912-id-2984380.html](http://blog.chinaunix.net/uid-20587912-id-2984380.html)    

[http://www.wzona.info/2012/10/usb-duomenu-perdavimas-atmega.html](http://www.wzona.info/2012/10/usb-duomenu-perdavimas-atmega.html)   


### 39. Reverse usb device driver
[http://phoeagon.byethost15.com/2012/05/05/%e7%bb%99%e6%9d%82%e7%89%8c%e5%b9%bb%e7%81%af%e7%89%87usb%e9%81%a5%e6%8e%a7%e5%86%99linux%e9%a9%b1%e5%8a%a8-%e4%b8%8a/](http://phoeagon.byethost15.com/2012/05/05/%e7%bb%99%e6%9d%82%e7%89%8c%e5%b9%bb%e7%81%af%e7%89%87usb%e9%81%a5%e6%8e%a7%e5%86%99linux%e9%a9%b1%e5%8a%a8-%e4%b8%8a/)    

[http://www.phoronix.com/scan.php?page=news_item&px=MTEzODU](http://www.phoronix.com/scan.php?page=news_item&px=MTEzODU)    


[https://bbs.archlinux.org/viewtopic.php?id=187995](https://bbs.archlinux.org/viewtopic.php?id=187995)    

[https://www.youtube.com/watch?v=GdvmsWnZkyc](https://www.youtube.com/watch?v=GdvmsWnZkyc)    

[https://learn.adafruit.com/hacking-the-kinect/more-kinect-information](https://learn.adafruit.com/hacking-the-kinect/more-kinect-information)   

[https://www.linuxvoice.com/drive-it-yourself-usb-car-6/](https://www.linuxvoice.com/drive-it-yourself-usb-car-6/)    

Total Phase USB:    

[http://www.totalphase.com/products/beagle-usb12/](http://www.totalphase.com/products/beagle-usb12/)    

[https://github.com/dmage/co2mon](https://github.com/dmage/co2mon)    

### 40. v-usb tutorial
[http://www.workinprogress.ca/v-usb-tutorial-software-only-usb-for-mega-tiny/](http://www.workinprogress.ca/v-usb-tutorial-software-only-usb-for-mega-tiny/)    

### 41. v-usb and Arduino
[https://www.hackster.io/rayburne/arduino-to-excel-using-v-usb-cbf701](https://www.hackster.io/rayburne/arduino-to-excel-using-v-usb-cbf701)   

[http://www.geek-workshop.com/forum.php?mod=viewthread&tid=8578&highlight=v-usb](http://www.geek-workshop.com/forum.php?mod=viewthread&tid=8578&highlight=v-usb)    

[http://coopermaa2nd.blogspot.tw/2011/10/v-usb-examples-for-arduino.html](http://coopermaa2nd.blogspot.tw/2011/10/v-usb-examples-for-arduino.html)    

[http://www.geek-workshop.com/thread-1137-1-1.html](http://www.geek-workshop.com/thread-1137-1-1.html)    

[http://www.geek-workshop.com/forum.php?mod=viewthread&tid=15114&highlight=v-usb](http://www.geek-workshop.com/forum.php?mod=viewthread&tid=15114&highlight=v-usb)    

### 42.Set Timezone of the ArchLinux
Change from UTC to Asia/Shanghai:    

```
$ timedatectl set-timezone Asia/Shanghai
```

### 43. Empty all of the bash history
Empty the bash history via:    

```
$ rm -f ~/.bash_history
```

### 44. Specify qemu-binary in Packer.io
Edit the json files:    

```
"builders":
[
{
"type": "qemu",
"qemu_binary" : "/usr/libexec/qemu-kvm.sh",
```

### 45. apprmor.d

```
I modified /etc/apparmor.d/abstractions/libvirt-qemu to include the
backing store directory
```

### 46. Recover UEFI bootloader
After remove the mainline linux kernel, the archlinux is using the default kernel, but
the UEFI bootloader didn't notice this, following are the steps for recover the UEFI
bootloader.     

```
grub-install --target=x86_64-efi --efi-directory=/boot/EFI   --bootloader-id=arch_grub --recheck
cat ./EFI/loader/entries/arch.conf
```
Change the items into `initramfs-linux`.     

If you cannot login to the system, you could start the machine via USB disk or
installation media, using `arch-chroot /mnt/ /bin/bash` for login to the chroot system,
then do the above operations.   

### 47. bonding
[http://sanswers.com/tube/wotC5GZ2FV0/bonding-eth0-and-wlan0-on-arch-linux](http://sanswers.com/tube/wotC5GZ2FV0/bonding-eth0-and-wlan0-on-arch-linux)    

### 48. Fix currpted zsh history 
history corrupted.    

```
$ mv .zsh_history .zsh_history_bad
$ strings .zsh_history_bad > .zsh_history
$ fc -R .zsh_history
```

### 49. pulp
Using pulp for managing the repositories of RPM/Docker, etc.    

### 50. Chromium flash
Install chromium-pepper-flash in aur.    

### 51. Install xfce4 on CentOS
Install xfce in epel repository via:    

```
# yum --enablerepo=epel -y groups install "Xfce" 
```

### 52. LED controller
[http://www.seeedstudio.com/recipe/402-smart-power-outlet.html](http://www.seeedstudio.com/recipe/402-smart-power-outlet.html)     

### 53. Build php envs
[https://medium.com/dev-tricks/apache-and-php-on-docker-44faef716150#.c8bguolj0](https://medium.com/dev-tricks/apache-and-php-on-docker-44faef716150#.c8bguolj0)   

### 54. handle docker changes
[http://dbaron.org/linux/handle-dock-change.py](http://dbaron.org/linux/handle-dock-change.py)    

### 55. python detection of usb storage
[https://linuxmeerkat.wordpress.com/2014/11/12/python-detection-of-usb-storage-device/](https://linuxmeerkat.wordpress.com/2014/11/12/python-detection-of-usb-storage-device/)    
d-feet for debugging of dbus..       

<<<<<<< HEAD
### 56. libmtp related
Install `gvfp-mtp`, then you could get your nautillus have the mtp device
support.     

Using `mtp-detect` for detecting the equipments and `mtp-connect` for
connecting the device.    
=======
### 55. Virtualbox Driver Issue
After upgrading the system, the virtualbox won't start the machine, this is because we
didn't install the kernel header, thus the dkms won't be run after system upgrading.
Install kernel-headers:    

```
$ sudo pacman -S linux-headers
$ sudo /sbin/rcvboxdrv setup
``` 
>>>>>>> a1f598b4a14cb4ed25034e682d6d400238fb5f21
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Dash</span></span>

           




<time class='entry-date' datetime='2016-01-15T18:37:03+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>6:37 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/linux/'>linux</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <br />
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/01/15/linux-tips-4/" title="Previous Post: Linux Tips(4)">&laquo; Linux Tips(4)</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/01/15/linux-tips-4.markdown~/" title="Next Post: Linux Tips(4)">Linux Tips(4) &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/03/23/setup-vagrant-libvirt-env-on-ubuntu15-dot-04/">Setup Vagrant-libvirt Env on Ubuntu15.04</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/21/use-vagrant-to-manage-xenserver/">Use Vagrant to Manage XenServer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/17/tips-on-5050rgb-2/">Tips on 5050RGB(2)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/16/vagrant-libvirt-playing/">Vagrant-libvirt Playing</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/15/ba-wan-ebuddy-4/">把玩ebuddy(4)</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://purplepalmdash.github.io/blog/2016/01/15/linux-tips-4.markdown/';
        var disqus_url = 'http://purplepalmdash.github.io/blog/2016/01/15/linux-tips-4.markdown/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>

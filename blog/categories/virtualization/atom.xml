<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Virtualization | Dash]]></title>
  <link href="http://purplepalmdash.github.io/blog/categories/virtualization/atom.xml" rel="self"/>
  <link href="http://purplepalmdash.github.io/"/>
  <updated>2015-12-16T12:20:03+08:00</updated>
  <id>http://purplepalmdash.github.io/</id>
  <author>
    <name><![CDATA[Dash]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[OpenVswitch on Ubuntu14.04]]></title>
    <link href="http://purplepalmdash.github.io/blog/2015/12/10/openvswitch-on-ubuntu14-dot-04/"/>
    <updated>2015-12-10T15:33:24+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2015/12/10/openvswitch-on-ubuntu14-dot-04</id>
    <content type="html"><![CDATA[<h3>Installation</h3>

<p>Install openvswitch via:</p>

<pre><code># apt-get update
# apt-get install -y openvswitch-common openvswitch-switch
</code></pre>

<p>List the installed module via:</p>

<pre><code># lsmod | grep open
openvswitch            66901  0 
gre                    13808  1 openvswitch
vxlan                  37619  1 openvswitch
libcrc32c              12644  1 openvswitch
# ovs-vsctl --version
ovs-vsctl (Open vSwitch) 2.0.2
Compiled May 13 2015 18:49:53
</code></pre>

<h3>Configuration</h3>

<p>Edit the configuration of the networking:</p>

<pre><code>$ sudo vim /etc/network/interfaces
###########################################
## By using openVswitch, we enabled the following
###########################################
auto ovsbr0
iface ovsbr0 inet static
address 192.168.1.xx
netmask 255.255.0.0
gateway 192.168.1.xx
dns-nameservers 223.5.5.5 180.76.76.76
</code></pre>

<p>Now configure the ovs-switched bridge:</p>

<pre><code># ovs-vsctl add-br ovsbr0
# ovs-vsctl list-br
ovsbr0
# ovs-vsctl add-port ovsbr0 eth0 &amp;&amp; reboot
</code></pre>

<p>Now restart the computer you will get the ovs-bridged network running.</p>

<h3>Bridged With VLAN</h3>

<p>Add/Remove port of the ovs-bridged:</p>

<pre><code># ovs-vsctl add-port ovsbr0 tap0 tag=22
# ovs-vsctl show
901c2b29-0764-4370-8d06-168b18339236
    Bridge "ovsbr0"
        Port "eth0"
            Interface "eth0"
        Port "tap0"
            tag: 22
            Interface "tap0"
        Port "ovsbr0"
            Interface "ovsbr0"
                type: internal
    ovs_version: "2.0.2"
# ovs-vsctl del-port ovsbr0 tap0
</code></pre>

<p>If you want to remove the tag, then:</p>

<pre><code>ovs-vsctl set port vnet0 tag=100
ovs-vsctl remove port vnet0 tag 100
</code></pre>

<h3>VLAN / OpenVswitch/ virt-manager</h3>

<p>Dumpxml will displayed as following:</p>

<pre><code>    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:0e:6b:d1'/&gt;
      &lt;source bridge='ovsbr0'/&gt;
      &lt;vlan trunk='yes'&gt;
        &lt;tag id='22' nativeMode='untagged'/&gt;
      &lt;/vlan&gt;
      &lt;virtualport type='openvswitch'&gt;
        &lt;parameters interfaceid='d5b7b981-8998-44c0-9344-0ade6b69ec1f'/&gt;
      &lt;/virtualport&gt;
      &lt;target dev='vnet0'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:3c:c9:24'/&gt;
      &lt;source bridge='ovsbr0'/&gt;
      &lt;vlan trunk='yes'&gt;
        &lt;tag id='100' nativeMode='untagged'/&gt;
      &lt;/vlan&gt;
      &lt;virtualport type='openvswitch'&gt;
        &lt;parameters interfaceid='06898d54-c0da-48c6-8b01-3307e70b995a'/&gt;
      &lt;/virtualport&gt;
      &lt;target dev='vnet1'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;alias name='net1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:7b:e7:b0'/&gt;
      &lt;source bridge='ovsbr0'/&gt;
      &lt;virtualport type='openvswitch'&gt;
        &lt;parameters interfaceid='303c1f65-23ff-4017-93ba-f196ca1d05fb'/&gt;
      &lt;/virtualport&gt;
      &lt;target dev='vnet2'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;alias name='net2'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
    &lt;/interface&gt;
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tessera How-to]]></title>
    <link href="http://purplepalmdash.github.io/blog/2015/12/08/tessera-how-to/"/>
    <updated>2015-12-08T10:26:48+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2015/12/08/tessera-how-to</id>
    <content type="html"><![CDATA[<h3>Installation</h3>

<p>Installation steps are listed as following:</p>

<pre><code># apt-get install -y python-virtualenv
# git clone git@github.com:urbanairship/tessera.git
# cd tessera
# virtualenv .
# . bin/activate
# cd tessera-server/
# pip install -r requirements.txt
# pip install -r dev-requirements.txt
# cd ../tessera-frontend
# apt-get install -y npm
# npm install -g grunt-cli
# npm install
# ln -s /usr/bin/nodejs /usr/bin/node
# grunt
# which inv
/root/Code/second/tessera/bin/inv
</code></pre>

<h3>Start</h3>

<p>Start the service via:</p>

<pre><code># cd /root/Code/second/tessera/tessera-server/
# inv db.init
# inv run &amp;
# inv json.import 'demo/*'
</code></pre>

<p>Open the browser and visit <code>http://localhost:5000</code>, you could see the tessera&rsquo;s web
front.</p>

<p><img src="/images/2015_12_08_11_42_52_998x527.jpg" alt="/images/2015_12_08_11_42_52_998x527.jpg" /></p>

<h3>Import Graphite Data</h3>

<pre><code>(tessera)root@monitorserver:~/Code/second/tessera/tessera-server# vim tessera/config.py 
root@monitorserver:~/Code/second/tessera# cat tessera-server/tessera/config.py
GRAPHITE_URL               = 'http://192.168.10.192'
# inv graphite.import
</code></pre>

<p>Now you could see the imported graphite data.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Spice Client]]></title>
    <link href="http://purplepalmdash.github.io/blog/2015/11/16/spice-client/"/>
    <updated>2015-11-16T21:20:00+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2015/11/16/spice-client</id>
    <content type="html"><![CDATA[<h3>Image Conversion</h3>

<p>Convert the vdi files into qcow2 file:</p>

<pre><code>$ qemu-img convert -f vdi -O qcow2 Windows81.vdi Windows81.qcow2
</code></pre>

<p>Then continue to create the virtual machine via importing the img.</p>

<h3>Spice Client</h3>

<p>Using virtviewer for view the remote machine.</p>

<pre><code>$ sudo pacman -S virtviewer
$ remote-viewer spice://localhost:5900
</code></pre>

<p>Or you could view the desktop via <code>spicec</code>.</p>

<p>The listening port could be view via <code>netstat -anp | grep 5900</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Moving CloudStack From VM to Physical Node]]></title>
    <link href="http://purplepalmdash.github.io/blog/2015/11/01/moving-cloudstack-from-vm-to-physical-node/"/>
    <updated>2015-11-01T08:52:08+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2015/11/01/moving-cloudstack-from-vm-to-physical-node</id>
    <content type="html"><![CDATA[<h3>AIM</h3>

<p>To move the All-In-One CloudStack environment from kvm VM based to physical
machine.</p>

<h3>Copy VM Disk</h3>

<h3>Based On Ubuntu15.04</h3>

<p>First get all of the deb file from
<code>http://cloudstack.apt-get.eu/ubuntu/dists/trusty/4.5/pool/</code></p>

<p>Then setup a local repository, edit its <code>/etc/apt/sources.list</code> file:</p>

<pre><code># vim /etc/apt/sources.list
deb http://192.168.1.13/        cloudstackdeb/
</code></pre>

<p>Problem, For we have setup the ovsbr0 on Ubuntu15.04, how to solve its
networking together with cloudstack?</p>

<h3>Newly installed CentOS7</h3>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Thinking in VR]]></title>
    <link href="http://purplepalmdash.github.io/blog/2015/10/29/thinking-in-vr/"/>
    <updated>2015-10-29T16:00:39+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2015/10/29/thinking-in-vr</id>
    <content type="html"><![CDATA[<p>Restriction of the connections.</p>

<pre><code>http://www.cnblogs.com/cmt/archive/2013/03/13/2957583.html
http://bbs.m0n0china.org/viewthread.php?tid=16459
http://my.oschina.net/u/1169079/blog/397705
</code></pre>
]]></content>
  </entry>
  
</feed>

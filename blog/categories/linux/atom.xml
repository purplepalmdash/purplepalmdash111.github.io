<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Linux | Dash]]></title>
  <link href="http://purplepalmdash.github.io/blog/categories/linux/atom.xml" rel="self"/>
  <link href="http://purplepalmdash.github.io/"/>
  <updated>2016-05-28T23:36:23+08:00</updated>
  <id>http://purplepalmdash.github.io/</id>
  <author>
    <name><![CDATA[Dash]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Working Tips on Ansible-cobbler(3)]]></title>
    <link href="http://purplepalmdash.github.io/blog/2016/05/18/working-tips-on-ansible-cobbler-3/"/>
    <updated>2016-05-18T21:15:10+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2016/05/18/working-tips-on-ansible-cobbler-3</id>
    <content type="html"><![CDATA[<h3>APT Packages</h3>

<p>The downloaded deb files should be under <code>/var/cache/apt</code>, use following command for copying to
another position:</p>

<pre><code>$ find . | grep -i deb$ | xargs % cp % ~/Dest_Folder
$ scp -r ~/Dest_Folder Your_Cobbler_Machine
</code></pre>

<h3>Repositories</h3>

<p>Install <code>dpkg-dev</code> package, so we could generate the dpkg packages:</p>

<pre><code>$ sudo apt-get install -y dpkg-dev
</code></pre>

<p>Create a new repository:</p>

<p><img src="/images/2016_05_18_21_28_37_717x452.jpg" alt="/images/2016_05_18_21_28_37_717x452.jpg" /></p>

<p>Edit the advanced options:</p>

<p><img src="/images/2016_05_18_21_30_04_508x314.jpg" alt="/images/2016_05_18_21_30_04_508x314.jpg" /></p>

<p>Report the repository info via:</p>

<pre><code>root@cobbler-ubuntu:~# cobbler repo report --name=ubuntu1604Mate
Name                           : ubuntu1604Mate
Apt Components (apt only)      : ['main']
Apt Dist Names (apt only)      : ['stable']
Arch                           : x86_64
Breed                          : apt
Comment                        : Ubuntu 16.04 Repository For installing MATE
Createrepo Flags               : &lt;&lt;inherit&gt;&gt;
Environment Variables          : {}
Keep Updated                   : False
Mirror                         : 
Mirror locally                 : True
Owners                         : ['admin']
Priority                       : 99
External proxy URL             : 
RPM List                       : []
Yum Options                    : {}
</code></pre>

<p>Repository Structure Creation:</p>

<pre><code>$ mkdir /srv/www/cobbler/repo_mirror/ubuntu1604Mate
$ cd /srv/www/cobbler/repo_mirror/ubuntu1604Mate
$ mkdir -p pool/main dists/stable/main/binary-i386 dists/stable/main/binary-amd64
$ cp ~/apt/debs/*.deb ./pool/main/
</code></pre>

<p>Enable the <code>allow_unauthenticated</code> options in kickstart file:</p>

<pre><code>$ vim /var/lib/cobbler/kickstarts/sample.seed
 d-i debian-installer/allow_unauthenticated boolean true
</code></pre>

<p>Generate the gpg key:</p>

<pre><code># gpg --gen-key
  gpg (GnuPG) 2.0.14; Copyright (C) 2009 Free Software Foundation, Inc.
  This is free software: you are free to change and redistribute it.
  There is NO WARRANTY, to the extent permitted by law.

  gpg: directory `/root/.gnupg' created
  gpg: new configuration file `/root/.gnupg/gpg.conf' created
  gpg: WARNING: options in `/root/.gnupg/gpg.conf' are not yet active during this run
  gpg: keyring `/root/.gnupg/secring.gpg' created
  gpg: keyring `/root/.gnupg/pubring.gpg' created
 Please select what kind of key you want:
    (1) RSA and RSA (default)
    (2) DSA and Elgamal
    (3) DSA (sign only)
    (4) RSA (sign only)
 Your selection? 1
 RSA keys may be between 1024 and 4096 bits long.
 What keysize do you want? (2048)
 Requested keysize is 2048 bits
 Please specify how long the key should be valid.
          0 = key does not expire
       &lt;n&gt;  = key expires in n days
       &lt;n&gt;w = key expires in n weeks
       &lt;n&gt;m = key expires in n months
       &lt;n&gt;y = key expires in n years
 Key is valid for? (0)
 Key does not expire at all
 Is this correct? (y/N) y
</code></pre>

<p>For generating the random key, install the <code>haveged</code> in system:</p>

<pre><code>$ sudo aptitude install haveged
</code></pre>

<p>List the keys via:</p>

<pre><code># gpg --list-keys
/home/vagrant/.gnupg/pubring.gpg
--------------------------------
pub   2048R/16D87321 2016-05-18
uid                  xxxxx &lt;xxxxxx@gmail.com&gt;
sub   2048R/8C4A318A 2016-05-18
</code></pre>

<p>Generate the pgp signature via:</p>

<pre><code># gpg --export -a 16D87321&gt;~/junk.key
# gpg --no-default-keyring --keyring /srv/www/cobbler/repo_mirror/ubuntu1604Mate/public.pgp --import ~/junk.key
# rm -f ~/junk.key
# chmod a+r /srv/www/cobbler/repo_mirror/ubuntu1604Mate/public.pgp
</code></pre>

<p>Re-Generate the repository infos via:</p>

<pre><code>$ cd /srv/www/cobbler/repo_mirror/ubuntu1604Mate/
$ vim reindex_apt.sh
$ chmod 777 reindex_apt.sh 
$ ./reindex_apt.sh 
</code></pre>

<p>The content of <code>reindex_apt.sh</code> is listed as following:</p>

<pre><code>#!/bin/bash

GPG_NAME=16D87321
REPONAME=stable
VERSION=1.0

for bindir in `find dists/${REPONAME} -type d -name "binary*"`; do
    arch=`echo $bindir|cut -d"-" -f 2`
    echo "Processing ${bindir} with arch ${arch}"

    overrides_file=/tmp/overrides
    package_file=$bindir/Packages
    release_file=$bindir/Release

    # Create simple overrides file to stop warnings
    cat /dev/null &gt; $overrides_file
    for pkg in `ls pool/main/ | grep -E "(all|${arch})\.deb"`; do
        pkg_name=`/usr/bin/dpkg-deb -f pool/main/${pkg} Package`
        echo "${pkg_name} Priority extra" &gt;&gt; $overrides_file
    done

    # Index of packages is written to Packages which is also zipped
    dpkg-scanpackages -a ${arch} pool/main $overrides_file &gt; $package_file
    # The line above is also commonly written as:
    # dpkg-scanpackages -a ${arch} pool/main /dev/null &gt; $package_file
    gzip -9c $package_file &gt; ${package_file}.gz
    bzip2 -c $package_file &gt; ${package_file}.bz2

    # Cleanup
    rm $overrides_file
done

# Release info goes into Release &amp; Release.gpg which includes an md5 &amp; sha1 hash of Packages.*
# Generate &amp; sign release file
cd dists/${REPONAME}
cat &gt; Release &lt;&lt;ENDRELEASE
Suite: ${REPONAME}
Version: ${VERSION}
Component: main
Origin: somewhere
Label: ubuntu1604Mate
Architecture: i386 amd64
Date: `date`
ENDRELEASE

# Generate hashes
echo "MD5Sum:" &gt;&gt; Release
for hashme in `find main -type f`; do
    md5=`openssl dgst -md5 ${hashme}|cut -d" " -f 2`
    size=`stat -c %s ${hashme}`
    echo " ${md5} ${size} ${hashme}" &gt;&gt; Release
done
echo "SHA1:" &gt;&gt; Release
for hashme in `find main -type f`; do
    sha1=`openssl dgst -sha1 ${hashme}|cut -d" " -f 2`
    size=`stat -c %s ${hashme}`
    echo " ${sha1} ${size} ${hashme}" &gt;&gt; Release
done

# Sign!
gpg --yes -u $GPG_NAME --sign -bao Release.gpg Release
cd -
</code></pre>

<p>Now continue to modify the kickstart file for using the generated gpgs:</p>

<pre><code># pwd
/var/lib/cobbler/snippets
# cp preseed_apt_repo_config preseed_apt_repo_config_pgpkey
</code></pre>

<p>The <code>preseed_apt_repo_config_pgpkey</code> should be listed as following:</p>

<pre><code># Additional repositories, local[0-9] available
#set $cur=1
#set $repo_data = $getVar("repo_data",[])
#for $repo in $repo_data
 #for $dist in $repo.apt_dists
 #set $comps = " ".join($repo.apt_components)
d-i apt-setup/local${cur}/repository string \
 #if $repo.mirror_locally
      http://$http_server/cblr/repo_mirror/${repo.name} $dist $comps
 #else
      ${repo.mirror} $dist $comps
 #end if
 #if $repo.comment != ""
d-i apt-setup/local${cur}/comment string ${repo.comment}
 #end if
 #if $repo.breed == "src"
# Enable deb-src lines
d-i apt-setup/local${cur}/source boolean false
 #end if
+++ # Add repo pgp pub key
+++ d-i apt-setup/local${cur}/key string \
+++       http://$http_server/cblr/repo_mirror/${repo.name}/public.pgp
 #set $cur=$cur+1
 #end for
#end for
</code></pre>

<p>Using the new preseed file, and changint the <code>preseed_apt_repo_config_pgpkey</code>:</p>

<pre><code># pwd
/var/lib/cobbler/kickstarts
# cp sample.seed ubuntu1604.seed
# vim ubuntu1604.seed
-  $SNIPPET('preseed_apt_repo_config')
+  $SNIPPET('preseed_apt_repo_config_pgpkey')
</code></pre>

<p>Changing the seed in the <code>cobbler_web</code>:</p>

<p><img src="/images/2016_05_18_22_25_48_732x294.jpg" alt="/images/2016_05_18_22_25_48_732x294.jpg" /></p>

<p>Use <code>cobbler sync</code> for syncing the configuration.</p>

<h3>Use the Repository</h3>

<p>Add the <code>ubuntu1604Mate</code> into the Repos:</p>

<p><img src="/images/2016_05_18_22_31_42_731x486.jpg" alt="/images/2016_05_18_22_31_42_731x486.jpg" /></p>

<p>After added, the configuration should be:</p>

<p><img src="/images/2016_05_18_22_33_00_471x149.jpg" alt="/images/2016_05_18_22_33_00_471x149.jpg" /></p>

<p>Now <code>cobbler sync</code> for syncing the configuration.</p>

<p>Bug: you should move the <code>preseed_apt_repo_config</code> and  then <code>cobbler sync</code> then your deployment will be OK:</p>

<pre><code>$ mv /var/lib/cobbler/snippets/preseed_apt_repo_config /root/
$ cobbler sync
</code></pre>

<h3>Added Mate Installation</h3>

<p>Configure the preseed late:</p>

<pre><code># cp /var/lib/cobbler/scripts/preseed_late_default /var/lib/cobbler/scripts/preseed_late_default_mate
# vim /var/lib/cobbler/scripts/preseed_late_default_mate
# vim preseed_late_default_mate 
$SNIPPET('post_install_network_config_deb')
$SNIPPET('late_apt_repo_config')
$SNIPPET('post_run_deb')
$SNIPPET('download_config_files')
+ $SNIPPET('ubuntumate')
$SNIPPET('kickstart_done')
</code></pre>

<p>Now add the snippet of <code>ubuntumate</code>:</p>

<pre><code># cat ../snippets/ubuntumate 
echo "debconf debconf/frontend select noninteractive" | sudo debconf-set-selections
apt-get --allow-unauthenticated update -y
apt-get --allow-unauthenticated upgrade -y
apt-get --allow-unauthenticated install -y build-essential
### apt-get --allow-unauthenticated install -y ubuntu-mate-desktop
apt-get --allow-unauthenticated install -y vim
### apt-get --allow-unauthenticated install -y chromium-browser
### apt-get --allow-unauthenticated install -y meld vim-gtk
### apt-get --allow-unauthenticated install -y evince
### sudo apt-get --allow-unauthenticated install -y language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base
### sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
### sudo localectl set-locale LANG=zh_CN.UTF-8
### # TW/HK language support
### sudo apt-get --allow-unauthenticated install -y language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base
### sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
### apt-get --allow-unauthenticated install -y fcitx
### apt-get --allow-unauthenticated install -y fcitx-table-wubi fcitx-table-wubi-large
### apt-get --allow-unauthenticated install -y fcitx-googlepinyin
### apt-get --allow-unauthenticated install -y gimp
### apt-get --allow-unauthenticated install -y ibus-pinyin 
### apt-get --allow-unauthenticated install -y thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca 
### apt-get --allow-unauthenticated install -y zsh
### apt-get --allow-unauthenticated install -y fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy
### apt-get --allow-unauthenticated install -y eclipse
### apt-get --allow-unauthenticated install -y gpicview
### apt-get --allow-unauthenticated install -y scrot
### apt-get --allow-unauthenticated install -y byobu
### apt-get --allow-unauthenticated install -y subversion git
### apt-get --allow-unauthenticated install -y kdiff3
### apt-get --allow-unauthenticated install -y docker
</code></pre>

<p>Use <code>cobbler sync</code>, and now you could deploy mate desktop via cobbler.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tips on Maas 2.0]]></title>
    <link href="http://purplepalmdash.github.io/blog/2016/05/12/tips-on-maas-2-dot-0/"/>
    <updated>2016-05-12T14:10:48+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2016/05/12/tips-on-maas-2-dot-0</id>
    <content type="html"><![CDATA[<h3>Installation</h3>

<p>Based on Ubuntu16.04, install maas via:</p>

<pre><code>$ sudo apt-get install -y maas
</code></pre>

<p>After installation, create the default username/password via following command:</p>

<pre><code>$ sudo maas-region createadmin --username=root --email=xxyy@xxyy.com
Password: 
Again: 
</code></pre>

<p>Now you could login to the <code>http://YourIP/MAAS</code> via:</p>

<p><img src="/images/2016_05_12_14_25_12_456x494.jpg" alt="/images/2016_05_12_14_25_12_456x494.jpg" /></p>

<h3>Using API to talk</h3>

<p>In maas cli, using following steps for generate the API key and use:</p>

<pre><code># sudo maas-region apikey --username=root
AYnuZY3gWTnpxJb7Kp:AtDG3yUmaDu8tXGzTc:tumR29xsRGL6A7T6M2G7LTETPP5kkDwC
# maas login mymaas http://10.17.17.2/MAAS/api/2.0
AYnuZY3gWTnpxJb7Kp:AtDG3yUmaDu8tXGzTc:tumR29xsRGL6A7T6M2G7LTETPP5kkDwC

You are now logged in to the MAAS server at
http://10.17.17.2/MAAS/api/2.0/ with the profile name 'mymaas'.

For help with the available commands, try:

  maas mymaas --help
</code></pre>

<p>Later we will use <code>mymaas</code> for talk to MAAS Controller.</p>

<h3>Add Boot Source</h3>

<p>Click <code>Images</code>, you won&rsquo;t see anything because the images are not downloaded. you could
download it manually via following command:</p>

<pre><code>$ sudo apt-get install simplestreams ubuntu-cloudimage-keyring apache2
$ sudo sstream-mirror --keyring=/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg \
https://images.maas.io/ephemeral-v2/daily/ /var/www/html/maas/images/ephemeral-v2/daily \
'arch=amd64' 'subarch~(generic|hwe-t)' 'release~(trusty|precise|xenial)' --max=1
</code></pre>

<p>After downloading, the image content will be available under <code>/var/www/html/</code>.</p>

<p>Or, if you downloaded the html files before, do following steps for using your
pre-downloaded packages:</p>

<pre><code>$ tar xJvf html.tar.bz2 -C /var/www/html/
$ sudo maas mymaas boot-sources create url=http://10.17.17.2/mirror/images/ephemeral-v2/releases/ keyring_filename=/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg 
</code></pre>

<p>Now there are two boot-sources in maas, delete the default one(Because we are in china,
and its goddamned GFW!)</p>

<pre><code>dash@maascontroller:~$ sudo maas mymaas boot-source delete 1
Success.
Machine-readable output follows:

dash@maascontroller:~$ sudo maas mymaas boot-sources read
Success.
Machine-readable output follows:
[
    {
        "keyring_data": "&lt;memory at 0x7f4e9478b288&gt;",
        "resource_uri": "/MAAS/api/2.0/boot-sources/2/",
        "id": 2,
        "url": "http://10.17.17.2/mirror/images/ephemeral-v2/releases/",
        "keyring_filename": "/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg"
    }
$ 
</code></pre>

<p>Import boot-sources via:</p>

<pre><code>$ sudo maas mymaas boot-resources import
</code></pre>

<p>It will takes a little bit time for importing the boot images.</p>

<p>For adding nodes:</p>

<p><a href="https://maas.ubuntu.com/docs2.0/nodes.html">https://maas.ubuntu.com/docs2.0/nodes.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux Tips(5)]]></title>
    <link href="http://purplepalmdash.github.io/blog/2016/05/04/linux-tips-5/"/>
    <updated>2016-05-04T20:03:21+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2016/05/04/linux-tips-5</id>
    <content type="html"><![CDATA[<h3>1. Detach Running Tasks</h3>

<p><code>Ctrl+Z</code> for suspend the tasks, then <code>bg</code> it, now you could use <code>disown %1</code> for
detaching the running process.</p>

<p>Next time you login, you will see this background task is also running.</p>

<h3>2. Installation of Cobbler</h3>

<p>Shell Scripts:</p>

<p><a href="https://gist.github.com/luisbolson/1d0dc42976d2468171d0">https://gist.github.com/luisbolson/1d0dc42976d2468171d0</a></p>

<h3>3. yum groups</h3>

<p><a href="http://ramblings.narrabilis.com/creating-a-yum-repository-repo-and-creating-a-yum-group-to-install-kickstart">http://ramblings.narrabilis.com/creating-a-yum-repository-repo-and-creating-a-yum-group-to-install-kickstart</a></p>

<h3>4. rvm issue</h3>

<p>rvm met <code>openssl.so (LoadError)</code>, could be solved via following steps.</p>

<pre><code>$  curl https://github.com/ruby/ruby/commit/801e1fe46d83c856844ba18ae4751478c59af0d1.diff &gt; openssl.patch\n
$  rvm install 1.9.3 --with-openssl-dir=$HOME/.rvm/usr --patch ./openssl.patch 
</code></pre>

<h3>5. Get the name of rpm packages</h3>

<p>Only print the name of the rpm package:</p>

<pre><code># rpm -qp --queryformat '%{NAME}\n' *.rpm&gt;package.list
</code></pre>

<h3>6. xargs tips</h3>

<p>Example:</p>

<pre><code># find . -type f -exec grep -ilR "MY PATTERN" {} \; | xargs -I % cp % /dest/dir/
</code></pre>

<p>For me, I find out all of the packges in cache file, and copy them to another position:</p>

<pre><code>$ find . | \grep rpm$ | xargs -I % cp % /home/dash/rpms
</code></pre>

<h3>7. Make local repo</h3>

<p>From the stackoverflow answers.</p>

<pre><code>Yes as you've described it, it sounds doable. I think I would be inclined to do the
following steps.

Setup directories
$ mkdir {Desktop,Desktop_Platform,X_Window_System,Fonts}
Download RPMs
Then run these types of commands to download the RPMs for the given groups:

$ repoquery --qf=%{name} -g --list --grouppkgs=all "Fonts" | \
     xargs -I{} repotrack -a x86_64 -p Fonts/ {}
You can wrap it in a for loop too:

$ for i in "Desktop" "Desktop_Platform" "X_Window_System" "Fonts";do  
    repoquery --qf=%{name} -g --list --grouppkgs=all "$i" | \
       xargs -I{} repotrack -a x86_64 -p $i/ {}; 
  done
This will go through each group and download the packages into their respective
directories.

Re-installation
Then use the command as you've described:

$ yum --nogpgcheck localinstall {Desktop,Desktop_Platform,X_Window_System,Fonts}/*.rpm
</code></pre>

<h3>8. Simple Screen Recorder</h3>

<p>Ubuntu:</p>

<pre><code>sudo add-apt-repository ppa:maarten-baert/simplescreenrecorder
sudo apt-get update
sudo apt-get install simplescreenrecorder
# if you want to record 32-bit OpenGL applications on a 64-bit system:
sudo apt-get install simplescreenrecorder-lib:i386
</code></pre>

<p>ArchLinux:</p>

<pre><code>$ sudo pacman -S simplescreenrecorder
</code></pre>

<h3>9. Convert virtualbox hd to qcow2</h3>

<pre><code>VBoxManage clonehd /home/dash/VirtualBox\ VMs/ansible-cobbler_cobbler-ubuntu_1462410925173_15793/packer-virtualbox-iso-1454031074-disk1.vmdk /home/dash/output.img --format raw &amp;&amp; qemu-img convert -f raw /home/dash/output.img -O qcow2 /home/dash/ansible-cobbler.qcow2
</code></pre>

<h3>10. Ansible issue</h3>

<p>The isssue is:</p>

<pre><code>ansible: ERROR: become is not a legal parameter in an Ansible Playbook
</code></pre>

<p>Solved via upgrading to the newest version of ansible:</p>

<pre><code>$ sudo apt-get install software-properties-common
$ sudo apt-add-repository ppa:ansible/ansible
$ sudo apt-get update
$ sudo apt-get install ansible
</code></pre>

<p>Using the newest ansible you could aoid this error.</p>

<h3>11. Create customized lxc image</h3>

<pre><code>http://unix.stackexchange.com/questions/186638/how-to-make-a-local-template-for-a-linux-container-and-point-to-that
</code></pre>

<p><a href="https://insights.ubuntu.com/2015/03/20/installing-lxd-and-the-command-line-tool/">https://insights.ubuntu.com/2015/03/20/installing-lxd-and-the-command-line-tool/</a></p>

<p><a href="https://www.stgraber.org/2016/03/30/lxd-2-0-image-management-512/">https://www.stgraber.org/2016/03/30/lxd-2-0-image-management-512/</a></p>

<p><a href="https://insights.ubuntu.com/2016/04/01/lxd-2-0-image-management-512/">https://insights.ubuntu.com/2016/04/01/lxd-2-0-image-management-512/</a></p>

<h3>12. Changing to eth0 in Ubuntu</h3>

<p>Modify the name of <code>enps*</code> to <code>eth0/1/2/3/4/</code>, via following steps:</p>

<pre><code>try this: Edit your /etc/default/grub. Change the line from

GRUB_CMDLINE_LINUX=""
to

GRUB_CMDLINE_LINUX="net.ifnames=0 biosdevname=0"
and, finally run:

# update-grub
</code></pre>

<h3>13. MAAS Syncing PXE File</h3>

<p><a href="https://maas.ubuntu.com/docs/sstreams-mirror.html">https://maas.ubuntu.com/docs/sstreams-mirror.html</a>  <br/>
<a href="http://ytooyama.hatenadiary.jp/entry/2016/05/11/002532">http://ytooyama.hatenadiary.jp/entry/2016/05/11/002532</a></p>

<p>For building our own MAAS image:</p>

<p><a href="http://askubuntu.com/questions/744966/how-do-you-install-the-maas-image-builder-on-14-04-lts">http://askubuntu.com/questions/744966/how-do-you-install-the-maas-image-builder-on-14-04-lts</a></p>

<h3>14. Vagrant For MAAS</h3>

<p><a href="https://github.com/battlemidget/vagrant-maas">https://github.com/battlemidget/vagrant-maas</a></p>

<p><a href="https://github.com/battlemidget/vagrant-maas-in-a-box/blob/master/Vagrantfile">https://github.com/battlemidget/vagrant-maas-in-a-box/blob/master/Vagrantfile</a></p>

<h3>15. Convert vm to physical</h3>

<p>Thus you could enjoy packer building the physical machine! :)</p>

<pre><code>cd /media/wherever-the-image-is/

# for VMWare
sudo apt-get install qemu-kvm
qemu-img convert your-vmware-disk.vmdk -O raw disk.img

# For VirtualBox
VBoxManage internalcommands converttoraw your-virtualbox-disk.vdi /dev/sdX
</code></pre>

<h3>16. Generate Random Seed</h3>

<p>Error message is <code>Please do some other work to give
the OS a chance to collect more entropy!</code></p>

<pre><code>$ sudo aptitude install haveged
</code></pre>

<h3>17. DEB Repository in Cobbler</h3>

<p><a href="https://github.com/cobbler/cobbler/wiki/Creating-custom-apt-repositories-in-centos-or-el-based-cobbler">https://github.com/cobbler/cobbler/wiki/Creating-custom-apt-repositories-in-centos-or-el-based-cobbler</a></p>

<p>Trouble-Shooting:  <br/>
<a href="https://github.com/cobbler/cobbler/issues/1530">https://github.com/cobbler/cobbler/issues/1530</a></p>

<h3>18. Manually Install Mate Desktop</h3>

<pre><code>echo "debconf debconf/frontend select noninteractive" | sudo debconf-set-selections
apt-get --allow-unauthenticated update -y
apt-get --allow-unauthenticated upgrade -y
apt-get --allow-unauthenticated install -y build-essential
apt-get --allow-unauthenticated install -y ubuntu-mate-desktop
apt-get --allow-unauthenticated install -y vim
apt-get --allow-unauthenticated install -y chromium-browser
apt-get --allow-unauthenticated install -y meld vim-gtk
apt-get --allow-unauthenticated install -y evince
sudo apt-get --allow-unauthenticated install -y language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base
sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
sudo localectl set-locale LANG=zh_CN.UTF-8
# TW/HK language support
sudo apt-get --allow-unauthenticated install -y language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base
sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
apt-get --allow-unauthenticated install -y fcitx
apt-get --allow-unauthenticated install -y fcitx-table-wubi fcitx-table-wubi-large
apt-get --allow-unauthenticated install -y fcitx-googlepinyin
apt-get --allow-unauthenticated install -y gimp
apt-get --allow-unauthenticated install -y ibus-pinyin 
apt-get --allow-unauthenticated install -y thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca 
apt-get --allow-unauthenticated install -y zsh
apt-get --allow-unauthenticated install -y fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy
apt-get --allow-unauthenticated install -y eclipse
apt-get --allow-unauthenticated install -y gpicview
apt-get --allow-unauthenticated install -y scrot
apt-get --allow-unauthenticated install -y byobu
apt-get --allow-unauthenticated install -y subversion git
apt-get --allow-unauthenticated install -y kdiff3
apt-get --allow-unauthenticated install -y docker
</code></pre>

<p>Final Version should be:</p>

<pre><code>echo "debconf debconf/frontend select noninteractive" | sudo debconf-set-selections
unset DEBIAN_HAS_FRONTEND DEBIAN_FRONTEND DEBCONF_REDIR DEBCONF_OLD_FD_BASE
export DEBIAN_FRONTEND=noninteractive
apt-get update --assume-yes
apt-get dist-upgrade --assume-yes
apt-get install --assume-yes vim build-essential ubuntu-mate-desktop chromium-browser meld vim-gtk evince language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base fcitx fcitx-table-wubi fcitx-table-wubi-large fcitx-googlepinyin gimp ibus-pinyin thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca zsh fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy eclipse gpicview scrot byobu subversion git kdiff3 docker
apt-get install --assume-yes  `check-language-support -l zh`
</code></pre>

<h3>19. Use rync for resume tranferring</h3>

<p>Command:</p>

<pre><code>$ rsync -P -e ssh remoteuser@remotehost:/remote/path /local/path
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Switching to Win10]]></title>
    <link href="http://purplepalmdash.github.io/blog/2016/04/21/switching-to-win10/"/>
    <updated>2016-04-21T10:06:44+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2016/04/21/switching-to-win10</id>
    <content type="html"><![CDATA[<h3>Background</h3>

<p>Since the monitor in my company are so ba&hellip;&hellip;..d, I have to change my working
environment from PC to SurfacePro, thus I have some tools changes, following are the
records.</p>

<h3>Tool List</h3>

<p>Terminal: XShell4, Make sure you have change the screen-size issue.   <br/>
<a href="purplepalmdash.github.io/blog/2015/11/13/win10-tips-for-using-xshell/">purplepalmdash.github.io/blog/2015/11/13/win10-tips-for-using-xshell/</a></p>

<p>Screen-Shot:  <br/>
I use picPick for replacing the scrot, the scrot is so convenient thus I found many
tools for replacing it.</p>

<p>picPick Configuration: the main purpose is for selecting the rectangle and save it
automatically to the folder with the timestamp.</p>

<p>Auto-Syncing tool:   <br/>
using WinSCP&rsquo;s keep remote the latest status:</p>

<p><img src="/images/2016_04_21_10_39_10.jpg" alt="/images/2016_04_21_10_39_10.jpg" /></p>

<p>OK, Now we could also using the same writing behavior just as under Linux Awesome
Desktop.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[把玩ebuddy(4)]]></title>
    <link href="http://purplepalmdash.github.io/blog/2016/03/15/ba-wan-ebuddy-4/"/>
    <updated>2016-03-15T14:25:48+08:00</updated>
    <id>http://purplepalmdash.github.io/blog/2016/03/15/ba-wan-ebuddy-4</id>
    <content type="html"><![CDATA[<p>总结了一下ebuddy的玩法，最近加了点玩法，就是用ebuddy作为Bash运行脚本后的提示部件。譬如
，当完成了某个编译任务后，用ebuddy来告知任务的运行成功。</p>

<pre><code>$ Task A ; NOTIFY EBUDDY
</code></pre>

<h3>/bin/ebuddy</h3>

<p>创建一个<code>/bin/ebuddy</code>的文件，内容如下:</p>

<pre><code>#!/bin/bash
FILE=/tmp/ebuddy
while true
do
    # if exists the file, then blinking the ebuddy.
  if [ -f $FILE ];
  then
      # Exists the file, shining the ebuddy
     echo 07 &gt; /dev/udp/127.0.0.1/8888
  else
      # Now clear the status of the ebuddy
     echo 17 &gt; /dev/udp/127.0.0.1/8888
  fi
#echo 07 &gt; /dev/udp/127.0.0.1/8888
sleep 3
done
</code></pre>

<p>这个文件的意思是，如果存在<code>/tmp/ebuddy</code>文件，ebuddy的头会亮起，否则，清除ebuddy的状态。</p>

<h3>notifyebuddy &amp;&amp; clearebuddy</h3>

<p>这两个命令是做在.zshrc里的两个alias:</p>

<pre><code>$ vim ~/.zshrc
# For Using ebuddy
alias notifyebuddy='touch /tmp/ebuddy'
alias clearebuddy='rm -f /tmp/ebuddy'
</code></pre>

<p>这样我们可以在运行完某个命令后，告知ebuddy完成事件。</p>

<h3>局限</h3>

<p>不能同时标识两个以上的命令完成情况。</p>
]]></content>
  </entry>
  
</feed>

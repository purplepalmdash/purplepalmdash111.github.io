<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>LinuxTips8 &middot; Dash</title>

  
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/poole.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde-a.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/custom-additions.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/highlight/googlecode.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/8.5/styles/docco.min.css">
  <script type="text/javascript" src="//cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript" src="/js/html2canvas.js"></script>
  <script type='text/javascript'>
  function genPostShot() { 
          var rightNow = new Date();
          var imageName = rightNow.toISOString().slice(0,16).replace(/(-)|(:)|(T)/g,"");
          imageName += '.jpg'
          html2canvas(document.getElementsByClassName('post'), {
              background :'#FFFFFF',
              onrendered: function(canvas) {
  		
          	$('#test').attr('href', canvas.toDataURL("image/jpeg"));
          	$('#test').attr('download',imageName);
          	$('#test')[0].click();
              }
          });
  }; 
  
  </script>
  <script src="//cdn.bootcss.com/highlight.js/8.5/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124">
  <link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel="icon">

  
  
  
  

  <meta name="description" content="Linux Tips 8">
  <meta name="keywords" content="Linux">
  
  
</head>
<body class="theme-base-0c">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="http://purplepalmdash.github.io/images/mylogo.jpeg" alt="gravatar">
      <h1><a href="http://purplepalmdash.github.io/">Get busy living, or get busy dying.</a></h1>
      <a href="http://purplepalmdash.github.io/"><p>Dash</p></a>
    </div>

    <ul class="sidebar-nav">
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/">First Page</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/post/">All Posts</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/linux/">Linux</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/embedded/">Embedded System</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/virtualization">Virtualization</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/purplepalmdash"><i class="fa fa-github-square fa-3x"></i></a>
      
      <a href="https://cn.linkedin.com/in/yang-feipeng-1b909319"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/u/0/106572959364703833986"><i class="fa fa-google-plus-square fa-3x"></i></a>
      <a href="https://www.facebook.com/yang.feipeng"><i class="fa fa-facebook-square fa-3x"></i></a>
      <a href="https://twitter.com/dashwillfly"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1>LinuxTips8</h1>
    <p align="right">
    <a href="javascript:genPostShot()">
	    TurnToJPG --> <i class="fa fa-camera-retro fa-2x"></i>
    </a>
    <a id="test"></a>
    </p>
    <hr>
    <span class="post-date">Oct 30, 2017 
    
    <br/>
    
          <a class="a_cat" href="http://purplepalmdash.github.io/categories/linux">Linux</a>
      
      

    
    </span>
      <div id="_toc" class="toc">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#1-pigz-for-multi-core-compression">1. pigz for multi-core compression</a></li>
<li><a href="#2-skip-checksum-check-in-yaourt">2. Skip Checksum check in yaourt</a></li>
<li><a href="#3-yaourt-hivex-and-libguestfs">3. yaourt hivex and libguestfs</a></li>
<li><a href="#4-virt-resize-bug">4. virt-resize bug</a></li>
<li><a href="#5-add-user-to-sudo">5. Add user to sudo</a></li>
<li><a href="#6-linuxkit">6. linuxkit</a></li>
<li><a href="#7-teamviewer-on-rpi">7. teamviewer on rpi</a></li>
<li><a href="#8-bash-debugging">8. bash debugging</a></li>
<li><a href="#9-raspberrypi-keyboard-layout">9. RaspberryPi Keyboard layout</a></li>
<li><a href="#10-sonoff">10. sonoff</a></li>
<li><a href="#11-debian-qtcreator">11. Debian QTcreator</a></li>
<li><a href="#12-hugo-issue">12. hugo issue</a></li>
<li><a href="#13-gitk">13. gitk</a></li>
<li><a href="#14-pyinstaller-to-exe">14. pyinstaller to exe</a></li>
<li><a href="#15-sip-setapi">15. sip setapi</a></li>
<li><a href="#16-rdesktop-enable-remote">16. rdesktop enable remote</a></li>
<li><a href="#17-debian-vbox-guest-additional-installation">17. debian VBox Guest Additional installation</a></li>
<li><a href="#18-tune-linpack">18. tune linpack</a></li>
<li><a href="#19-docker-restart-policy">19. docker restart policy</a></li>
<li><a href="#20-apt-mirror-configuration-for-arm64">20. apt-mirror configuration for arm64</a></li>
<li><a href="#21-boot-into-console-ubuntu">21. Boot into console(Ubuntu)</a></li>
<li><a href="#22-disable-dhcpd">22. Disable dhcpd</a></li>
<li><a href="#23-centos73-upgrading-to-centos74">23. CentOS73 upgrading to CentOS74</a></li>
<li><a href="#24-ipmi-tool-view-lan-address">24. ipmi tool view lan address</a></li>
<li><a href="#25-quickly-setup-stretch">25. Quickly setup stretch</a></li>
<li><a href="#26-xrdp-on-stretch">26. xrdp on stretch</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </div>
    

<h3 id="1-pigz-for-multi-core-compression">1. pigz for multi-core compression</h3>

<p>In case you need multi-core compression for speeding up compression procedure,
please do following steps:</p>

<pre><code># pacman -S pigz
# tar -c transfer/ | pigz -c | split -a 5 -d -b 1650m - mysplit
# ls -l
total 8296652
-rw-r--r-- 1 root root 1730150400 Oct 30 09:20 mysplit00000
-rw-r--r-- 1 root root 1730150400 Oct 30 09:20 mysplit00001
-rw-r--r-- 1 root root 1730150400 Oct 30 09:22 mysplit00002
-rw-r--r-- 1 root root 1730150400 Oct 30 09:23 mysplit00003
-rw-r--r-- 1 root root 1575143431 Oct 30 09:23 mysplit00004
drwxr-xr-x 3 root root       4096 Oct 30 08:59 transfer
</code></pre>

<p>Decompression these files:</p>

<pre><code># cat mysplit*&gt;mysplit
# tar xzvf mysplit
</code></pre>

<p>After decompression you got the same directory shows the same as the origin
one.</p>

<h3 id="2-skip-checksum-check-in-yaourt">2. Skip Checksum check in yaourt</h3>

<p>Via <code>yaourt --m-arg --skipchecksums --m-arg --skippgpcheck -Sb</code>, you could
skip checksum check in yaourt package.</p>

<h3 id="3-yaourt-hivex-and-libguestfs">3. yaourt hivex and libguestfs</h3>

<p>In hivex:</p>

<pre><code>Since some users may have set INSTALL_BASE in PERL_MM_OPT, you should consider adding 'unset PERL_MM_OPT' before configuring.

Compiles with line 23 in PKGBUILD changed from

./configure\ 
to...
./configure --disable-ocaml\
</code></pre>

<p>In libguestfs, simply ignore the checksum checking for source code.</p>

<h3 id="4-virt-resize-bug">4. virt-resize bug</h3>

<p>In CentOS 7, you have to upgrading the lvm2, then you get libguestfs working
properly.</p>

<p>To enable the debug, do following:  <code>export LIBGUESTFS_DEBUG=1</code></p>

<p>List all of the ip address via:</p>

<pre><code># virsh net-dhcp-leases $network
</code></pre>

<h3 id="5-add-user-to-sudo">5. Add user to sudo</h3>

<p>First you create user via <code>adduser YourName</code>, then you add user to sudo group
via:   <code>adduser YourName sudo</code>.</p>

<h3 id="6-linuxkit">6. linuxkit</h3>

<p><a href="http://collabnix.com/getting-started-with-multi-node-kubernetes-cluster-using-linuxkit/">http://collabnix.com/getting-started-with-multi-node-kubernetes-cluster-using-linuxkit/</a></p>

<h3 id="7-teamviewer-on-rpi">7. teamviewer on rpi</h3>

<p>Search rpi&rsquo;s teamviewer solution.</p>

<h3 id="8-bash-debugging">8. bash debugging</h3>

<p>If you have a bash script, simply use <code>bash -x xxx.sh</code> for debugging this
script, it will display all of the excution steps.</p>

<h3 id="9-raspberrypi-keyboard-layout">9. RaspberryPi Keyboard layout</h3>

<p>Configure them via:</p>

<pre><code># dpkg-reconfigure keyboard-configuration
</code></pre>

<h3 id="10-sonoff">10. sonoff</h3>

<p>use sonoff for controlling the electricity at home.</p>

<h3 id="11-debian-qtcreator">11. Debian QTcreator</h3>

<p>Just for writing the software for managing the sd card writer.</p>

<h3 id="12-hugo-issue">12. hugo issue</h3>

<p>via some mis-typing I commited some files into master branch(<code>.travis.yml</code>),
thus every time&rsquo;s commitment will trigger 2 building in travisCI!!!</p>

<p>Solution:</p>

<pre><code># git checkout master
# git rm .travis.yml
# git commit -m &quot;remove travis yml&quot;
# git push origin master
# git checkout source
</code></pre>

<p>Continue to edit and publish in source tree, now your commitment will be OK.</p>

<h3 id="13-gitk">13. gitk</h3>

<p>For viewing all of the changing of your git branch, use <code>gitk</code> for viewing the
code changes and branches.</p>

<h3 id="14-pyinstaller-to-exe">14. pyinstaller to exe</h3>

<p>Windows terminal, press following:</p>

<pre><code># pyinstaller.exe ThinClientSDWriter.py
</code></pre>

<p>After pyinstall.exe, it will build the output in dist directory.</p>

<p>Debugging, for</p>

<pre><code>import sip
sip.setapi(u'QString',2)
sip.setapi(u'QVariable',2)
</code></pre>

<p>If you encounter the api version 1 has been set, simply add 3 lines in:</p>

<p><code>support/rthooks/pyi_rth_qt4plugins.py</code> in PyInstaller</p>

<p><a href="https://github.com/pyinstaller/pyinstaller/wiki/Recipe-PyQt4-API-Version">https://github.com/pyinstaller/pyinstaller/wiki/Recipe-PyQt4-API-Version</a></p>

<h3 id="15-sip-setapi">15. sip setapi</h3>

<p>Detailed explanation:</p>

<pre><code>sip.setapi(&quot;QString&quot; ,2)
  
的意义就是取消掉 PyQt 里面 QString 的使用，原来凡是接受 QString 参数的地方，都变成了接受 Python 的 unicode 类型。原来返回 QString 的函数也变成返回 unicode 类型。
  
这个行为在 PyQt5 里面是默认行为。而且使用上也方便非常多，推荐新代码里面尽量使用这个行为。
  
同样的还有  
  
sip.setapi(&quot;QDateTime&quot;, 2)
sip.setapi(&quot;QDate&quot;, 2)
sip.setapi(&quot;QVariant&quot;, 2)
#QTextStream的第一个版本会导致Python的hex(),bin()被PyQt覆盖
sip.setapi(&quot;QTextStream&quot;, 2)
sip.setapi(&quot;QUrl&quot;, 2)
  
在使用这个 setapi() 调用的时候，建议包在 try/except 块里面，因为不能调用两次。并且不能在导入 PyQt 之后使用，所以应该放在程序的最开始处。  
  
try:
     sip.setapi(&quot;QString&quot;, 2)
     sip.setapi(...)
except ValueError:
     pass
from PyQt4.QtCore import * 
</code></pre>

<h3 id="16-rdesktop-enable-remote">16. rdesktop enable remote</h3>

<p>Via following command:</p>

<pre><code># rdesktop -r disk:share=/xxxx/yyy/ccc
</code></pre>

<h3 id="17-debian-vbox-guest-additional-installation">17. debian VBox Guest Additional installation</h3>

<pre><code># apt-get install build-essential linux-headers-amd64 linux-source
$ ./autorun.sh
</code></pre>

<h3 id="18-tune-linpack">18. tune linpack</h3>

<p><a href="http://www.advancedclustering.com/act_kb/tune-hpl-dat-file/">http://www.advancedclustering.com/act_kb/tune-hpl-dat-file/</a></p>

<h3 id="19-docker-restart-policy">19. docker restart policy</h3>

<p>Change restart policy from always to no:</p>

<pre><code>#  docker update --restart=no my-container
</code></pre>

<h3 id="20-apt-mirror-configuration-for-arm64">20. apt-mirror configuration for arm64</h3>

<p>The configuration file is listed as following:</p>

<pre><code># vim /etc/apt/mirror.list 
#
set base_path    /var/spool/apt-mirror
#
# set mirror_path  $base_path/mirror
# set skel_path    $base_path/skel
# set var_path     $base_path/var
# set cleanscript $var_path/clean.sh
set defaultarch  arm64
# set postmirror_script $var_path/postmirror.sh
# set run_postmirror 0
set nthreads     20
set _tilde 0

deb http://ports.ubuntu.com xenial main restricted universe multiverse
deb http://ports.ubuntu.com xenial-security main restricted universe multiverse
deb http://ports.ubuntu.com xenial-updates main restricted universe multiverse
deb http://ports.ubuntu.com xenial-proposed main restricted universe multiverse
deb http://ports.ubuntu.com xenial-backports main restricted universe multiverse
clean http://ports.ubuntu.com

</code></pre>

<h3 id="21-boot-into-console-ubuntu">21. Boot into console(Ubuntu)</h3>

<p>Simply via following command:</p>

<pre><code>$ sudo systemctl set-default multi-user.target
</code></pre>

<h3 id="22-disable-dhcpd">22. Disable dhcpd</h3>

<p>Via following command:</p>

<pre><code># sudo systemctl disable isc-dhcpd-server.service
</code></pre>

<h3 id="23-centos73-upgrading-to-centos74">23. CentOS73 upgrading to CentOS74</h3>

<p>Install via (usbmuxd prevents its upgrading):</p>

<pre><code># yum remove usbmuxd
# yum update
</code></pre>

<h3 id="24-ipmi-tool-view-lan-address">24. ipmi tool view lan address</h3>

<p>Via following command:</p>

<pre><code>$ sudo ipmitool lan print
</code></pre>

<p><img src="/images/2017_12_26_08_46_44_653x379.jpg" alt="/images/2017_12_26_08_46_44_653x379.jpg" /></p>

<h3 id="25-quickly-setup-stretch">25. Quickly setup stretch</h3>

<p>Beware, the debian docker image will automatically remove the installed
pkgs!!!!</p>

<pre><code># echo deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib &gt;sources.list
# echo deb http://mirrors.aliyun.com/debian/ stretch-proposed-updates main non-free contrib &gt;&gt;sources.list
# apt-get update
# apt-get install -y apt-transport-https ca-certificates curl gnupg2 software-properties-common
# curl -fsSL https://download.docker.com/linux/$(. /etc/os-release; echo &quot;$ID&quot;)/gpg |  apt-key add -
#  add-apt-repository \
   &quot;deb [arch=amd64] https://download.docker.com/linux/$(. /etc/os-release; echo &quot;$ID&quot;) \
   $(lsb_release -cs) \
   stable&quot;
# apt-get update
# apt-get install -y docker-ce
</code></pre>

<h3 id="26-xrdp-on-stretch">26. xrdp on stretch</h3>

<p>Install via:</p>

<pre><code># apt install -y xrdp tigervnc-standalone-server
# vim /etc/xrdp/xrdp.ini
###### diff file listed as following:    
--- a/xrdp.ini     2017-06-19 14:05:53.290490260 +0900
+++ b/xrdp.ini  2017-06-19 14:11:17.788557402 +0900
@@ -147,15 +147,6 @@ tcutils=true
 ; Session types
 ;

-[Xorg]
-name=Xorg
-lib=libxup.so
-username=ask
-password=ask
-ip=127.0.0.1
-port=-1
-code=20
-
 [Xvnc]
 name=Xvnc
 lib=libvnc.so
@@ -166,6 +157,15 @@ port=-1
 #xserverbpp=24
 #delay_ms=2000

+[Xorg]
+name=Xorg
+lib=libxup.so
+username=ask
+password=ask
+ip=127.0.0.1
+port=-1
+code=20
+
 [console]
 name=console
 lib=libvnc.so
</code></pre>

<p>Restart xrdp via <code>sudo systemctl restart xrdp</code>.</p>

  </div>
  
</div>






<script src="http://purplepalmdash.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>


<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Puppet on Dash</title>
    <link>http://purplepalmdash.github.io/categories/puppet/</link>
    <description>Recent content in Puppet on Dash</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 16 Apr 2015 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://purplepalmdash.github.io/categories/puppet/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Quickly play puppet</title>
      <link>http://purplepalmdash.github.io/2015/04/16/quickly-play-puppet/</link>
      <pubDate>Thu, 16 Apr 2015 00:00:00 +0000</pubDate>
      
      <guid>http://purplepalmdash.github.io/2015/04/16/quickly-play-puppet/</guid>
      <description>

&lt;h3 id=&#34;server-and-client&#34;&gt;Server and Client&lt;/h3&gt;

&lt;p&gt;In server, install following packages:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ sudo apt-get install puppet puppetmaster

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In client, only install puppet is enough.&lt;br /&gt;
After installation, added the each other&amp;rsquo;s name into &lt;code&gt;/etc/hosts&lt;/code&gt;, let them ping each other via name rather than via ip address.&lt;/p&gt;

&lt;h3 id=&#34;sign&#34;&gt;Sign&lt;/h3&gt;

&lt;p&gt;In client, do following:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ clouder@pc121:/etc/puppet$ puppet agent --test --server=pc119
Exiting; no certificate found and waitforcert is disabled

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then in server, listed all of the certification request:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@pc119:~/Code/herokublog# sudo puppet cert list
  &amp;quot;pc121&amp;quot; (SHA256) 28:23:36:3C:E4:8B:3A:15:D2:B0:8C:A2:BC:E9:A1:E5:6A:6F:76:0E:40:73:29:1F:8F:8C:D4:83:1F:92:4F:C7

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;sign the cert:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@pc119:~/Code/herokublog# sudo puppet cert sign pc121
Notice: Signed certificate request for pc121
Notice: Removing file Puppet::SSL::CertificateRequest pc121 at &#39;/var/lib/puppet/ssl/ca/requests/pc121.pem&#39;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Verify it in the client:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;clouder@pc121:/etc/puppet$ puppet agent --test
Warning: Unable to fetch my node definition, but the agent run will continue:
Warning: getaddrinfo: Name or service not known
Info: Retrieving plugin
Error: /File[/home/clouder/.puppet/var/lib]: Failed to generate additional resources using &#39;eval_generate&#39;: getaddrinfo: Name or service not known

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;configuration&#34;&gt;Configuration&lt;/h3&gt;

&lt;p&gt;TBD&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Puppet on ArchLinux(2)</title>
      <link>http://purplepalmdash.github.io/2014/08/13/puppet-on-archlinux-2/</link>
      <pubDate>Wed, 13 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>http://purplepalmdash.github.io/2014/08/13/puppet-on-archlinux-2/</guid>
      <description>

&lt;h3 id=&#34;add-arch&#34;&gt;Add Arch&lt;/h3&gt;

&lt;p&gt;step1, add the hosts into /etc/hosts:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Puppet 
10.0.0.88	puppet
10.0.0.89	client

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;step2, edit the /etc/puppet/puppet.conf:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[agent]
    # add server
    [agent]
    server = puppet

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Restart the puppet.service:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;systemctl restart puppet.service
systemctl enable puppet.service

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;step3, in 10.0.0.88(server), add the ssl certification of archlinux:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@Ubuntu88:/home/Trusty# !44
puppet cert --list
Warning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations
   (at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1095:in `block in issue_deprecations&#39;)
  &amp;quot;XXXyyy.lan&amp;quot; (SHA256) 8XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
root@Ubuntu88:/home/Trusty# puppet cert --sign XXXyyy.lan
Warning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations
   (at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1095:in `block in issue_deprecations&#39;)
Notice: Signed certificate request for XXXyyy.lan
Notice: Removing file Puppet::SSL::CertificateRequest XXXyyy.lan at &#39;/var/lib/puppet/ssl/ca/requests/XXXyyy.lan.pem&#39;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now check the /tmp, we will see our test file in last chapter.&lt;/p&gt;

&lt;p&gt;For test pupose, we will disable archLinux&amp;rsquo;s puppet via:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[root@TrustyArch tmp]# systemctl stop puppet.service
[root@TrustyArch tmp]# systemctl disable puppet.service
Removed symlink /etc/systemd/system/multi-user.target.wants/puppet.service.

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;install-package&#34;&gt;Install package&lt;/h3&gt;

&lt;p&gt;Add following lines into 10.0.0.88, /etc/puppet/manifests/site.pp:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;package {
    &#39;xplot&#39;:
        ensure =&amp;gt; installed
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then restart the puppetmaster, in 10.0.0.89, the package xplot will be installed.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Puppet On ArchLinux</title>
      <link>http://purplepalmdash.github.io/2014/08/11/puppet-on-archlinux/</link>
      <pubDate>Mon, 11 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>http://purplepalmdash.github.io/2014/08/11/puppet-on-archlinux/</guid>
      <description>

&lt;h3 id=&#34;installation&#34;&gt;Installation&lt;/h3&gt;

&lt;p&gt;Install via;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo pacman -S puppet

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Configurate this machine into server mode.&lt;/p&gt;

&lt;h3 id=&#34;install-new-virtual-machine&#34;&gt;Install new Virtual Machine&lt;/h3&gt;

&lt;p&gt;Install a new ubuntu14.04 using qemu, and install puppet in it.&lt;br /&gt;
Generate the configuration file for mirror.list of Ubuntu.&lt;/p&gt;

&lt;p&gt;Finally use the vdi file in the Ubuntu.&lt;/p&gt;

&lt;p&gt;Install puppet in Ubuntu14.04:&lt;br /&gt;
&lt;a href=&#34;http://linuxconfig.org/puppet-installation-on-linux-ubuntu-14-04-trusty-tahr&#34;&gt;http://linuxconfig.org/puppet-installation-on-linux-ubuntu-14-04-trusty-tahr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Make Ubuntu use a fixed IP.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cat  /etc/network/interface
# s file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback
auto eth0
	iface eth0 inet static
	address 10.0.0.88
	netmask 255.255.255.0
	gateway 10.0.0.1

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And Copy the virtual disk, and change the UUID of the disk:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ VBoxManage internalcommands sethduuid ./Ubuntu.vdi 
UUID changed to: d1xxxxxxxxxxxxxxxxxxxxxxxxxx

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Be sure to change the ip address to 10.0.0.89.&lt;/p&gt;

&lt;p&gt;Now we have 2 machines.&lt;/p&gt;

&lt;p&gt;No password enter for ssh login:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cat ~/.ssh/id_rsa.pub| ssh Trusty@10.0.0.88 &#39;cat&amp;gt;&amp;gt;~/.ssh/authorized_keys&#39;
$ cat ~/.ssh/id_rsa.pub| ssh Trusty@10.0.0.89 &#39;cat&amp;gt;&amp;gt;~/.ssh/authorized_keys&#39;

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;server-and-client&#34;&gt;Server and Client&lt;/h3&gt;

&lt;p&gt;Install Server side in 10.0.0.88:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt-get install puppetmaster

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In 10.0.0.88, edit /etc/hosts:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;10.0.0.89	client

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;While in 10.0.0.89, edit /etc/hosts:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;10.0.0.88	puppet

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In client(10.0.0.89), start the service of puppet:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ sudo service puppet start
 * Starting puppet agent                                                                                
puppet not configured to start, please edit /etc/default/puppet to enable
                                                                                                 [ OK ]

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In server(10.0.0.88), start the service of puppet master:&lt;br /&gt;
Add following lines in to /etc/puppet/puppet.conf:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dns_alt_names = puppet, master.local, puppet.terokarvinen.com

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then remove all of the generated ssl :&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rm -rf /var/lib/puppet/ssl

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now restart the puppetmaster via:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# service puppetmaster restart 

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Change the hostname of 10.0.0.88 to Ubuntu88, 10.0.0.89 to Ubuntu89, and then restart the computer.&lt;br /&gt;
Now change the Ubuntu88&amp;rsquo;s configuration
Add following lines in 10.0.0.88(Server):
In /etc/puppet/puppet.conf, [master] heading:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dns_alt_names = puppet, master.local, puppet.terokarvinen.com

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;On 10.0.0.89(Client), change the following line in /etc/default/puppet:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;START=yes

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then in /etc/puppet/puppet.conf,  add following:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[agent]
server = puppet

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Restart the puppet service.&lt;/p&gt;

&lt;p&gt;Now on server, use following command to list the cert and add signed cert.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Trusty@Ubuntu88:~$ sudo puppet cert --list
sudo: unable to resolve host Ubuntu88
Warning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations
   (at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1095:in `block in issue_deprecations&#39;)
  &amp;quot;ubuntu89&amp;quot; (SHA256) xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Trusty@Ubuntu88:~$ sudo puppet cert --sign ubuntu89
sudo: unable to resolve host Ubuntu88
Warning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations
   (at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1095:in `block in issue_deprecations&#39;)
Notice: Signed certificate request for ubuntu89
Notice: Removing file Puppet::SSL::CertificateRequest ubuntu89 at &#39;/var/lib/puppet/ssl/ca/requests/ubuntu89.pem&#39;

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;create-the-site-manifest-and-a-module&#34;&gt;Create the Site Manifest and a Module&lt;/h3&gt;

&lt;p&gt;Go to /etc/puppet, run following command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Trusty@Ubuntu88:/etc/puppet$ sudo mkdir -p manifests/ modules/helloworld/manifests

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Edit following file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Trusty@Ubuntu88:/etc/puppet$ cat manifests/site.pp 
include helloworld

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Create the file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Trusty@Ubuntu88:/etc/puppet$ sudo cat modules/helloworld/manifests/init.pp
class helloworld {
        file { &#39;/tmp/helloFromMaster&#39;:
                content =&amp;gt; &amp;quot;See you at http://terokarvinen.com/tag/puppet\n&amp;quot;
        }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And Now in client, restart the puppet service:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Trusty@Ubuntu89:~$ sudo service puppet restart
sudo: unable to resolve host Ubuntu89
[sudo] password for Trusty: 
no talloc stackframe at ../source3/param/loadparm.c:4864, leaking memory
 * Restarting puppet agent                                               [ OK ] 
Trusty@Ubuntu89:~$ cat /tmp/helloFromMaster 
See you at http://terokarvinen.com/tag/puppet

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now the basic configuration is OK.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
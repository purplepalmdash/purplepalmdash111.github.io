<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Linux Tips(5) &middot; Dash</title>

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/poole.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde-a.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/custom-additions.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/highlight/googlecode.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124">
  <link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel="icon">

  
  
  
  

  <meta name="description" content="Get busy living, or get busy dying.">
  <meta name="keywords" content="unix,virtualization,embedded,linux">
  <link rel="author" href="http://plus.google.com/106572959364703833986">
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-42175003-1', 'auto');
      ga('send', 'pageview');
  </script>

</head>
<body class="theme-base-0c">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="https://www.gravatar.com/avatar/49381c0004d32c0a4296b92dff0c0ae5?s=200" alt="gravatar">
      <h1><a href="http://purplepalmdash.github.io/">Get busy living, or get busy dying.</a></h1>
      <a href="http://purplepalmdash.github.io/"><p>Dash</p></a>
    </div>

    <ul class="sidebar-nav">
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/">First Page</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/post/">All Posts</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/linux/">Linux</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/embedded/">Embedded System</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/virtualization">Virtualization</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/purplepalmdash"><i class="fa fa-github-square fa-3x"></i></a>
      
      <a href="https://cn.linkedin.com/in/yang-feipeng-1b909319"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/u/0/106572959364703833986"><i class="fa fa-google-plus-square fa-3x"></i></a>
      <a href="https://www.facebook.com/yang.feipeng"><i class="fa fa-facebook-square fa-3x"></i></a>
      <a href="https://twitter.com/dashwillfly"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="post">
    <h1>Linux Tips(5)</h1>
    <span class="post-date">May 4, 2016  &middot; <a href="http://purplepalmdash.github.io/2016/05/04/linux-tips-5/#disqus_thread">Comments</a>
    
    <br/>
    
          <a class="a_cat" href="http://purplepalmdash.github.io/categories/linux">Linux</a>
      
      

    
    </span>
      <div id="_toc" class="toc">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#1-detach-running-tasks">1. Detach Running Tasks</a></li>
<li><a href="#2-installation-of-cobbler">2. Installation of Cobbler</a></li>
<li><a href="#3-yum-groups">3. yum groups</a></li>
<li><a href="#4-rvm-issue">4. rvm issue</a></li>
<li><a href="#5-get-the-name-of-rpm-packages">5. Get the name of rpm packages</a></li>
<li><a href="#6-xargs-tips">6. xargs tips</a></li>
<li><a href="#7-make-local-repo">7. Make local repo</a></li>
<li><a href="#8-simple-screen-recorder">8. Simple Screen Recorder</a></li>
<li><a href="#9-convert-virtualbox-hd-to-qcow2">9. Convert virtualbox hd to qcow2</a></li>
<li><a href="#10-ansible-issue">10. Ansible issue</a></li>
<li><a href="#11-create-customized-lxc-image">11. Create customized lxc image</a></li>
<li><a href="#12-changing-to-eth0-in-ubuntu">12. Changing to eth0 in Ubuntu</a></li>
<li><a href="#13-maas-syncing-pxe-file">13. MAAS Syncing PXE File</a></li>
<li><a href="#14-vagrant-for-maas">14. Vagrant For MAAS</a></li>
<li><a href="#15-convert-vm-to-physical">15. Convert vm to physical</a></li>
<li><a href="#16-generate-random-seed">16. Generate Random Seed</a></li>
<li><a href="#17-deb-repository-in-cobbler">17. DEB Repository in Cobbler</a></li>
<li><a href="#18-manually-install-mate-desktop">18. Manually Install Mate Desktop</a></li>
<li><a href="#19-use-rync-for-resume-tranferring">19. Use rync for resume tranferring</a></li>
<li><a href="#20-rackhd-howto">20. RackHD Howto</a></li>
<li><a href="#21-sync-repo">21. sync repo</a></li>
<li><a href="#22-vagrantfile-for-adding-more-disks">22. Vagrantfile for adding more disks</a></li>
<li><a href="#23-rvm-install-issue">23. rvm install issue</a></li>
<li><a href="#24-performance-tool">24. performance tool</a></li>
<li><a href="#25-x11-forwarding-issue">25. X11 Forwarding Issue</a></li>
<li><a href="#26-hack-into-system">26. Hack into system</a></li>
<li><a href="#27-quickly-setup-graphite-and-grafana">27. Quickly setup graphite and grafana</a></li>
<li><a href="#28-docker-enter-issue">28. docker-enter issue</a></li>
<li><a href="#29-docker-collectd">29. Docker-Collectd</a></li>
<li><a href="#30-for-using-bridged-vagrant-libvirt">30. For using bridged vagrant-libvirt</a></li>
<li><a href="#32-python-issue-easy-install">32. python issue(easy_install)</a></li>
<li><a href="#33-vpn-over-ssh">33. VPN Over ssh</a></li>
<li><a href="#34-x-windows-for-normal-user">34. X Windows for normal user</a></li>
<li><a href="#35-chromium-flash">35. Chromium Flash</a></li>
<li><a href="#36-junos-issue">36. JunOS Issue</a></li>
<li><a href="#37-hugo-materials">37. hugo materials</a></li>
<li><a href="#38-awk">38. awk</a></li>
<li><a href="#39-sed-ways">39. sed ways</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
      </div>
    

<h3 id="1-detach-running-tasks">1. Detach Running Tasks</h3>

<p><code>Ctrl+Z</code> for suspend the tasks, then <code>bg</code> it, now you could use <code>disown %1</code> for
detaching the running process.</p>

<p>Next time you login, you will see this background task is also running.</p>

<h3 id="2-installation-of-cobbler">2. Installation of Cobbler</h3>

<p>Shell Scripts:</p>

<p><a href="https://gist.github.com/luisbolson/1d0dc42976d2468171d0">https://gist.github.com/luisbolson/1d0dc42976d2468171d0</a></p>

<h3 id="3-yum-groups">3. yum groups</h3>

<p><a href="http://ramblings.narrabilis.com/creating-a-yum-repository-repo-and-creating-a-yum-group-to-install-kickstart">http://ramblings.narrabilis.com/creating-a-yum-repository-repo-and-creating-a-yum-group-to-install-kickstart</a></p>

<h3 id="4-rvm-issue">4. rvm issue</h3>

<p>rvm met <code>openssl.so (LoadError)</code>, could be solved via following steps.</p>

<pre><code>$  curl https://github.com/ruby/ruby/commit/801e1fe46d83c856844ba18ae4751478c59af0d1.diff &gt; openssl.patch\n
$  rvm install 1.9.3 --with-openssl-dir=$HOME/.rvm/usr --patch ./openssl.patch 
</code></pre>

<h3 id="5-get-the-name-of-rpm-packages">5. Get the name of rpm packages</h3>

<p>Only print the name of the rpm package:</p>

<pre><code># rpm -qp --queryformat '%{NAME}\n' *.rpm&gt;package.list
</code></pre>

<h3 id="6-xargs-tips">6. xargs tips</h3>

<p>Example:</p>

<pre><code># find . -type f -exec grep -ilR &quot;MY PATTERN&quot; {} \; | xargs -I % cp % /dest/dir/
</code></pre>

<p>For me, I find out all of the packges in cache file, and copy them to another position:</p>

<pre><code>$ find . | \grep rpm$ | xargs -I % cp % /home/dash/rpms
</code></pre>

<h3 id="7-make-local-repo">7. Make local repo</h3>

<p>From the stackoverflow answers.</p>

<pre><code>Yes as you've described it, it sounds doable. I think I would be inclined to do the
following steps.

Setup directories
$ mkdir {Desktop,Desktop_Platform,X_Window_System,Fonts}
Download RPMs
Then run these types of commands to download the RPMs for the given groups:

$ repoquery --qf=%{name} -g --list --grouppkgs=all &quot;Fonts&quot; | \
     xargs -I{} repotrack -a x86_64 -p Fonts/ {}
You can wrap it in a for loop too:

$ for i in &quot;Desktop&quot; &quot;Desktop_Platform&quot; &quot;X_Window_System&quot; &quot;Fonts&quot;;do  
    repoquery --qf=%{name} -g --list --grouppkgs=all &quot;$i&quot; | \
       xargs -I{} repotrack -a x86_64 -p $i/ {}; 
  done
This will go through each group and download the packages into their respective
directories.

Re-installation
Then use the command as you've described:

$ yum --nogpgcheck localinstall {Desktop,Desktop_Platform,X_Window_System,Fonts}/*.rpm
</code></pre>

<h3 id="8-simple-screen-recorder">8. Simple Screen Recorder</h3>

<p>Ubuntu:</p>

<pre><code>sudo add-apt-repository ppa:maarten-baert/simplescreenrecorder
sudo apt-get update
sudo apt-get install simplescreenrecorder
# if you want to record 32-bit OpenGL applications on a 64-bit system:
sudo apt-get install simplescreenrecorder-lib:i386
</code></pre>

<p>ArchLinux:</p>

<pre><code>$ sudo pacman -S simplescreenrecorder
</code></pre>

<h3 id="9-convert-virtualbox-hd-to-qcow2">9. Convert virtualbox hd to qcow2</h3>

<pre><code>VBoxManage clonehd /home/dash/VirtualBox\ VMs/ansible-cobbler_cobbler-ubuntu_1462410925173_15793/packer-virtualbox-iso-1454031074-disk1.vmdk /home/dash/output.img --format raw &amp;&amp; qemu-img convert -f raw /home/dash/output.img -O qcow2 /home/dash/ansible-cobbler.qcow2
</code></pre>

<h3 id="10-ansible-issue">10. Ansible issue</h3>

<p>The isssue is:</p>

<pre><code>ansible: ERROR: become is not a legal parameter in an Ansible Playbook
</code></pre>

<p>Solved via upgrading to the newest version of ansible:</p>

<pre><code>$ sudo apt-get install software-properties-common
$ sudo apt-add-repository ppa:ansible/ansible
$ sudo apt-get update
$ sudo apt-get install ansible
</code></pre>

<p>Using the newest ansible you could aoid this error.</p>

<h3 id="11-create-customized-lxc-image">11. Create customized lxc image</h3>

<pre><code>http://unix.stackexchange.com/questions/186638/how-to-make-a-local-template-for-a-linux-container-and-point-to-that
</code></pre>

<p><a href="https://insights.ubuntu.com/2015/03/20/installing-lxd-and-the-command-line-tool/">https://insights.ubuntu.com/2015/03/20/installing-lxd-and-the-command-line-tool/</a></p>

<p><a href="https://www.stgraber.org/2016/03/30/lxd-2-0-image-management-512/">https://www.stgraber.org/2016/03/30/lxd-2-0-image-management-512/</a></p>

<p><a href="https://insights.ubuntu.com/2016/04/01/lxd-2-0-image-management-512/">https://insights.ubuntu.com/2016/04/01/lxd-2-0-image-management-512/</a></p>

<h3 id="12-changing-to-eth0-in-ubuntu">12. Changing to eth0 in Ubuntu</h3>

<p>Modify the name of <code>enps*</code> to <code>eth0/1/2/3/4/</code>, via following steps:</p>

<pre><code>try this: Edit your /etc/default/grub. Change the line from

GRUB_CMDLINE_LINUX=&quot;&quot;
to

GRUB_CMDLINE_LINUX=&quot;net.ifnames=0 biosdevname=0&quot;
and, finally run:

# update-grub
</code></pre>

<h3 id="13-maas-syncing-pxe-file">13. MAAS Syncing PXE File</h3>

<p><a href="https://maas.ubuntu.com/docs/sstreams-mirror.html">https://maas.ubuntu.com/docs/sstreams-mirror.html</a><br />
<a href="http://ytooyama.hatenadiary.jp/entry/2016/05/11/002532">http://ytooyama.hatenadiary.jp/entry/2016/05/11/002532</a></p>

<p>For building our own MAAS image:</p>

<p><a href="http://askubuntu.com/questions/744966/how-do-you-install-the-maas-image-builder-on-14-04-lts">http://askubuntu.com/questions/744966/how-do-you-install-the-maas-image-builder-on-14-04-lts</a></p>

<h3 id="14-vagrant-for-maas">14. Vagrant For MAAS</h3>

<p><a href="https://github.com/battlemidget/vagrant-maas">https://github.com/battlemidget/vagrant-maas</a></p>

<p><a href="https://github.com/battlemidget/vagrant-maas-in-a-box/blob/master/Vagrantfile">https://github.com/battlemidget/vagrant-maas-in-a-box/blob/master/Vagrantfile</a></p>

<h3 id="15-convert-vm-to-physical">15. Convert vm to physical</h3>

<p>Thus you could enjoy packer building the physical machine! :)</p>

<pre><code>cd /media/wherever-the-image-is/

# for VMWare
sudo apt-get install qemu-kvm
qemu-img convert your-vmware-disk.vmdk -O raw disk.img

# For VirtualBox
VBoxManage internalcommands converttoraw your-virtualbox-disk.vdi /dev/sdX
</code></pre>

<h3 id="16-generate-random-seed">16. Generate Random Seed</h3>

<p>Error message is <code>Please do some other work to give
the OS a chance to collect more entropy!</code></p>

<pre><code>$ sudo aptitude install haveged
</code></pre>

<h3 id="17-deb-repository-in-cobbler">17. DEB Repository in Cobbler</h3>

<p><a href="https://github.com/cobbler/cobbler/wiki/Creating-custom-apt-repositories-in-centos-or-el-based-cobbler">https://github.com/cobbler/cobbler/wiki/Creating-custom-apt-repositories-in-centos-or-el-based-cobbler</a></p>

<p>Trouble-Shooting:<br />
<a href="https://github.com/cobbler/cobbler/issues/1530">https://github.com/cobbler/cobbler/issues/1530</a></p>

<h3 id="18-manually-install-mate-desktop">18. Manually Install Mate Desktop</h3>

<pre><code>echo &quot;debconf debconf/frontend select noninteractive&quot; | sudo debconf-set-selections
apt-get --allow-unauthenticated update -y
apt-get --allow-unauthenticated upgrade -y
apt-get --allow-unauthenticated install -y build-essential
apt-get --allow-unauthenticated install -y ubuntu-mate-desktop
apt-get --allow-unauthenticated install -y vim
apt-get --allow-unauthenticated install -y chromium-browser
apt-get --allow-unauthenticated install -y meld vim-gtk
apt-get --allow-unauthenticated install -y evince
sudo apt-get --allow-unauthenticated install -y language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base
sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
sudo localectl set-locale LANG=zh_CN.UTF-8
# TW/HK language support
sudo apt-get --allow-unauthenticated install -y language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base
sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
apt-get --allow-unauthenticated install -y fcitx
apt-get --allow-unauthenticated install -y fcitx-table-wubi fcitx-table-wubi-large
apt-get --allow-unauthenticated install -y fcitx-googlepinyin
apt-get --allow-unauthenticated install -y gimp
apt-get --allow-unauthenticated install -y ibus-pinyin 
apt-get --allow-unauthenticated install -y thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca 
apt-get --allow-unauthenticated install -y zsh
apt-get --allow-unauthenticated install -y fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy
apt-get --allow-unauthenticated install -y eclipse
apt-get --allow-unauthenticated install -y gpicview
apt-get --allow-unauthenticated install -y scrot
apt-get --allow-unauthenticated install -y byobu
apt-get --allow-unauthenticated install -y subversion git
apt-get --allow-unauthenticated install -y kdiff3
apt-get --allow-unauthenticated install -y docker
</code></pre>

<p>Final Version should be:</p>

<pre><code>echo &quot;debconf debconf/frontend select noninteractive&quot; | sudo debconf-set-selections
unset DEBIAN_HAS_FRONTEND DEBIAN_FRONTEND DEBCONF_REDIR DEBCONF_OLD_FD_BASE
export DEBIAN_FRONTEND=noninteractive
apt-get update --assume-yes
apt-get dist-upgrade --assume-yes
apt-get install --assume-yes vim build-essential ubuntu-mate-desktop chromium-browser meld vim-gtk evince language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base fcitx fcitx-table-wubi fcitx-table-wubi-large fcitx-googlepinyin gimp ibus-pinyin thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca zsh fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy eclipse gpicview scrot byobu subversion git kdiff3 docker
apt-get install --assume-yes  `check-language-support -l zh`

</code></pre>

<h3 id="19-use-rync-for-resume-tranferring">19. Use rync for resume tranferring</h3>

<p>Command:</p>

<pre><code>$ rsync -P -e ssh remoteuser@remotehost:/remote/path /local/path
</code></pre>

<h3 id="20-rackhd-howto">20. RackHD Howto</h3>

<p><a href="http://dojoblog.emc.com/rackhd-cpi/setting-up-rackhd/">http://dojoblog.emc.com/rackhd-cpi/setting-up-rackhd/</a></p>

<h3 id="21-sync-repo">21. sync repo</h3>

<pre><code>vagrant@ubuntu-1404:/etc/apt$ cat /var/mirrors/ubuntu/14.04/var/postmirror.sh 
#!/bin/sh -x 
# the udebs script gets the actual files we need 
#/mnt/repo/apt-mirror/var/udebs.sh  
# A quick apt directory structure primer: 
# an apt server (e.g. archive.ubuntu.com) contains repositories (e.g. trusty-backports), 
# which contain archives (e.g. multiverse), which contain directories 
# a complete example - http://archive.ubuntu.com/ubuntu/dists/trusty-backports/multiverse/debian-installer/  
# With this in mind, we create bash 'arrays' of the structure: 
# server we're syncing against 
#MIRROR=&quot;cn.archive.ubuntu.com&quot; 
MIRROR=&quot;archive.ubuntu.com&quot; 
# repositories we're mirroring 
#REPOS=&quot;trusty trusty-updates trusty-security trusty-proposed trusty-backports&quot; 
REPOS=&quot;trusty&quot;
# archives in repositories 
#ARCHIVES=&quot;main multiverse restricted universe&quot; 
ARCHIVES=&quot;main&quot;
# installer location inside archive 
#DIRECTORIES=&quot;debian-installer dist-upgrader-all installer-amd64 installer-i386&quot; 
DIRECTORIES=&quot;debian-installer installer-amd64&quot;
#where we're storing it locally 
LOCALDIR=&quot;/var/mirrors/ubuntu/14.04/mirror/mirrors.aliyun.com&quot;
#LOCALDIR=&quot;/mnt/repo/apt-mirror/mirror/archive.ubuntu.com&quot;  
for REPO in $REPOS; do 
for ARCHIVE in $ARCHIVES; do 
for DIRECTORY in $DIRECTORIES;do 
# create directory structure 
if [ ! -e &quot;$LOCALDIR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY&quot; ]; then
mkdir -p &quot;$LOCALDIR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY&quot;
fi
# do the sync 
rsync --recursive --times --links --hard-links --delete --delete-after \
rsync://$MIRROR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY/ $LOCALDIR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY
done
done
done

</code></pre>

<h3 id="22-vagrantfile-for-adding-more-disks">22. Vagrantfile for adding more disks</h3>

<pre><code>To be done. 
</code></pre>

<h3 id="23-rvm-install-issue">23. rvm install issue</h3>

<p>With openssl patched you can install rvm successfully:</p>

<pre><code>$ wget https://github.com/ruby/ruby/commit/801e1fe46d83c856844ba18ae4751478c59af0d1.diff -O openssl.patch
$ rvm install --patch ./openssl.patch 2.2.3
</code></pre>

<h3 id="24-performance-tool">24. performance tool</h3>

<p><a href="http://www.tecmint.com/linux-cpu-load-stress-test-with-stress-ng-tool/2/">http://www.tecmint.com/linux-cpu-load-stress-test-with-stress-ng-tool/2/</a></p>

<h3 id="25-x11-forwarding-issue">25. X11 Forwarding Issue</h3>

<p>Problem:</p>

<pre><code>X11 forwarding request failed on channel 0
</code></pre>

<p>Solved via:</p>

<pre><code># pacman -S xorg-xauth
# vim /etc/ssh/sshd_config
AddressFamily any
X11Forwarding yes
</code></pre>

<p>Then restart the sshd daemon, you will get X11 on ssh forwarding enabled.</p>

<p>Add new user <code>clouder</code>:</p>

<pre><code># useradd -d /home/clouder/ clouder
# chown -R clouder:clouder /home/clouder/
# usermod -aG kvm clouder
# usermod -aG libvirt clouder
</code></pre>

<p>polkit configuration:</p>

<pre><code># vim /etc/polkit-1/rules.d/50-libvirt.rules 
/* Allow users in kvm group to manage the libvirt
daemon without authentication */
polkit.addRule(function(action, subject) {
    if (action.id == &quot;org.libvirt.unix.manage&quot; &amp;&amp;
        subject.isInGroup(&quot;kvm&quot;)) {
            return polkit.Result.YES;
    }
});
</code></pre>

<p>Install following packages:</p>

<pre><code># pacman -Syu ebtables dnsmasq
</code></pre>

<p>Open nested kvm.</p>

<h3 id="26-hack-into-system">26. Hack into system</h3>

<p><a href="http://null-byte.wonderhowto.com/how-to/hack-like-pro-hack-shellshock-vulnerability-0157651/">http://null-byte.wonderhowto.com/how-to/hack-like-pro-hack-shellshock-vulnerability-0157651/</a></p>

<h3 id="27-quickly-setup-graphite-and-grafana">27. Quickly setup graphite and grafana</h3>

<p>On ArchLinux, do following:</p>

<pre><code>$ mkdir -p /root/data/graphite/storage/whisper/
$ sudo docker run -d \
  --name graphite \
  -p 8080:80 \
  -p 2003:2003 \
  -v /local/path/to/.htpasswd:/etc/nginx/.htpasswd \
  -v /root/data/graphite/storage/whisper:/opt/graphite/storage/whisper \
  sitespeedio/graphite
</code></pre>

<p>Now your graphite runs OK, default username/password is guest/guest.</p>

<p>Continue setup the docker container for grafana:</p>

<pre><code>$ docker run -i -p 3000:3000 grafana/grafana
</code></pre>

<p>Or, setup our own persistent storage via:</p>

<pre><code>$ mkdir -p /root/data/grafana/
$ chmod 777 -R /root/data/grafana/
$ docker run -d -v /root/data/grafana:/var/lib/grafana --name grafana-storage busybox:latest
$ docker run  -d -p 3000:3000 --name=grafana --volumes-from grafana-storage grafana/grafana
$ docker logs grafana
</code></pre>

<p>The correct way for running grfafana via following:</p>

<pre><code># docker run -d -p 3000:3000 --name=grafana -v /root/data/grafana:/var/lib/grafana  grafana/grafana
</code></pre>

<h3 id="28-docker-enter-issue">28. docker-enter issue</h3>

<p>If you met <code>importenv: not found</code> issue, do following to let docker-enter running:</p>

<pre><code># docker pull jpetazzo/nsenter
# docker run --rm -v /usr/local/bin:/target jpetazzo/nsenter
# docker-enter &lt;container_name&gt;
</code></pre>

<h3 id="29-docker-collectd">29. Docker-Collectd</h3>

<pre><code># docker run -d --net=host --privileged -v /:/hostfs:ro --name=collectd -e HOST_NAME=localhost -e \
GRAPHITE_HOST=192.168.1.79 andreasjansson/collectd-write-graphite
</code></pre>

<h3 id="30-for-using-bridged-vagrant-libvirt">30. For using bridged vagrant-libvirt</h3>

<p>An example Vagrantfile is listed as following , notice it&rsquo;s using ovsbr0.</p>

<pre><code># -*- mode: ruby -*-
# vi: set ft=ruby :

############### Vagrant Configuration Here #############
Vagrant.configure(2) do |config|

  # vagrant issues #1673..fixes hang with configure_networks
  config.ssh.shell = &quot;bash -c 'BASH_ENV=/etc/profile exec bash'&quot;
  config.ssh.username = 'vagrant'
  config.ssh.password = 'vagrant'
  config.ssh.insert_key = 'true'
  config.vm.provider :libvirt do |domain|
    domain.nic_model_type = 'e1000'
    domain.memory = 384
    domain.nested = true
    domain.cpu_mode = 'host-passthrough'
  end

  # bridge node. 
  # Add one networking, modify hostname, define memory, CPU cores.
  config.vm.define :bridge do |bridge|
    bridge.vm.box = &quot;csmgmtv4&quot;
    bridge.vm.hostname = &quot;bridgenode&quot;
    bridge.vm.network :public_network, 
	:dev =&gt; &quot;ovsbr0&quot;,
	:mode =&gt; &quot;bridge&quot;,
	:type =&gt; &quot;bridge&quot;,
	:ip =&gt; &quot;192.168.178.2&quot;,
	:ovs =&gt; &quot;true&quot;
    bridge.vm.provider :libvirt do |domain|
      domain.storage :file, :size =&gt; '100G'
      domain.memory = 1024
      domain.cpus = 1
      domain.nested = true
      domain.disk_bus = 'virtio'
      domain.nic_model_type = 'virtio'
      domain.volume_cache = 'writeback'
    end
  end
end

</code></pre>

<p>###31. Using VPN in CloudStack
<a href="https://portal.redbridge.se/faq/getting-started/accessing-your-instance-from-the-outside/">https://portal.redbridge.se/faq/getting-started/accessing-your-instance-from-the-outside/</a></p>

<p><a href="https://blog.remibergsma.com/2012/11/18/securely-connect-an-advanced-private-cloudstack-network-by-using-a-vlan-aware-switch-and-a-basic-vpn-device/">https://blog.remibergsma.com/2012/11/18/securely-connect-an-advanced-private-cloudstack-network-by-using-a-vlan-aware-switch-and-a-basic-vpn-device/</a></p>

<p><a href="http://www.furorteutonicus.eu/2013/08/04/enabling-host-guest-networking-with-kvm-macvlan-and-macvtap/">http://www.furorteutonicus.eu/2013/08/04/enabling-host-guest-networking-with-kvm-macvlan-and-macvtap/</a></p>

<h3 id="32-python-issue-easy-install">32. python issue(easy_install)</h3>

<p>Solved via:</p>

<pre><code>$ wget https://bootstrap.pypa.io/ez_setup.py -O - | python
</code></pre>

<h3 id="33-vpn-over-ssh">33. VPN Over ssh</h3>

<p>Established via:</p>

<pre><code>$ sudo pppd updetach noauth silent nodeflate pty &quot;/usr/bin/ssh root@192.168.1.79 \ 
/usr/bin/pppd nodetach notty noauth&quot; ipparam vpn 10.0.8.1:10.0.8.2
</code></pre>

<h3 id="34-x-windows-for-normal-user">34. X Windows for normal user</h3>

<p>X Window for normal user</p>

<pre><code>➜  ~ chmod u+s /usr/bin/Xorg 
</code></pre>

<h3 id="35-chromium-flash">35. Chromium Flash</h3>

<p>Install it via:</p>

<pre><code>$ proxychains4 yaourt chromium-pepper-flash
</code></pre>

<p>Then enable it in <code>chrome://plugins</code>.</p>

<h3 id="36-junos-issue">36. JunOS Issue</h3>

<p><a href="http://www.juniper.net/techpubs/en_US/junos-ansible1.0/topics/example/junos-ansible-playbooks-device-configuring.html">http://www.juniper.net/techpubs/en_US/junos-ansible1.0/topics/example/junos-ansible-playbooks-device-configuring.html</a></p>

<p><a href="https://ittechnologist.wordpress.com/2015/08/23/use-vagrant-with-juniper-junos-vms-on-ubuntu/">https://ittechnologist.wordpress.com/2015/08/23/use-vagrant-with-juniper-junos-vms-on-ubuntu/</a></p>

<p><a href="https://atlas.hashicorp.com/juniper">https://atlas.hashicorp.com/juniper</a></p>

<h3 id="37-hugo-materials">37. hugo materials</h3>

<p><a href="http://dongjian.github.io/post/howtobuildablog/">http://dongjian.github.io/post/howtobuildablog/</a></p>

<p><a href="http://bling.github.io/blog/2015/12/31/migrating-from-jekyll-octopress-to-hugo/">http://bling.github.io/blog/2015/12/31/migrating-from-jekyll-octopress-to-hugo/</a></p>

<p><a href="https://parsiya.net/blog/2016-02-02-from-octopress-to-hugo/">https://parsiya.net/blog/2016-02-02-from-octopress-to-hugo/</a></p>

<p><a href="http://nathanleclaire.com/blog/2014/12/22/migrating-to-hugo-from-octopress/">http://nathanleclaire.com/blog/2014/12/22/migrating-to-hugo-from-octopress/</a></p>

<h3 id="38-awk">38. awk</h3>

<p>Some tricks on awk:</p>

<pre><code>$ document_keywords=&quot;categories: linux unix windows&quot;
$ echo $document_keywords | awk '{
for(i=2;i&lt;=NF;i++){if(i!=NF){$i=&quot;\&quot;&quot;$i&quot;\&quot;&quot;&quot;,&quot;}else{$i=&quot;\&quot;&quot;$i&quot;\&quot;&quot;}}}1'
</code></pre>

<h3 id="39-sed-ways">39. sed ways</h3>

<p>Using sed for switching from octopress to hugo:</p>

<pre><code>$  cat edit.sh
    #!/bin/bash
    for i in `ls ./*.markdown`
    do
    	# Generate the modified result, like categories: &quot;a&quot;, &quot;b&quot;, &quot;c&quot;
    	replaceline=`grep -i &quot;categories:&quot; $i|awk \
    '{for(i=2;i&lt;=NF;i++){if(i!=NF){$i=&quot;\&quot;&quot;$i&quot;\&quot;&quot;&quot;,&quot;}else{$i=&quot;\&quot;&quot;$i&quot;\&quot;&quot;}}}1'`
    	sed -i &quot;2s|.*|$replaceline|&quot; $i
    done
$ sed -i '2s/\(:[[:blank:]]*\)\(.*\)/\1[\2]/' *.markdown
</code></pre>

  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "dashsagittariussglory";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "dashsagittariussglory";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script src="http://purplepalmdash.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>


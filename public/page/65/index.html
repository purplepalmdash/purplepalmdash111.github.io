<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.17-DEV" />
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Dash &middot; Dash</title>

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/poole.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/poole-overrides.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde-overrides.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/hyde-a.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/custom-additions.css?ref=abc124">
  <link rel="stylesheet" href="http://purplepalmdash.github.io/css/highlight/googlecode.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://purplepalmdash.github.io/touch-icon-144-precomposed.png?ref=abc124">
  <link href="http://purplepalmdash.github.io/favicon.png?ref=abc124" rel="icon">

  
  
  
  <link href="http://purplepalmdash.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Dash &middot; Dash" />

  <meta name="description" content="Get busy living, or get busy dying.">
  <meta name="keywords" content="unix,virtualization,embedded,linux">
  <link rel="author" href="http://plus.google.com/106572959364703833986">
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-42175003-1', 'auto');
      ga('send', 'pageview');
  </script>

</head>
<body class="theme-base-0c">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="https://www.gravatar.com/avatar/49381c0004d32c0a4296b92dff0c0ae5?s=200" alt="gravatar">
      <h1><a href="http://purplepalmdash.github.io/">Get busy living, or get busy dying.</a></h1>
      <a href="http://purplepalmdash.github.io/"><p>Dash</p></a>
    </div>

    <ul class="sidebar-nav">
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/">First Page</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/post/">All Posts</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/linux/">Linux</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/embedded/">Embedded System</a></li>
      
      <li class="sidebar-nav-item"><a href="http://purplepalmdash.github.io/categories/virtualization">Virtualization</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/purplepalmdash"><i class="fa fa-github-square fa-3x"></i></a>
      
      <a href="https://cn.linkedin.com/in/yang-feipeng-1b909319"><i class="fa fa-linkedin-square fa-3x"></i></a>
      <a href="https://plus.google.com/u/0/106572959364703833986"><i class="fa fa-google-plus-square fa-3x"></i></a>
      <a href="https://www.facebook.com/yang.feipeng"><i class="fa fa-facebook-square fa-3x"></i></a>
      <a href="https://twitter.com/dashwillfly"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      <a href="http://purplepalmdash.github.io/index.xml" type="application/rss+xml"><i class="fa fa-rss-square fa-3x"></i></a>
      </li>
    </ul>

    

  </div>
</div>


<div class="content container">
  <div class="posts">
    
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://purplepalmdash.github.io/2014/12/03/use-docker-for-deploying-wp/">Use Docker for deploying WP</a>
      </h1>
      <span class="post-date">Dec 3, 2014  &middot; <a href="http://purplepalmdash.github.io/2014/12/03/use-docker-for-deploying-wp/#disqus_thread">Comments</a>
      
      <br/>
      <a class="a_cat" href="http://purplepalmdash.github.io/categories/virtualization">virtualization</a>
        
      </span>
      
      

<p>Just for swiftly deploy WP and test the RESTful API, I did following operations and runs a WP temporately.</p>

<h3 id="pull">PULL</h3>

<p>Pull following containers:</p>

<pre><code>$ docker pull mysql
$ docker pull wordpress
$ sudo docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
&lt;none&gt;              &lt;none&gt;              480ac552cd39        About an hour ago   192.8 MB
mysql               latest              98840bbb442c        39 hours ago        235.5 MB
wordpress           latest              9f51af77fd96        8 days ago          470.5 MB

</code></pre>

<h3 id="configuration">Configuration</h3>

<p>Explanation for following commands, <code>--name</code> is the name for our container, <code>-p 8038:80</code> is mapping the host machine&rsquo;s 8038 port to container <code>wordpress_1</code>:</p>

<pre><code>$ docker run --name mysql_1 -e MYSQL_ROOT_PASSWORD=xxxx -d mysql
$ docker run --name wordpress_1 --link mysql_1:mysql -p 8038:80 -d wordpress

</code></pre>

<p>Now open your browser to <code>http://localhost:8038</code> and you got the wordpress installation window.</p>

<h3 id="wp">WP</h3>

<p>After we installed WP, we could install JSON REST API from:<br />
<a href="https://wordpress.org/plugins/json-rest-api/">https://wordpress.org/plugins/json-rest-api/</a><br />
After installation, we could test the REST API via curl:</p>

<pre><code>TBD

</code></pre>

<h3 id="view-docker-status">View Docker status</h3>

<p>First we should grab the docker&rsquo;s PID via following command:</p>

<pre><code>$ docker  inspect  --format &quot;{{ .State.Pid }}&quot;  mysql_1 
28254
$ docker  inspect  --format &quot;{{ .State.Pid }}&quot;  wordpress_1
28754

</code></pre>

<p>Then we could nsenter the docker container and view its status:</p>

<pre><code>$ sudo nsenter --target 28254 --mount --uts --ipc --net --pid -- /bin/bash
$ sudo nsenter --target 28754 --mount --uts --ipc --net --pid -- /bin/bash

</code></pre>

<p>In the &lsquo;attached&rsquo; environment we could inspect the status for corresponding services.</p>

<h3 id="stop-docker-contains">Stop docker contains</h3>

<p>via <code>docker stop</code> we could simply stop the docker container:</p>

<pre><code>[Trusty@~/code/30days/Docker]$ sudo docker ps
CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                  NAMES
0995854e2144        wordpress:latest    &quot;/entrypoint.sh apac   About an hour ago   Up About an hour    0.0.0.0:8038-&gt;80/tcp   wordpress_1         
99d257ad6e24        mysql:latest        &quot;/entrypoint.sh mysq   About an hour ago   Up About an hour    3306/tcp               mysql_1             
[Trusty@~/code/30days/Docker]$ docker stop 0995854e2144
0995854e2144
[Trusty@~/code/30days/Docker]$ docker stop 99d257ad6e24
99d257ad6e24
[Trusty@~/code/30days/Docker]$ sudo docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES

</code></pre>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://purplepalmdash.github.io/2014/12/03/yong-flaskda-jian-ni-zi-ji-de-restful-api/">用Flask搭建你自己的Restful API</a>
      </h1>
      <span class="post-date">Dec 3, 2014  &middot; <a href="http://purplepalmdash.github.io/2014/12/03/yong-flaskda-jian-ni-zi-ji-de-restful-api/#disqus_thread">Comments</a>
      
      <br/>
      <a class="a_cat" href="http://purplepalmdash.github.io/categories/web">web</a>
        
      </span>
      
      

<h3 id="背景">背景</h3>

<p>最近在过一个《30天学习30种新技术》，过到第10天用Phonegap开发APP的时候，发现作者提供的API不可用，所以费心研究了一下Restful API, 顺利构建出了环境写完了那个APP，下面是一些摘要。<br />
我用的Tutorial来自这里：<br />
<a href="http://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask">http://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask</a><br />
开发环境是ArchLinux.</p>

<h3 id="hello-flask">Hello Flask</h3>

<p>原Tutorial中给出的是一个关于todo-list的实现，我们从最简单的&rdquo;Hello Flask&rdquo;开始：<br />
首先安装python虚拟环境和flask，注意因为Arch默认的python版本是3，所以这里我们使用了virtualenv2来创建python虚拟运行环境。</p>

<pre><code>$ mkdir todo-api
$ cd todo-api
$ virtualenv2 flask
$ source flask/bin/activate
(flask) $ pip install flask

</code></pre>

<p>在当前目录下建立<code>app.py</code>文件， 输入以下内容：</p>

<pre><code>#!flask/bin/python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def index():
    return &quot;Hello, Flask!&quot;

if __name__ == '__main__':
    app.run(debug=True)

</code></pre>

<p>现在改变文件属性，运行之:</p>

<pre><code>$ chmod a+x app.py
$ ./app.py

</code></pre>

<p>打开浏览器访问<code>http://127.0.0.1:5000</code>,，我们可以看到Hello Flask已经出现在浏览器里了。</p>

<h3 id="实现最简单的restful-api">实现最简单的Restful API</h3>

<p>Flask本身支持很多插件，可以用于实现Restful API，由于我们这里只是做DEMO使用，需求比较简单，我们抛弃那些繁琐的插件，手动来写。<br />
这里我们也不会引入数据库等内容，我们将task任务列表直接保存在内存中，所以一旦断电这些数据就将消失。在实际的生产环境中，我们是需要引入不同的数据库来存储这些数据的。<br />
在上面生成的<code>app.py</code>中添加以下内容:</p>

<pre><code>#!flask/bin/python
from flask import Flask, jsonify

app = Flask(__name__)

tasks = [
    {
        'id': 1,
        'title': u'Buy groceries',
        'description': u'Milk, Cheese, Pizza, Fruit, Tylenol', 
        'done': False
    },
    {
        'id': 2,
        'title': u'Learn Python',
        'description': u'Need to find a good Python tutorial on the web', 
        'done': False
    }
]

@app.route('/todo/api/v1.0/tasks', methods=['GET'])

def get_tasks():
    return jsonify({'tasks': tasks})

if __name__ == '__main__':
    app.run(debug=True)

</code></pre>

<p>现在打开终端，用curl就可以访问到我们新添加的API了:</p>

<pre><code>$ curl -i http://127.0.0.1:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 316
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 08:59:55 GMT

{
  &quot;tasks&quot;: [
    {
      &quot;description&quot;: &quot;Milk, Cheese, Pizza, Fruit, Tylenol&quot;, 
      &quot;done&quot;: false, 
      &quot;id&quot;: 1, 
      &quot;title&quot;: &quot;Buy groceries&quot;
    }, 
    {
      &quot;description&quot;: &quot;Need to find a good Python tutorial on the web&quot;, 
      &quot;done&quot;: false, 
      &quot;id&quot;: 2, 
      &quot;title&quot;: &quot;Learn Python&quot;
    }
  ]
}% 

</code></pre>

<p>第一个Restful的API就这样创建成功了。</p>

<h3 id="添加第二个restful-api">添加第二个RESTful API</h3>

<p>我们接着来添加第二个RESTful API, 加入下列代码到已有的<code>app.py</code>中:</p>

<pre><code>from flask import abort

@app.route('/todo/api/v1.0/tasks/&lt;int:task_id&gt;', methods=['GET'])
def get_task(task_id):
    task = filter(lambda t: t['id'] == task_id, tasks)
    if len(task) == 0:
        abort(404)
    return jsonify({'task': task[0]})

</code></pre>

<p>现在用curl来测试，结果应该是这样的:</p>

<pre><code>(flask)[Trusty@~/code/30days/todo-api]$ curl -i http://127.0.0.1:5000/todo/api/v1.0/tasks/2
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 151
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:10:25 GMT

{
  &quot;task&quot;: {
    &quot;description&quot;: &quot;Need to find a good Python tutorial on the web&quot;, 
    &quot;done&quot;: false, 
    &quot;id&quot;: 2, 
    &quot;title&quot;: &quot;Learn Python&quot;
  }
}%                                                                                                                                                   (flask)[Trusty@~/code/30days/todo-api]$ curl -i http://127.0.0.1:5000/todo/api/v1.0/tasks/3
HTTP/1.0 404 NOT FOUND
Content-Type: text/html
Content-Length: 233
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:10:27 GMT

&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on the server.  If you entered the URL manually please check your spelling and try again.&lt;/p&gt;

</code></pre>

<p>由于我们引用了abort方法，所以当我们给出的task id错误时，将弹出404错误。</p>

<h3 id="错误提示json化">错误提示JSON化</h3>

<p>通过引入<code>make_response</code>模块我们可以把404返回错误JSON化，添加以下代码到app.py中：</p>

<pre><code>from flask import make_response

@app.errorhandler(404)
def not_found(error):
    return make_response(jsonify({'error': 'Not found'}), 404)

</code></pre>

<p>现在访问一个不存在的task id将返回如下结果：</p>

<pre><code>(flask)[Trusty@~/code/30days/todo-api]$ curl -i http://127.0.0.1:5000/todo/api/v1.0/tasks/3
HTTP/1.0 404 NOT FOUND
Content-Type: application/json
Content-Length: 26
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:16:50 GMT

{
  &quot;error&quot;: &quot;Not found&quot;
}%             

</code></pre>

<h3 id="实现post方法">实现POST方法</h3>

<p>添加以下代码以实现POST方法:</p>

<pre><code>from flask import request

@app.route('/todo/api/v1.0/tasks', methods=['POST'])
def create_task():
    if not request.json or not 'title' in request.json:
        abort(400)
    task = {
        'id': tasks[-1]['id'] + 1,
        'title': request.json['title'],
        'description': request.json.get('description', &quot;&quot;),
        'done': False
    }
    tasks.append(task)
    return jsonify({'task': task}), 201

</code></pre>

<p>用curl测试的结果如下：</p>

<pre><code>(flask)[Trusty@~/code/30days/todo-api]$ curl -i -H &quot;Content-Type: application/json&quot; -X POST -d '{&quot;title&quot;:&quot;Read a book&quot;}' http://127.0.0.1:5000/todo/api/v1.0/tasks
HTTP/1.0 201 CREATED
Content-Type: application/json
Content-Length: 104
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:18:55 GMT

{
  &quot;task&quot;: {
    &quot;description&quot;: &quot;&quot;, 
    &quot;done&quot;: false, 
    &quot;id&quot;: 3, 
    &quot;title&quot;: &quot;Read a book&quot;
  }
}% 
 (flask)[Trusty@~/code/30days/todo-api]$ curl -i http://127.0.0.1:5000/todo/api/v1.0/tasks 
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 423
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:19:24 GMT

{
  &quot;tasks&quot;: [
    {
      &quot;description&quot;: &quot;Milk, Cheese, Pizza, Fruit, Tylenol&quot;, 
      &quot;done&quot;: false, 
      &quot;id&quot;: 1, 
      &quot;title&quot;: &quot;Buy groceries&quot;
    }, 
    {
      &quot;description&quot;: &quot;Need to find a good Python tutorial on the web&quot;, 
      &quot;done&quot;: false, 
      &quot;id&quot;: 2, 
      &quot;title&quot;: &quot;Learn Python&quot;
    }, 
    {
      &quot;description&quot;: &quot;&quot;, 
      &quot;done&quot;: false, 
      &quot;id&quot;: 3, 
      &quot;title&quot;: &quot;Read a book&quot;
    }
  ]
}%           

</code></pre>

<p>从上面的测试中我们可以看到一个新的任务被添加到了task列表中。</p>

<h3 id="最后两个restful-api">最后两个RESTful API</h3>

<p>最后的两个RESTful API代码如下:</p>

<pre><code>@app.route('/todo/api/v1.0/tasks/&lt;int:task_id&gt;', methods=['PUT'])
def update_task(task_id):
    task = filter(lambda t: t['id'] == task_id, tasks)
    if len(task) == 0:
        abort(404)
    if not request.json:
        abort(400)
    if 'title' in request.json and type(request.json['title']) != unicode:
        abort(400)
    if 'description' in request.json and type(request.json['description']) is not unicode:
        abort(400)
    if 'done' in request.json and type(request.json['done']) is not bool:
        abort(400)
    task[0]['title'] = request.json.get('title', task[0]['title'])
    task[0]['description'] = request.json.get('description', task[0]['description'])
    task[0]['done'] = request.json.get('done', task[0]['done'])
    return jsonify({'task': task[0]})

@app.route('/todo/api/v1.0/tasks/&lt;int:task_id&gt;', methods=['DELETE'])
def delete_task(task_id):
    task = filter(lambda t: t['id'] == task_id, tasks)
    if len(task) == 0:
        abort(404)
    tasks.remove(task[0])
    return jsonify({'result': True})

</code></pre>

<p>测试代码如下：</p>

<pre><code>$ curl -i -H &quot;Content-Type: application/json&quot; -X PUT -d '{&quot;done&quot;:true}' http://127.0.0.1:5000/todo/api/v1.0/tasks/2

</code></pre>

<p>运行上面的命令可以将第2条记录里的done字段由false改成true.</p>

<h3 id="改进接口">改进接口</h3>

<p>加入以下代码后，我们调用tasks方法将不再返回id,而是返回URIs，这样取回来就能用了。</p>

<pre><code>from flask import url_for

def make_public_task(task):
    new_task = {}
    for field in task:
        if field == 'id':
            new_task['uri'] = url_for('get_task', task_id=task['id'], _external=True)
        else:
            new_task[field] = task[field]
    return new_task

</code></pre>

<p>同时我们重写以下方法:</p>

<pre><code>@app.route('/todo/api/v1.0/tasks', methods=['GET'])
def get_tasks():
    return jsonify({'tasks': map(make_public_task, tasks)})

</code></pre>

<p>测试结果如下：</p>

<pre><code>$ curl -i http://127.0.0.1:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 406
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:32:12 GMT

{
  &quot;tasks&quot;: [
    {
      &quot;description&quot;: &quot;Milk, Cheese, Pizza, Fruit, Tylenol&quot;, 
      &quot;done&quot;: false, 
      &quot;title&quot;: &quot;Buy groceries&quot;, 
      &quot;uri&quot;: &quot;http://127.0.0.1:5000/todo/api/v1.0/tasks/1&quot;
    }, 
    {
      &quot;description&quot;: &quot;Need to find a good Python tutorial on the web&quot;, 
      &quot;done&quot;: false, 
      &quot;title&quot;: &quot;Learn Python&quot;, 
      &quot;uri&quot;: &quot;http://127.0.0.1:5000/todo/api/v1.0/tasks/2&quot;
    }
  ]
}% 

</code></pre>

<h3 id="加密restful网络接口">加密RESTful网络接口</h3>

<p>好了，我们的RESTful接口搭建完毕了，但是由于接口对所有人都是开放的，为了考虑安全因素，我们会采用简单加密。<br />
首先安装flask-httpauth模块:</p>

<pre><code>$ pip install flask-httpauth

</code></pre>

<p>而后添加以下代码：</p>

<pre><code>from flask.ext.httpauth import HTTPBasicAuth
auth = HTTPBasicAuth()

@auth.get_password
def get_password(username):
    if username == 'miguel':
        return 'python'
    return None

@auth.error_handler
def unauthorized():
    return make_response(jsonify({'error': 'Unauthorized access'}), 401)

</code></pre>

<p>加密路由实现如下：</p>

<pre><code>@app.route('/todo/api/v1.0/tasks', methods=['GET'])
@auth.login_required
def get_tasks():
    return jsonify({'tasks': tasks})

</code></pre>

<p>测试结果如下, 未通过授权时:</p>

<pre><code>$ curl -i http://localhost:5000/todo/api/v1.0/tasks                 
HTTP/1.0 401 UNAUTHORIZED
Content-Type: application/json
Content-Length: 36
WWW-Authenticate: Basic realm=&quot;Authentication Required&quot;
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:40:02 GMT

{
  &quot;error&quot;: &quot;Unauthorized access&quot;
}%   

</code></pre>

<p>通过授权时:</p>

<pre><code>$ curl -u miguel:python -i http://localhost:5000/todo/api/v1.0/tasks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 406
Server: Werkzeug/0.9.6 Python/2.7.8
Date: Wed, 03 Dec 2014 09:40:24 GMT

{
  &quot;tasks&quot;: [
    {
      &quot;description&quot;: &quot;Milk, Cheese, Pizza, Fruit, Tylenol&quot;, 
      &quot;done&quot;: false, 
      &quot;title&quot;: &quot;Buy groceries&quot;, 
      &quot;uri&quot;: &quot;http://localhost:5000/todo/api/v1.0/tasks/1&quot;
    }, 
.....

</code></pre>

<p>我们可以把出错时返回的错误号从401改变为403,这样返回的就是forbidden错误。</p>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://purplepalmdash.github.io/2014/12/01/virtual-node-environment-for-phonegap-development/">Virtual Node Environment For PhoneGap Development</a>
      </h1>
      <span class="post-date">Dec 1, 2014  &middot; <a href="http://purplepalmdash.github.io/2014/12/01/virtual-node-environment-for-phonegap-development/#disqus_thread">Comments</a>
      
      <br/>
      <a class="a_cat" href="http://purplepalmdash.github.io/categories/web">web</a>
        
      </span>
      
      

<h3 id="background">Background</h3>

<p>I met some tutorials which were write one or two years ago, while at that time the corresponding plugins are in an old version, so I need to find a whole &ldquo;virtual&rdquo; environment for developing these tutorials.</p>

<h3 id="install-nodeenv">Install Nodeenv</h3>

<p>&ldquo;Node.js virtual environment builder&rdquo; &mdash; is the introduction for Nodeenv.<br />
Install it via:</p>

<pre><code>$ virtualenv2 venv
source venv/bin/activate
(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ 
$ pip install nodeenv
(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ which nodeenv
/home/Trusty/code/30days/PhoneGap2.9.0/venv/bin/nodeenv
(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ nodeenv --version
0.11.1

</code></pre>

<p>With this nodeenv we could setup all kinds of the dev environments.</p>

<h3 id="wrok-with-nodeenv">Wrok With Nodeenv</h3>

<p>Install the node.js first, this may cause long time:</p>

<pre><code>(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ nodeenv nodeenv 
 * Install node.js (0.10.33 
[Trusty@~/code/30days/PhoneGap2.9.0]$ du -hs *
170M    nodeenv
8.9M    venv
(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ ls
nodeenv  npm-debug.log  venv
(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ . nodeenv/bin/activate 
(nodeenv)(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ which npm
/home/Trusty/code/30days/PhoneGap2.9.0/nodeenv/bin/npm
(nodeenv)(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ which node
/home/Trusty/code/30days/PhoneGap2.9.0/nodeenv/bin/node

</code></pre>

<p>Now we could install the specified version of PhoneGap, first we should find the specified versions:</p>

<pre><code>$ npm view phonegap


</code></pre>

<p>This will returns the specified versions of all of the phonegap.<br />
Choose whichever you want.</p>

<pre><code>$ npm install phonegap@2.9.0-rc1-0.12.2

</code></pre>

<p>This will install the phonegap around Dec,2013, which should be fit well to the tutorial.<br />
Then re-activate , or manually modify the PATH as:</p>

<pre><code>$ export PATH=/home/Trusty/code/30days/PhoneGap2.9.0/nodeenv/bin:$PATH
(nodeenv)(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ phonegap -v
2.9.0-rc1-0.12.2

</code></pre>

<h3 id="run-tutorial">Run Tutorial</h3>

<h4 id="create-apps">Create Apps</h4>

<p>Create the app via following command:</p>

<pre><code>(nodeenv)(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ npm config set https_proxy http://1xx.x.xx.xxx:2xxxx
(nodeenv)(venv)[Trusty@~/code/30days/PhoneGap2.9.0]$ npm config set proxy http://1xx.x.xx.xxx:2xxx
$ phonegap create audero-feed-reade com.audero.free.utility.auderofeedreader &quot;Audero Feed Reader&quot;

</code></pre>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://purplepalmdash.github.io/2014/11/28/setup-dev-env-on-do/">Setup Dev Env On DO</a>
      </h1>
      <span class="post-date">Nov 28, 2014  &middot; <a href="http://purplepalmdash.github.io/2014/11/28/setup-dev-env-on-do/#disqus_thread">Comments</a>
      
      <br/>
      <a class="a_cat" href="http://purplepalmdash.github.io/categories/linux">Linux</a>
        
      </span>
      
      

<h3 id="prepare">Prepare</h3>

<p>Install the following packages:</p>

<pre><code>$ sudo apt-get install python-virtualenv
$ sudo apt-get install ruby-full ruby
$ sudo gem install rhc

</code></pre>

<p>Since DO&rsquo;s network is pretty good, so it&rsquo;s very swift for developing on it.</p>

<h3 id="textblob">TextBlob</h3>

<pre><code>$ virtualenv venv --python=python2.7
$ . venv/bin/activate
$ pip install textblob
$ python -m textblob.download_corpora
$ pip install flask


</code></pre>

      
    </div>
    
    <div class="post">
      <h1 class="post-title">
        <a href="http://purplepalmdash.github.io/2014/11/27/apache-parameter-adjust/">Apache Parameter Adjust</a>
      </h1>
      <span class="post-date">Nov 27, 2014  &middot; <a href="http://purplepalmdash.github.io/2014/11/27/apache-parameter-adjust/#disqus_thread">Comments</a>
      
      <br/>
      <a class="a_cat" href="http://purplepalmdash.github.io/categories/web">web</a>
        
      </span>
      
      

<h3 id="background">Background</h3>

<p>A wordpress machine runs on DigitalOcean often sudden the mysqld database lost error.</p>

<h3 id="analyze">Analyze</h3>

<p>This is because the memory is exhausted in DO, so first I enable the swap for machine. This method solved the problem for a long time.<br />
But later it seems the robots who sent the rubbish comments continue to attack the system, causing the mysqld halt again, this time, I modified the apahce2&rsquo;s works:</p>

<pre><code>$ grep -Ri MaxRequestWorkers /etc/apache2/
/etc/apache2/mods-enabled/mpm_prefork.conf:# MaxRequestWorkers: maximum number of server processes allowed to start
/etc/apache2/mods-enabled/mpm_prefork.conf:     MaxRequestWorkers         150
/etc/apache2/mods-available/mpm_prefork.conf:# MaxRequestWorkers: maximum number of server processes allowed to start
/etc/apache2/mods-available/mpm_prefork.conf:   MaxRequestWorkers         150
$ vim /etc/apache2/mods-available/mpm_prefork.conf
$ vim /etc/apache2/mods-available/mpm_worker.conf
$ vim /etc/apache2/mods-available/mpm_itk.conf
$ vim /etc/apache2/mods-available/mpm_event.conf
$ service apache2 restart

</code></pre>

<p>The vim command is changing the MaxRequestWorkers from 150 to 10, hope this will solve the problem.</p>

<h3 id="tbd">TBD</h3>

<p>If the mysql runs into death again, then we must limit its connection towards apache2.</p>

      
    </div>
    
    
    
    <ul class="pagination">
        
        <li>
            <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
        </li>
        
        <li
        >
        <a href="/page/64/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
        </li>
        
        <li
        ><a href="/">1</a></li>
        
        <li
        ><a href="/page/2/">2</a></li>
        
        <li
        ><a href="/page/3/">3</a></li>
        
        <li
        ><a href="/page/4/">4</a></li>
        
        <li
        ><a href="/page/5/">5</a></li>
        
        <li
        ><a href="/page/6/">6</a></li>
        
        <li
        ><a href="/page/7/">7</a></li>
        
        <li
        ><a href="/page/8/">8</a></li>
        
        <li
        ><a href="/page/9/">9</a></li>
        
        <li
        ><a href="/page/10/">10</a></li>
        
        <li
        ><a href="/page/11/">11</a></li>
        
        <li
        ><a href="/page/12/">12</a></li>
        
        <li
        ><a href="/page/13/">13</a></li>
        
        <li
        ><a href="/page/14/">14</a></li>
        
        <li
        ><a href="/page/15/">15</a></li>
        
        <li
        ><a href="/page/16/">16</a></li>
        
        <li
        ><a href="/page/17/">17</a></li>
        
        <li
        ><a href="/page/18/">18</a></li>
        
        <li
        ><a href="/page/19/">19</a></li>
        
        <li
        ><a href="/page/20/">20</a></li>
        
        <li
        ><a href="/page/21/">21</a></li>
        
        <li
        ><a href="/page/22/">22</a></li>
        
        <li
        ><a href="/page/23/">23</a></li>
        
        <li
        ><a href="/page/24/">24</a></li>
        
        <li
        ><a href="/page/25/">25</a></li>
        
        <li
        ><a href="/page/26/">26</a></li>
        
        <li
        ><a href="/page/27/">27</a></li>
        
        <li
        ><a href="/page/28/">28</a></li>
        
        <li
        ><a href="/page/29/">29</a></li>
        
        <li
        ><a href="/page/30/">30</a></li>
        
        <li
        ><a href="/page/31/">31</a></li>
        
        <li
        ><a href="/page/32/">32</a></li>
        
        <li
        ><a href="/page/33/">33</a></li>
        
        <li
        ><a href="/page/34/">34</a></li>
        
        <li
        ><a href="/page/35/">35</a></li>
        
        <li
        ><a href="/page/36/">36</a></li>
        
        <li
        ><a href="/page/37/">37</a></li>
        
        <li
        ><a href="/page/38/">38</a></li>
        
        <li
        ><a href="/page/39/">39</a></li>
        
        <li
        ><a href="/page/40/">40</a></li>
        
        <li
        ><a href="/page/41/">41</a></li>
        
        <li
        ><a href="/page/42/">42</a></li>
        
        <li
        ><a href="/page/43/">43</a></li>
        
        <li
        ><a href="/page/44/">44</a></li>
        
        <li
        ><a href="/page/45/">45</a></li>
        
        <li
        ><a href="/page/46/">46</a></li>
        
        <li
        ><a href="/page/47/">47</a></li>
        
        <li
        ><a href="/page/48/">48</a></li>
        
        <li
        ><a href="/page/49/">49</a></li>
        
        <li
        ><a href="/page/50/">50</a></li>
        
        <li
        ><a href="/page/51/">51</a></li>
        
        <li
        ><a href="/page/52/">52</a></li>
        
        <li
        ><a href="/page/53/">53</a></li>
        
        <li
        ><a href="/page/54/">54</a></li>
        
        <li
        ><a href="/page/55/">55</a></li>
        
        <li
        ><a href="/page/56/">56</a></li>
        
        <li
        ><a href="/page/57/">57</a></li>
        
        <li
        ><a href="/page/58/">58</a></li>
        
        <li
        ><a href="/page/59/">59</a></li>
        
        <li
        ><a href="/page/60/">60</a></li>
        
        <li
        ><a href="/page/61/">61</a></li>
        
        <li
        ><a href="/page/62/">62</a></li>
        
        <li
        ><a href="/page/63/">63</a></li>
        
        <li
        ><a href="/page/64/">64</a></li>
        
        <li
        class="active"><a href="/page/65/">65</a></li>
        
        <li
        ><a href="/page/66/">66</a></li>
        
        <li
        ><a href="/page/67/">67</a></li>
        
        <li
        ><a href="/page/68/">68</a></li>
        
        <li
        ><a href="/page/69/">69</a></li>
        
        <li
        ><a href="/page/70/">70</a></li>
        
        <li
        ><a href="/page/71/">71</a></li>
        
        <li
        ><a href="/page/72/">72</a></li>
        
        <li
        ><a href="/page/73/">73</a></li>
        
        <li
        ><a href="/page/74/">74</a></li>
        
        <li
        ><a href="/page/75/">75</a></li>
        
        <li
        ><a href="/page/76/">76</a></li>
        
        <li
        ><a href="/page/77/">77</a></li>
        
        <li
        ><a href="/page/78/">78</a></li>
        
        <li
        ><a href="/page/79/">79</a></li>
        
        <li
        ><a href="/page/80/">80</a></li>
        
        <li
        ><a href="/page/81/">81</a></li>
        
        <li
        ><a href="/page/82/">82</a></li>
        
        <li
        ><a href="/page/83/">83</a></li>
        
        <li
        ><a href="/page/84/">84</a></li>
        
        <li
        ><a href="/page/85/">85</a></li>
        
        <li
        ><a href="/page/86/">86</a></li>
        
        <li
        ><a href="/page/87/">87</a></li>
        
        <li
        ><a href="/page/88/">88</a></li>
        
        <li
        ><a href="/page/89/">89</a></li>
        
        <li
        ><a href="/page/90/">90</a></li>
        
        <li
        ><a href="/page/91/">91</a></li>
        
        <li
        ><a href="/page/92/">92</a></li>
        
        <li
        ><a href="/page/93/">93</a></li>
        
        <li
        ><a href="/page/94/">94</a></li>
        
        <li
        ><a href="/page/95/">95</a></li>
        
        <li
        ><a href="/page/96/">96</a></li>
        
        <li
        ><a href="/page/97/">97</a></li>
        
        <li
        ><a href="/page/98/">98</a></li>
        
        <li
        ><a href="/page/99/">99</a></li>
        
        <li
        ><a href="/page/100/">100</a></li>
        
        <li
        ><a href="/page/101/">101</a></li>
        
        <li
        ><a href="/page/102/">102</a></li>
        
        <li
        ><a href="/page/103/">103</a></li>
        
        <li
        ><a href="/page/104/">104</a></li>
        
        <li
        ><a href="/page/105/">105</a></li>
        
        <li
        ><a href="/page/106/">106</a></li>
        
        <li
        ><a href="/page/107/">107</a></li>
        
        <li
        ><a href="/page/108/">108</a></li>
        
        <li
        ><a href="/page/109/">109</a></li>
        
        <li
        ><a href="/page/110/">110</a></li>
        
        <li
        ><a href="/page/111/">111</a></li>
        
        <li
        ><a href="/page/112/">112</a></li>
        
        <li
        ><a href="/page/113/">113</a></li>
        
        <li
        ><a href="/page/114/">114</a></li>
        
        <li
        ><a href="/page/115/">115</a></li>
        
        <li
        ><a href="/page/116/">116</a></li>
        
        <li
        ><a href="/page/117/">117</a></li>
        
        <li
        ><a href="/page/118/">118</a></li>
        
        <li
        ><a href="/page/119/">119</a></li>
        
        <li
        ><a href="/page/120/">120</a></li>
        
        <li
        ><a href="/page/121/">121</a></li>
        
        <li
        ><a href="/page/122/">122</a></li>
        
        <li
        ><a href="/page/123/">123</a></li>
        
        <li
        ><a href="/page/124/">124</a></li>
        
        <li
        ><a href="/page/125/">125</a></li>
        
        <li
        ><a href="/page/126/">126</a></li>
        
        <li
        ><a href="/page/127/">127</a></li>
        
        <li
        ><a href="/page/128/">128</a></li>
        
        <li
        ><a href="/page/129/">129</a></li>
        
        <li
        ><a href="/page/130/">130</a></li>
        
        <li
        ><a href="/page/131/">131</a></li>
        
        <li
        ><a href="/page/132/">132</a></li>
        
        <li
        ><a href="/page/133/">133</a></li>
        
        <li
        ><a href="/page/134/">134</a></li>
        
        <li
        ><a href="/page/135/">135</a></li>
        
        <li
        ><a href="/page/136/">136</a></li>
        
        <li
        >
        <a href="/page/66/" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
        </li>
        
        <li>
            <a href="/page/136/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
        </li>
        
    </ul>
    
  </div>
</div>


<script type="text/javascript">
var disqus_shortname = "dashsagittariussglory";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

<script src="http://purplepalmdash.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>


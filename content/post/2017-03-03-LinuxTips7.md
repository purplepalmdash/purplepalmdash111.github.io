+++
date = "2017-03-03T11:14:34+08:00"
categories = ["Linux"]
keywords = ["Linux"]
description = "Linux tips series 7"
title = "Linux Tips(7)"

+++
### 1. CloudStack Issue
On ubuntu1404/1604, the template should enable HVM.    
Its partition size should less than the primary storage size.    
Password reset issue: Ubuntu1604, failed.    

Ubuntu14.04 startup too slow, because of ntp, remove it `sudo update-rc.d -f ntp remove
`

### 2. Ubuntu16.04 cloudstack-pass issue
The reset-password script is located as
`/etc/init.d/cloud-set-guest-password`, then we could do following
configurations:    

Remove the services via:    

```
# update-rc.d -f cloud-set-guest-password remove
# cp /etc/init.d/cloud-setup-guest-password /usr/bin/
# chmod 777 /usr/bin/cloud-setup-guest-password
```
Before because you set `update-rc.d cloud-set-guest-password defaults 98`, so
first you should remove it.    

Then Create a systemd service as `/lib/systemd/system/cloudpassword.service`:    

```
[Unit]
Description=cloudpass container

[Service]
Type=idle
Restart=always
ExecStart=/usr/bin/cloud-set-guest-password
ExecStop=/usr/bin/echo hello

[Install]
WantedBy=multi-user.target

```
Enable the service via:    

```
# systemctl enable cloudpassword
```
After the network is online:    

```
# systemctl enable systemd-networkd-wait-online.service
```
The steps could refers to another article.    

### 3. XenServer Timezone
Switch to UTC time:    

```
# cp /usr/share/zoneinfo/UTC /etc/localtime
```

### 4. Gitbook serve ports
Listening on other ports:    

```
$ gitbook --port 14001 serve
```

### 5. Quickstart For ShadowSocks
Install and configuration steps are listed as following(Ubuntu16.04):    

```
# apt-get install pip
# pip install --upgrade pip
# pip install shadowsocks
# touch /etc/shadowsocks.json
{
"server":"1xx.xxx.xxx.xxx",
"server_port":19175,
"local_address":"127.0.0.1",
"local_port":1080,
"password":"XXXXXXXXXXXXXXXXXXXXXXx",
"timeout":300,
"method":"aes-256-cfb",
"fast_open":false
}
# vim /etc/rc.local
ssserver -c /etc/shadowsocks.json -d start
```
Now you could continue to configure your shadowsocks client side. 

### 6. MariaDB In Docker
Connect to existing `docker-composed` mariadb instance via following command:     

```
sudo docker run -it -v /var/download/sbt/lili:/var/lib/mysql --link mariadb:mymariadb --net lilimarleen_default mariadb:latest /bin/bash
root@5d7eadc81b9e:/# mysql -h172.18.0.3 -P3306 -uroot -pexample
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 35
Server version: 10.1.20-MariaDB-1~jessie mariadb.org binary distribution

Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]> \q
Bye
```
`-v` is for using local volume for restoring aims.     
`--link` is for linking to existing instance.    
`-net` could be get via `docker net list`.    

### 7. cdn speedup
For speed-up my blog, I changed the fonts/css from the template's default
location to `http://www.bootcdn.cn/?`, this cdn's speed is pretty good, the
speed has been greatly improved.     

### 8. git diff
First use `git log` for getting all of the commit history, then you could get
the md5 for each commitment, `git diff md51 md52` you could easily get the
differences.   

### 9. qemu issue
When meeting `guest has not initialize the display (yet)`, do following:    

```
$ sudo qemu-system-x86_64 -net nic -net user,hostfwd=tcp::2222-:22 -hda ./test.qcow2 -boot d -cdrom /mnt/CentOS-7-x86_64-Everything-1611.iso -m 2048 --enable-kvm -vga virtio
```
`-vga virtio` solves this issue.    

### 10. bashrc execution
Run `bashrc` at ArchLinux:    

```
$ vim ~/.bash_profile
if [ -f ~/.bashrc ]; then
  . ~/.bashrc
fi
$ vim ~/.bashrc
```
Then all of the items in `.bashrc` could be executed.    


<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="Heroku Postgres I wrote the weather app which holds at: http://python-weather-app.herokuapp.com At around half a year it grows around 7MB, so I begin &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/16">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/22/retrieve-weather-database-for-further-analyze/">Retrieve Weather Database for Further Analyze</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-22T11:44:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>11:44 am</span></time>
        
         | <a href="/blog/2014/11/22/retrieve-weather-database-for-further-analyze/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Heroku Postgres</h3>

<p>I wrote the weather app which holds at:   <br/>
<a href="http://python-weather-app.herokuapp.com">http://python-weather-app.herokuapp.com</a>  <br/>
At around half a year it grows around 7MB, so I begin to think of how to back it and migrate to other platforms.</p>

<p>Following is the steps for viewing and operation on postgres database:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ heroku login
</span><span class='line'>$ heroku config
</span><span class='line'>$ heroku addons | grep POSTGRES
</span><span class='line'>$ heroku pg:info
</span></code></pre></td></tr></table></div></figure>


<h3>Backup</h3>

<p>Install the addons of pgbackups for backing up the existing databases:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ heroku addons:add pgbackups
</span><span class='line'>$ heroku pgbackups:capture
</span></code></pre></td></tr></table></div></figure>


<p>Use following command for store the backup locally:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -o latest.dump `heroku pgbackups:url`
</span><span class='line'>$ pg_restore --verbose --clean --no-acl --no-owner -h localhost -U Trusty -d weatherdb latest.dump
</span></code></pre></td></tr></table></div></figure>


<h3>View the data</h3>

<p>Using following commands for viewing the data:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ psql weatherdb
</span><span class='line'>weatherdb=# \dt;
</span><span class='line'>          List of relations
</span><span class='line'> Schema |    Name     | Type  | Owner 
</span><span class='line'>--------+-------------+-------+-------
</span><span class='line'> public | avg_weather | table | Trusty
</span><span class='line'> public | user        | table | Trusty
</span><span class='line'> public | weather     | table | Trusty
</span><span class='line'>(3 rows)
</span><span class='line'>weatherdb=# select * from weather;
</span><span class='line'>weatherdb=# select * from avg_weather;
</span></code></pre></td></tr></table></div></figure>


<p>By this you could dump all of the datas which already held in this postgres database.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/21/gitlab-installation-and-configuration/">GitLab Installation and Configuration</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-21T18:55:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>6:55 pm</span></time>
        
         | <a href="/blog/2014/11/21/gitlab-installation-and-configuration/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For sharing the project and holding the status of developing Rohc project, I set this gitlab project.</p>

<h3>Installation</h3>

<p>The detailed guildeline is from following URL:   <br/>
<a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-gitlab-as-your-very-own-private-github-clone">https://www.digitalocean.com/community/tutorials/how-to-set-up-gitlab-as-your-very-own-private-github-clone</a>   <br/>
But have some modifications.</p>

<h3>Modification</h3>

<p>Write permission problem:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ERROR:  While executing gem ... (Gem::FilePermissionError)
</span><span class='line'>You don't have write permissions for the /usr/local/rvm/gems/ruby
</span></code></pre></td></tr></table></div></figure>


<p>Solved via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo chmod -R 777 /usr/local/bin
</span><span class='line'>$ sudo chmod -R 777 /usr/local/rvm
</span></code></pre></td></tr></table></div></figure>


<p>We met modernizr missing problem, do following for avoiding this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo wget http://rubygems.org/downloads/modernizr-2.6.2.gem
</span><span class='line'>$ sudo -u git -H gem install modernizr
</span></code></pre></td></tr></table></div></figure>


<p>Also you have to modify following modules in Gemfile and Gemfile.lock:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>in Gemfile, line 164, change "modernizr", "2.6.2" to "modernizr-rails", "2.7.1"
</span><span class='line'>in Gemfile.lock, line 292, change modernizr (2.6.2) to modernizr-rails (2.7.1)
</span><span class='line'>in Gemfile.lock, line 626, change modernizr (= 2.6.2) to modernizr-rails (= 2.7.1)
</span></code></pre></td></tr></table></div></figure>


<p>Then run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo -u git -H bundle install --deployment --without development test postgres aws
</span></code></pre></td></tr></table></div></figure>


<p>You could continue with your settings.</p>

<p>After setting we may met smtp configuration problem, simply modify the following configuration file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pwd
</span><span class='line'>/home/git/gitlab
</span><span class='line'>$ cat ./config/environments/production.rb
</span><span class='line'>  # config.action_mailer.delivery_method = :sendmail
</span><span class='line'>  # # Defaults to:
</span><span class='line'>  # # # config.action_mailer.sendmail_settings = {
</span><span class='line'>  # # #   location: '/usr/sbin/sendmail',
</span><span class='line'>  # # #   arguments: '-i -t'
</span><span class='line'>  # # # }
</span><span class='line'>  # config.action_mailer.perform_deliveries = true
</span><span class='line'>  # config.action_mailer.raise_delivery_errors = true
</span><span class='line'>  config.action_mailer.delivery_method = :smtp
</span><span class='line'>  config.action_mailer.smtp_settings = {
</span><span class='line'>      :address =&gt; 'nwsxxx.xxx.xxxxxx.com',
</span><span class='line'>      :port =&gt; 25,
</span><span class='line'>      :domain =&gt; '1xx.2xx.xxx.xxx'
</span><span class='line'>      #:domain =&gt; '1xx.2xx.xxx.xxx',
</span><span class='line'>      #:authentication =&gt; :plain,
</span><span class='line'>      #:user_name =&gt; 'gitlab@yourserver.com',
</span><span class='line'>      #:password =&gt; 'yourPassword',
</span><span class='line'>      #:enable_starttls_auto =&gt; true
</span><span class='line'>  }
</span></code></pre></td></tr></table></div></figure>


<h3>Existing problem</h3>

<p>The smtp method won&rsquo;t send out the letters to the external users, I mean the email could only be used intranet not internet.</p>

<h3>Git command</h3>

<p>Using different branches for holding code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@Linux01 twal]# pwd
</span><span class='line'>/root/code/rohctest/twal
</span><span class='line'>[root@Linux01 twal]# git branch
</span><span class='line'>  Dev_For_ECCMU/ECCM2
</span><span class='line'>  DirectoryBasedTestcases
</span><span class='line'>  eccm2
</span><span class='line'>* master
</span><span class='line'>[root@Linux01 twal]# git checkout eccm2
</span><span class='line'>Switched to branch 'eccm2'
</span><span class='line'>[root@Linux01 twal]# git branch
</span><span class='line'>  Dev_For_ECCMU/ECCM2
</span><span class='line'>  DirectoryBasedTestcases
</span><span class='line'>* eccm2
</span><span class='line'>  master
</span></code></pre></td></tr></table></div></figure>


<p>So now you are in the eccm2 branch, do:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ export TUT_CFG_FILE=/root/code/gencfg_114/wal_tuni_ipconn53.cfg
</span><span class='line'>$ ./rohcFun11.py
</span></code></pre></td></tr></table></div></figure>


<p>If you want to test on eccmu, simply brach back to master via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git checkout master
</span><span class='line'>$ export TUT_CFG_FILE=/root/code/gencfg_117/wal_tuni_ipconn53.cfg
</span><span class='line'>$ ./rohcFun11.py
</span></code></pre></td></tr></table></div></figure>


<p>Push all of the branches to the remote repository:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git push --all
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/20/share-mouse-between-archlinux-and-yosemite/">Share Mouse Between ArchLinux &amp; Yosemite</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-20T15:02:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:02 pm</span></time>
        
         | <a href="/blog/2014/11/20/share-mouse-between-archlinux-and-yosemite/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Fixed IP</h3>

<p>First configure the IP for Yosemite on router, since the Archlinux takes the 221, Yosemite may use 220 for its fixed ip.</p>

<h3>ArchLinux Setting</h3>

<p>I use ArchLinux as the synergy server, so first install synergy via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S synergy
</span></code></pre></td></tr></table></div></figure>


<p>I want to place Yosemite at the right of the ArchLinux, So just configure the <code>/etc/hosts</code> like following.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ tail /etc/hosts
</span><span class='line'># For setting Synergy
</span><span class='line'>10.0.0.220      Yosemite.lan            Yosemite
</span></code></pre></td></tr></table></div></figure>


<p>Configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@kkkkttt kkkt]# cp /etc/synergy.conf.example /etc/synergy.conf
</span></code></pre></td></tr></table></div></figure>


<p>For easily configure the synergy, download qsynergy.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S qsynergy
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/synergyconfigure.jpg" alt="/images/synergyconfigure.jpg" />   <br/>
Then store its configuration to the <code>/etc/synergy.conf</code>.</p>

<p>Start the server and enable the server.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># systemctl enable synergys@mary
</span><span class='line'># systemctl start synergys@mary
</span></code></pre></td></tr></table></div></figure>


<h3>Yosemite Setting</h3>

<p>Download the SynergyKM from <a href="http://synergykm.com/">http://synergykm.com/</a>, and configure the SynergyKM connected to 10.0.0.221.   <br/>
Also you have to check <code>Start at login</code></p>

<p>Now place the Yosemite at the left of the ArchLinux, your mouse and keyboard could be freely switching from 2 machines.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/18/enable-light-weighted-webserver/">Enable Light-Weighted WebServer</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-18T11:47:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:47 am</span></time>
        
         | <a href="/blog/2014/11/18/enable-light-weighted-webserver/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>TOP Result</h3>

<p>Via top we saw:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> 2615 mysql     20   0  949.7m 450.7m   0.0  5.7   0:02.62 S mysqld  
</span></code></pre></td></tr></table></div></figure>


<p>This caused too much memory be wasted while my blog uses the static pages. <br/>
Solution: I will use a light-weighted web-server.</p>

<h3>Disable xampp</h3>

<p>Disble and remove the service of xampp via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@kkkktt kkk]# systemctl stop xampp.service
</span><span class='line'>[root@kkkktt kkk]# systemctl disable xampp.service
</span><span class='line'>Removed symlink /etc/systemd/system/multi-user.target.wants/xampp.service.
</span></code></pre></td></tr></table></div></figure>


<h3>lighttpd</h3>

<p>Install via following command and test its configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S lighttpd
</span><span class='line'>[kkk@~]$ ls /etc/lighttpd/lighttpd.conf 
</span><span class='line'>/etc/lighttpd/lighttpd.conf
</span><span class='line'>[kkk@~]$ lighttpd -t -f /etc/lighttpd/lighttpd.conf
</span><span class='line'>Syntax OK
</span></code></pre></td></tr></table></div></figure>


<p>Test the webpages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[kkk@/srv]$ sudo echo 'TestMe!' &gt; /srv/http/index.html
</span><span class='line'>[kkk@/srv]$ chmod 755 /srv/http/index.html
</span><span class='line'>[kkk@/srv]$ sudo systemctl start lighttpd
</span><span class='line'>[kkk@/srv]$ sudo systemctl enable lighttpd
</span><span class='line'>Created symlink from /etc/systemd/system/multi-user.target.wants/lighttpd.service to /usr/lib/systemd/system/lighttpd.service.
</span></code></pre></td></tr></table></div></figure>


<p>Use your browser for navigating the <a href="http://127.0.0.1,">http://127.0.0.1,</a> then you could visit this test page.</p>

<h3>OctoPress Changes</h3>

<p>Add following lines into the rakefile:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  system "jekyll"
</span><span class='line'>  # Use rsync for syncing the server directory with the public directory
</span><span class='line'>  system "rsync -vzrtopgu -progress /home/kkk/code/octo/heroku/Tomcat/public/* /srv/http"
</span></code></pre></td></tr></table></div></figure>


<p>Then everytime when you type <code>rake generate</code>, after generate the static website, the rsync will automatically sync the public folder with remote web server folder <code>/srv/http</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/18/tips-on-installing-yosemite/">Tips on Installing Yosemite</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-18T09:36:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:36 am</span></time>
        
         | <a href="/blog/2014/11/18/tips-on-installing-yosemite/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>First get the installation image from the AppStore, then format a flash-disk more than 8G to following format:   <br/>
<img src="/images/macosdisk.jpg" alt="/images/macosdisk.jpg" />   <br/>
Use following commands for creating the installation media:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kkkkkkkktttt-iMac:~ Trusty$ sudo /Applications/Install\ OS\ X\ Yosemite.app/Contents/Resources/createinstallmedia --volume /Volumes/Install --applicationpath /Applications/Install\ OS\ X\ Yosemite.app --nointeraction
</span></code></pre></td></tr></table></div></figure>


<p>Take a coffee, cause this will spend a long time for copying everything you need into the disk.</p>

<p>Install Clover:</p>

<p><img src="/images/clover1.jpg" alt="/images/clover1.jpg" /></p>

<p>Customize Clover installation:  <br/>
<img src="/images/clover2.jpg" alt="/images/clover2.jpg" /></p>

<p><img src="/images/clover3.jpg" alt="/images/clover3.jpg" /></p>

<p>Copy the dsdt &amp; ssdt files to EFI partition:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kkkkkkkktttt-iMac:Dsdt & Ssdt Trusty$ pwd
</span><span class='line'>/Users/Trusty/Desktop/MacOS/SurfacePro/SurfacePro 1째 Gen FilesPackage V.0.5.1/Dsdt & Ssdt
</span><span class='line'>kkkkkkkktttt-iMac:Dsdt & Ssdt Trusty$ cp -ar * /Volumes/ESP/EFI/CLOVER/ACPI/patched/
</span></code></pre></td></tr></table></div></figure>


<p>Copy some device driver files into the Clover:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kkkkkkkktttt-iMac:MacOS Trusty$ tar xzvf GenericUSBXHCI_1.2.7.tar.gz 
</span></code></pre></td></tr></table></div></figure>


<p>Copy GenericUSBXHCI.kext to 10.9/ 10.10/ Other/:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kkkkkkkktttt-iMac:kexts Trusty$ pwd
</span><span class='line'>/Volumes/ESP/EFI/CLOVER/kexts
</span><span class='line'>kkkkkkkktttt-iMac:kexts Trusty$ ls -F
</span><span class='line'>10.10/  10.6/   10.7/   10.8/   10.9/   Other/
</span><span class='line'>kkkkkkkktttt-iMac:10.10 Trusty$ sudo cp -r  /Users/Trusty/Desktop/MacOS/GenericUSBXHCI_Yosemite/ /Volumes/ESP/EFI/CLOVER/kexts/10.10/
</span></code></pre></td></tr></table></div></figure>


<p>Also we have to copy the fakesmc.kext should be copied to above folder.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kkkkkkkktttt-iMac:kexts Trusty$ ls *
</span><span class='line'>10.10:
</span><span class='line'>GenericUSBXHCI.kext     fakesmc.kext
</span><span class='line'>
</span><span class='line'>10.6:
</span><span class='line'>
</span><span class='line'>10.7:
</span><span class='line'>
</span><span class='line'>10.8:
</span><span class='line'>
</span><span class='line'>10.9:
</span><span class='line'>GenericUSBXHCI.kext     fakesmc.kext
</span><span class='line'>
</span><span class='line'>Other:
</span><span class='line'>GenericUSBXHCI.kext     fakesmc.kext
</span></code></pre></td></tr></table></div></figure>


<p>Now copy the config.plist into the CLOVER root directory.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kkkkkkkktttt-iMac:SurfacePro 1째 Gen FilesPackage V.0.5.1 Trusty$ pwd
</span><span class='line'>/Users/Trusty/Desktop/MacOS/SurfacePro/SurfacePro 1째 Gen FilesPackage V.0.5.1
</span><span class='line'>kkkkkkkktttt-iMac:SurfacePro 1째 Gen FilesPackage V.0.5.1 Trusty$ ls config.plist 
</span><span class='line'>config.plist
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Now you got your installation disk OK.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/17/forward-x11-via-ssh/">Forward X11 via Ssh</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-17T12:08:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>17</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:08 pm</span></time>
        
         | <a href="/blog/2014/11/17/forward-x11-via-ssh/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since the 5901 port is forbiddended via administrator of the switch, we have to forward the traffic to remote machine via ssh:</p>

<p>First in our machine type following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh -L 2333:A:5901 A -l Trusty
</span></code></pre></td></tr></table></div></figure>


<p>This will forward the A machines' 5901 to local&rsquo;s 2333 port.   <br/>
Then use a vncviewer software for accessing local machine&rsquo;s 2333 port:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vncviewer localhost:2333
</span></code></pre></td></tr></table></div></figure>


<p>Notice, the virtualbox&rsquo;s is named to vboxgtk in opensuse.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/16/ebc-exercises-on-bbb-pwm/">EBC Exercises on BBB - PWM</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-16T16:44:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:44 pm</span></time>
        
         | <a href="/blog/2014/11/16/ebc-exercises-on-bbb-pwm/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>PWM</h3>

<p>Simply enable the <code>P9_21</code> to PWM, then connect to the LED. The LED connection could refer to <code>EBC Exercises on BBB - Control LED</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>SLOTS=/sys/devices/bone_capemgr.*/slots
</span><span class='line'>echo am33xx_pwm &gt; $SLOTS
</span><span class='line'>echo bone_pwm_P9_21 &gt; $SLOTS
</span><span class='line'>cd /sys/devices/ocp.3/pwm_test_P9_21.15/
</span><span class='line'>echo 1000000000 &gt; period
</span><span class='line'>echo  250000000 &gt; duty
</span><span class='line'>echo 1 &gt; run
</span></code></pre></td></tr></table></div></figure>


<p>From now you could see the LED begin to flash. In fact using this pwm we could control servo motor:  <br/>
<a href="http://www.linux.com/learn/tutorials/776799-servo-control-from-the-beaglebone-black/">http://www.linux.com/learn/tutorials/776799-servo-control-from-the-beaglebone-black/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/16/i2c-and-bbb/">EBC Exercises on BBB -i2c and BBB</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-16T13:21:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:21 pm</span></time>
        
         | <a href="/blog/2014/11/16/i2c-and-bbb/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Connection</h3>

<p>HMC5883L magnetometer runs in 400KHZ I2C bus, it&rsquo;s for measuring the magnetic field vector in 3 dimensions.   <br/>
We use its 4 ports: VCC,GND,SDA, SCL. SDA is for Data, while SCL is for Clock.</p>

<p>Use P9 for connecting the HMC5883L.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>P9_02(GND) &lt;----&gt; GND    
</span><span class='line'>P9_04(VCC) &lt;----&gt; VCC
</span><span class='line'>P9_19(I2C2_SCL) &lt;----&gt; SCL   I2C bus 2(pin 19 on header p9 to SCL) 
</span><span class='line'>P9_20(I2C2_SDA) &lt;----&gt; SDA   
</span></code></pre></td></tr></table></div></figure>


<h3>I2C Detect</h3>

<p>First you should install i2cdetect, then list the avaiable i2c bus via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~# i2cdetect -l
</span><span class='line'>i2c-0   i2c             OMAP I2C adapter                        I2C adapter
</span><span class='line'>i2c-1   i2c             OMAP I2C adapter                        I2C adapter
</span></code></pre></td></tr></table></div></figure>


<p>We choose i2c bus2, thus the command for detecting the connected device should be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~# i2cdetect -y -r 1
</span><span class='line'>     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
</span><span class='line'>00:          -- -- -- -- -- -- -- -- -- -- -- -- -- 
</span><span class='line'>10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- 1e -- 
</span><span class='line'>20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
</span><span class='line'>30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
</span><span class='line'>40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
</span><span class='line'>50: -- -- -- -- UU UU UU UU -- -- -- -- -- -- -- -- 
</span><span class='line'>60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
</span><span class='line'>70: -- -- -- -- -- -- -- --     
</span></code></pre></td></tr></table></div></figure>


<p>The address should be 0x1e.</p>

<h3>Communicate with HMC5883L</h3>

<p>The registers are listed as following, notice eavh value for each axis are 16-bits, thus we have to read them seperately and combine them:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Address  Name    Access
</span><span class='line'>00    Configuration Register A    Read/Write
</span><span class='line'>01    Configuration Register B    Read/Write
</span><span class='line'>02    Mode Register   Read/Write
</span><span class='line'>03    Data Output X MSB Register  Read
</span><span class='line'>04    Data Output X LSB Register  Read
</span><span class='line'>05    Data Output Z MSB Register  Read
</span><span class='line'>06    Data Output Z LSB Register  Read
</span><span class='line'>07    Data Output Y MSB Register  Read
</span><span class='line'>08    Data Output Y LSB Register  Read
</span><span class='line'>09    Status Register Read
</span><span class='line'>10    Identification register A   Read
</span><span class='line'>11    Identification register B   Read
</span><span class='line'>12    Identification register C   Read
</span></code></pre></td></tr></table></div></figure>


<p>Thus we could read out the X MSB Restier and X LSB Register via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~# i2cget -y 1 0x1e 3
</span><span class='line'>0xfe
</span><span class='line'>root@arm:~# i2cget -y 1 0x1e 4
</span><span class='line'>0x91
</span></code></pre></td></tr></table></div></figure>


<h4>Different Mode</h4>

<p>Notice Mode Register, this will set the mesurement mode.  <br/>
<img src="/images/moderegister.jpg" alt="/images/moderegister.jpg" /></p>

<p>From the above table, we know for setting the lower 2 bits we could enable the operation mode of HMC5883L.  <br/>
Now we set to single measurement mode, for one-time measure.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># i2cset -y 1 0x1e 2 1
</span></code></pre></td></tr></table></div></figure>


<p>2 means we set the register 2, and its number equals to 01(Single-Measurement Mode). After one-time measurement, it wil fall back to idle Mode.      <br/>
After one-time measurement, get the register mode:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~# i2cget -y 1 0x1e 2
</span><span class='line'>0x03
</span></code></pre></td></tr></table></div></figure>


<p>Get the value of x-axis:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~# i2cget -y 1 0x1e 3
</span><span class='line'>0xfe
</span><span class='line'>root@arm:~# i2cget -y 1 0x1e 4
</span><span class='line'>0x77
</span></code></pre></td></tr></table></div></figure>


<h3>C Code</h3>

<p>Running Result:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~/code/i2c# ./myi2cget 1 30 2
</span><span class='line'>0x03 (3)
</span><span class='line'>root@arm:~/code/i2c# ./myi2cget 1 30 34
</span><span class='line'>0x00 (0)
</span><span class='line'>root@arm:~/code/i2c# ./myi2cget 1 30 4
</span><span class='line'>0x77 (119)
</span></code></pre></td></tr></table></div></figure>


<p>Critical Code:  <br/>
Open the i2c-xxx:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    sprintf(filename, "/dev/i2c-%d", i2cbus);
</span><span class='line'>    file = open(filename, O_RDWR);
</span></code></pre></td></tr></table></div></figure>


<p>ioctl for setting the address:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    if (ioctl(file, I2C_SLAVE, address) &lt; 0) {
</span></code></pre></td></tr></table></div></figure>


<p>Now read the byte from:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    res = i2c_smbus_read_byte_data(file, daddress);
</span></code></pre></td></tr></table></div></figure>


<p>Comparing the official i2cget, myi2cget could print out the human-readable format of data.</p>

<h3>Web Displaying</h3>

<p>Git clone the following project form github.com:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># git clone https://github.com/duganje/ECE497_duganje.git
</span><span class='line'># cd  ECE497_duganje/
</span><span class='line'># ls
</span><span class='line'>MiniProject01  MiniProject02  MiniProject03  MiniProject04  README.md
</span></code></pre></td></tr></table></div></figure>


<p>Upload the project MiniProject04 to the BBB board.  <br/>
Notice change the code in buttonBox.js from <code>i2cset -y 3</code> to <code>i2cset -y 1 and</code>i2cget -y 3<code>to</code>i2cget -y 1`</p>

<p>After modification, run buttonBox.js via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ node buttonBox.js
</span></code></pre></td></tr></table></div></figure>


<p>Now visit the <code>http://xx.xx.xx.xxx:8081/buttonBox.html</code> you could see the data displayed as following:</p>

<p><img src="/images/magnetometer.jpg" alt="/images/magnetometer.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/16/gpio-via-mmap/">EBC Exercises on BBB -GPIO via Mmap</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-16T11:30:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:30 am</span></time>
        
         | <a href="/blog/2014/11/16/gpio-via-mmap/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Operate On Device Tree</h3>

<p>Turn off the trigger and then shine on the LED USR3 via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~# cd /sys/class/leds/beaglebone\:green\:usr3
</span><span class='line'>root@arm:/sys/class/leds/beaglebone:green:usr3# ls
</span><span class='line'>brightness  device  max_brightness  power  subsystem  trigger  uevent
</span><span class='line'>root@arm:/sys/class/leds/beaglebone:green:usr3# echo none &gt; trigger 
</span><span class='line'>root@arm:/sys/class/leds/beaglebone:green:usr3# echo 1 &gt; brightness
</span></code></pre></td></tr></table></div></figure>


<p>We could find the gpio is attached to which pin:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ./findGPIO.js USR3                                                                
</span><span class='line'>{ name: 'USR3',                                                                                         
</span><span class='line'> gpio: 56,                                                                                             
</span><span class='line'> led: 'usr3',                                                                                          
</span><span class='line'> mux: 'gpmc_a8',                                                                                       
</span><span class='line'> key: 'USR3',                                                                                          
</span><span class='line'> muxRegOffset: '0x060',                                                                                
</span><span class='line'> options:                                                                                              
</span><span class='line'>  [ 'gpmc_a8',                                                                                         
</span><span class='line'>    'gmii2_rxd3',                                                                                      
</span><span class='line'>    'rgmii2_rd3',                                                                                      
</span><span class='line'>    'mmc2_dat6',                                                                                       
</span><span class='line'>    'gpmc_a24',                                                                                        
</span><span class='line'>    'pr1_mii1_rxd0',                                                                                   
</span><span class='line'>    'mcasp0_aclkx',                                                                                    
</span><span class='line'>    'gpio1_24' ] }
</span><span class='line'>USR3 (gpio 56) mode: 7 (gpio1_24) 0x060 pullup
</span><span class='line'>pin 24 (44e10860): (MUX UNCLAIMED) (GPIO UNCLAIMED)
</span></code></pre></td></tr></table></div></figure>


<p><code>gpio1_24</code> is what we want. Then refer Memory Map table in the Technical Reference Manual, its base address is 0x4804c000.</p>

<h3>devmem2</h3>

<p>An easy way to read the contents of a memory location is with devmem2:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~/code/gpio# devmem2 0x4804c13c
</span><span class='line'>/dev/mem opened.
</span><span class='line'>Memory mapped at address 0xb6fea000.
</span><span class='line'>Value at address 0x4804C13C (0xb6fea13c): 0x9A00000
</span></code></pre></td></tr></table></div></figure>


<p>Light ON the USR3 led:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~/code/gpio# devmem2 0x4804c190 w 0x01000000
</span><span class='line'>/dev/mem opened.
</span><span class='line'>Memory mapped at address 0xb6f52000.
</span><span class='line'>Value at address 0x4804C190 (0xb6f52190): 0x9800000
</span><span class='line'>Written 0x1000000; readback 0x1000000
</span></code></pre></td></tr></table></div></figure>


<p>Light OFF the USR3 led:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@arm:~/code/gpio# devmem2 0x4804c194 w 0x01000000
</span><span class='line'>/dev/mem opened.
</span><span class='line'>Memory mapped at address 0xb6f1c000.
</span><span class='line'>Value at address 0x4804C194 (0xb6f1c194): 0x8A00000
</span><span class='line'>Written 0x1000000; readback 0x1000000
</span></code></pre></td></tr></table></div></figure>


<h3>mmap code</h3>

<p>The critical Code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int fd = open("/dev/mem", O_RDWR);
</span><span class='line'>
</span><span class='line'>gpio_addr = mmap(0, GPIO1_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, GPIO1_START_ADDR);
</span><span class='line'>
</span><span class='line'>gpio_oe_addr           = gpio_addr + GPIO_OE;
</span><span class='line'>gpio_setdataout_addr   = gpio_addr + GPIO_SETDATAOUT;
</span><span class='line'>gpio_cleardataout_addr = gpio_addr + GPIO_CLEARDATAOUT;
</span><span class='line'>
</span><span class='line'>// Set USR3 to be an output pin
</span><span class='line'>reg = *gpio_oe_addr;
</span><span class='line'>printf("GPIO1 configuration: %X\n", reg);
</span><span class='line'>reg &= ~USR3;       // Set USR3 bit to 0
</span><span class='line'>*gpio_oe_addr = reg;
</span><span class='line'>printf("GPIO1 configuration: %X\n", reg);
</span><span class='line'>
</span><span class='line'>printf("Start blinking LED USR3\n");
</span><span class='line'>while(keepgoing) {
</span><span class='line'>    // printf("ON\n");
</span><span class='line'>    *gpio_setdataout_addr = USR3;
</span><span class='line'>    usleep(250000);
</span><span class='line'>    // printf("OFF\n");
</span><span class='line'>    *gpio_cleardataout_addr = USR3;
</span><span class='line'>    usleep(250000);
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>Run the program and see its heartbeat:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ./gpioToggle 
</span><span class='line'>Mapping 4804C000 - 4804E000 (size: 2000)
</span><span class='line'>GPIO mapped to 0xb6f91000
</span><span class='line'>GPIO OE mapped to 0xb6f91134
</span><span class='line'>GPIO SETDATAOUTADDR mapped to 0xb6f91194
</span><span class='line'>GPIO CLEARDATAOUT mapped to 0xb6f91190
</span><span class='line'>GPIO1 configuration: F60FFFFF
</span><span class='line'>GPIO1 configuration: F60FFFFF
</span><span class='line'>Start blinking LED USR3
</span></code></pre></td></tr></table></div></figure>


<h3>gpioThru</h3>

<p>This example need to be clearly written later.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/13/ebc-exercises-on-bbb-device-tree/">EBC Exercises on BBB - Device Tree</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-13T20:30:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:30 pm</span></time>
        
         | <a href="/blog/2014/11/13/ebc-exercises-on-bbb-device-tree/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Install js wrapped bonescript</h3>

<p>For using the javascript wrapped library, first we have to install following packages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install nodejs npm nodejs-legacy
</span><span class='line'>$ npm config set proxy http://1xx.xx.xx.xxx:2xxx
</span><span class='line'>$ npm config set https-proxy http://1xx.xx.xx.xx:2xxx
</span><span class='line'>$ npm install bonescript
</span></code></pre></td></tr></table></div></figure>


<p>Because my network environment is under the firewall, so I need to set the proxy, if you directly connect to internet, you could ignore the <code>npm config set</code> commands.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/17">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/15">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/24/wh-worktips-6/">WH Worktips(6)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/24/install-newest-version-of-cobbler/">Install Newest Version of Cobbler</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/23/import-more-isos-in-cobbler/">Import More ISOs in Cobbler</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/19/wh-worktips-5/">WH Worktips(5)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/19/wh-worktips-4/">WH Worktips(4)</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>


<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="Download the toolchain We should download the toolchain from the ARM employee maintained website, the download address is located at: https:// &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/38">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/21/setup-an-embedded-development-enviroment-for-stm32/">Setup an Embedded Development Enviroment for STM32</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-21T20:50:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>8:50 pm</span></time>
        
         | <a href="/blog/2013/11/21/setup-an-embedded-development-enviroment-for-stm32/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Download the toolchain</h3>

<p>We should download the toolchain from the ARM employee maintained website, the download address is located at: <a href="https://launchpad.net/gcc-arm-embedded">https://launchpad.net/gcc-arm-embedded</a>, use following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget https://launchpad.net/gcc-arm-embedded/4.7/4.7-2013-q3-update/+download/gcc-arm-none-eabi-4_7-2013q3-20130916-linux.tar.bz2
</span></code></pre></td></tr></table></div></figure>


<p>untar the downloaded package and then add it to your system path, my solution is directly add some alias into ~/.bashrc:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>### Add Cross_Compiler for eclipse based stm32
</span><span class='line'>#export PATH="/media/y/embedded/cortex/gcc-arm-none-eabi-4_7-2013q3/bin:$PATH"
</span><span class='line'>alias setstm='export PATH="/media/y/embedded/cortex/gcc-arm-none-eabi-4_7-2013q3/bin:$PATH"'
</span></code></pre></td></tr></table></div></figure>


<h3>Eclipse Configuration</h3>

<p>We have to install zylin for flashing the stm32 board. After installation, eclipse will be rebooted.</p>

<p><img src="/images/eclipseinstall.jpg" alt="images/eclipseinstall.jpg" /></p>

<h3>OpenOCD</h3>

<p>OpenOCD is a open-source hardware debugger.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>community/openocd 0.7.0-2
</span><span class='line'>    Debugging, in-system programming and boundary-scan testing for embedded target devices
</span><span class='line'>[root@XXXyyy capscr]# pacman -S openocd
</span></code></pre></td></tr></table></div></figure>


<h3>Template prepration</h3>

<p>Download the template from :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone https://github.com/JorgeAparicio/bareCortexM.git
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/21/two-tips-for-setting/">Two Tips for Setting</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-21T18:49:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>6:49 pm</span></time>
        
         | <a href="/blog/2013/11/21/two-tips-for-setting/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Disable the vim wraping</h3>

<p>There is a line in ~/.vimrc:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>autocmd FileType text setlocal textwidth=78
</span></code></pre></td></tr></table></div></figure>


<p>comment this line then everything goes OK.</p>

<h3>Change Awesome theme and change the titlebar width</h3>

<p>Download the 3rd party themes from <a href="https://github.com/Morley93/awesome-themes-3.5">https://github.com/Morley93/awesome-themes-3.5</a>, then copy them to your own theme location, normally under the &ldquo;/usr/share/awesome/themes/&rdquo;, Choose whatever you want, and edit the ~/.config/awesome/default.rc.lua:</p>

<figure class='code'><figcaption><span>rc.lua</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="n">beautiful</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">/usr/share/awesome/themes/wabbit/theme.lua&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Save and exit then you got the new theme.  <br/>
How to change the title bar? <br/>
In /usr/share/awesome/themes/wabbit/theme.lua, edit the following lines:</p>

<figure class='code'><figcaption><span>theme.lua</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="c1">--theme.font          = &quot;MonteCarlo medium 11&quot;</span>
</span><span class='line'><span class="n">theme</span><span class="p">.</span><span class="n">font</span>          <span class="o">=</span> <span class="s2">&quot;</span><span class="s">MonteCarlo medium 9&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I think 9 is good for me, but change this to 11 or bigger will make old men happy.   <br/>
You can change this number into a very big or very small number, then some funny things will happen :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/21/using-ir-remote-for-controlling-xbmc/">Using IR-remote for Controlling XBMC</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-21T15:57:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2013</span></span> <span class='time'>3:57 pm</span></time>
        
         | <a href="/blog/2013/11/21/using-ir-remote-for-controlling-xbmc/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Wiring</h3>

<p>The Wiring is listed as following Picture, You got your IR receiver&rsquo;s pins to corresponding pins on raspberry PI. Positive to Pin1(3.3v), negative to Pin6(GND), the signal pins to Pin12(GPIO 18).</p>

<p><img src="/images/rasp1.jpg" alt="rasp1.jpg" /></p>

<h3>Check the Kernel information</h3>

<p>Log on to the raspberry PI, then input dmesg to view the startup information, we can see the lirc has been added to kernel.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ dmesg
</span><span class='line'>[    4.976752] systemd-udevd[822]: starting version 208
</span><span class='line'>[    7.121052] lirc_dev: IR Remote Control driver registered, major 248 
</span><span class='line'>[    7.187858] lirc_rpi: module is from the staging directory, the quality is unknown, you have been warned.
</span><span class='line'>[    7.234864] lirc_rpi lirc_rpi.0: lirc_dev: driver lirc_rpi registered at minor = 0
</span><span class='line'>[    7.234894] lirc_rpi: driver registered!
</span><span class='line'>[    8.191460] lirc_rpi: auto-detected active low receiver on GPIO pin 18
</span><span class='line'>[    8.981462] input: lircd as /devices/virtual/input/input3
</span></code></pre></td></tr></table></div></figure>


<p>Now Let&rsquo;s check the GPIO status:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>OpenELEC:~ # cat /sys/kernel/debug/gpio 
</span><span class='line'>GPIOs 0-53, bcm2708_gpio:
</span><span class='line'> gpio-16  (led0                ) out hi
</span><span class='line'> gpio-17  (lirc_rpi ir/out     ) in  lo
</span><span class='line'> gpio-18  (lirc_rpi ir/in      ) in  hi
</span></code></pre></td></tr></table></div></figure>


<p>If it didn&rsquo;t appear, using:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>modprobe lirc_rpi gpio_in_pin=18 gpio_out_pin=1
</span></code></pre></td></tr></table></div></figure>


<h3>Getting your own remote controller&rsquo;s codes</h3>

<p>Now let&rsquo;s kill all of the lircd related process, then use mode2 to detect the infra-red remote input.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>OpenELEC:~ # ps -ef | grep lirc
</span><span class='line'>1016 root       0:00 eventlircd --evmap=/etc/eventlircd.d --socket=/var/run/lirc/lircd --release=_UP
</span><span class='line'>1035 root       0:00 /usr/sbin/lircd --driver=default --device=/dev/lirc0 --uinput --output=/var/run/lirc/lircd-lirc0 --pidfile=/var/run/lirc/lircd-lirc0.pid /etc/lirc/lircd.conf.rpi
</span><span class='line'>1070 root      16:02 /usr/lib/xbmc/xbmc.bin --standalone -fs --lircdev /var/run/lirc/lircd
</span><span class='line'>1146 root       0:00 grep lirc
</span><span class='line'>OpenELEC:~ # killall lirc
</span><span class='line'>What is mode2?  
</span><span class='line'>Trusty@SomethingMissing:~$ apt-cache search mode2
</span><span class='line'>lirc-x - infra-red remote control support - X utilities
</span></code></pre></td></tr></table></div></figure>


<p>Then Let&rsquo;s listen the infra_remote&rsquo;s input.The input is quite strange:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>space 4501241
</span><span class='line'>pulse 8917
</span><span class='line'>space 4415
</span><span class='line'>pulse 577
</span></code></pre></td></tr></table></div></figure>


<h3>Catching the code using irrecord</h3>

<p>The next step is turns these message into some code.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>OpenELEC:~/.config # pwd
</span><span class='line'>/storage/.config
</span><span class='line'>OpenELEC:~/.config # ls
</span><span class='line'>aacs                 samba.conf.sample    vpn-config
</span><span class='line'>hosts.conf           sysctl.conf.sample
</span><span class='line'>remote.conf          udev.rules.d.sample
</span></code></pre></td></tr></table></div></figure>


<p>Use irrecord for recording some signals and transform them into code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NAME
</span><span class='line'>       irrecord - application for recording IR-codes for usage with LIRC
</span><span class='line'>
</span><span class='line'>OpenELEC:~/.config # irrecord -d /dev/lirc0 lircd.conf
</span></code></pre></td></tr></table></div></figure>


<p>The method is, first long-press some keys, the result on screen will be several dots, then the program will change to another line, this time when you press some key, it only has one dot. Keep pressing keys until the irrecord tells you successful. Then you should input make some keys meaningful to the following images, when you feel satisfied, press enter to endup the program.</p>

<p><img src="/images/LIRCMAP.png" alt="LIRCMAP.png" /></p>

<p>Now your lircd.conf file is generated, let see what&rsquo;s in it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat lircd.conf
</span><span class='line'>begin remote
</span><span class='line'>
</span><span class='line'>  name  lircd.conf
</span><span class='line'>  flags RAW_CODES|CONST_LENGTH
</span><span class='line'>  eps            30
</span><span class='line'>  aeps          100
</span><span class='line'>
</span><span class='line'>  gap          106707
</span><span class='line'>
</span><span class='line'>      begin raw_codes
</span><span class='line'>
</span><span class='line'>          name KEY_UP
</span><span class='line'>             8953    4401     581     527     595     503
</span><span class='line'>              613     506     588     539     581     510
</span></code></pre></td></tr></table></div></figure>


<p>If you want to use the pre-defined files, simply go to the  <a href="http://lirc.sourceforge.net/remotes">lirc.sourceforge.net/remotes</a> you can find almost all of the remote control information.</p>

<h3>Using the infra-remote for controlling</h3>

<p>Now call irw, but irw stunned with doing nothing. This command will show you all of the input signal</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>OpenELEC:~ # irw
</span><span class='line'>6a 0 KEY_RIGHT devinput
</span><span class='line'>6a 0 KEY_RIGHT_UP devinput
</span><span class='line'>69 0 KEY_LEFT devinput
</span><span class='line'>69 0 KEY_LEFT_UP devinput
</span><span class='line'>6c 0 KEY_DOWN devinput
</span><span class='line'>6c 0 KEY_DOWN_UP devinput
</span></code></pre></td></tr></table></div></figure>


<p>Now in your XBMC window, you will see you can navigate and select something using your remote control.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/20/generate-your-own-epub-book/">Generate Your Own Epub Book</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-20T22:22:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:22 pm</span></time>
        
         | <a href="/blog/2013/11/20/generate-your-own-epub-book/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Using Wget to fetching the webpages</h3>

<p>wget could be used to fetch the webpages from a specified website, using following command could fetch all of the wiki related 1st layer pages from &ldquo;awesome Wiki&rdquo;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget -r -l 1 http://awesome.naquadah.org/wiki/Main_Page
</span></code></pre></td></tr></table></div></figure>


<p>After wget finished, you will found the 1st layer webpatges under your directory.</p>

<h3>Decide which you want for generating the book</h3>

<p>There are some rubbish pages in downloaed pages, thus we have to write a script for fetching the valuable ones, my script is listed as following:</p>

<figure class='code'><figcaption><span>custom.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>Trusty@DashArch wget<span class="o">]</span><span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/home/Trusty/wget
</span><span class='line'><span class="o">[</span>Trusty@DashArch wget<span class="o">]</span><span class="nv">$ </span><span class="nb">cd </span>awesome.naquadah.org/
</span><span class='line'><span class="o">[</span>Trusty@DashArch awesome.naquadah.org<span class="o">]</span><span class="nv">$ </span>ls
</span><span class='line'>doc  download  images  index.html  robots.txt  wiki
</span><span class='line'><span class="o">[</span>Trusty@DashArch awesome.naquadah.org<span class="o">]</span><span class="nv">$ </span><span class="nb">cd </span>wiki
</span><span class='line'><span class="o">[</span>Trusty@DashArch wiki<span class="o">]</span><span class="nv">$ </span>cat listitem.sh
</span><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="k">for</span> file in <span class="sb">`</span>ls <span class="sb">`</span>
</span><span class='line'><span class="k">do</span>
</span><span class='line'>  <span class="c">#echo $file</span>
</span><span class='line'>  <span class="nb">type</span><span class="o">=</span><span class="sb">`</span>file <span class="nv">$file</span> <span class="p">|</span> awk <span class="o">{</span><span class="s1">&#39;print $2&#39;</span><span class="o">}</span><span class="sb">`</span>
</span><span class='line'>  <span class="c">#echo $type</span>
</span><span class='line'>  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$type&quot;</span> <span class="o">=</span> <span class="s2">&quot;HTML&quot;</span> <span class="o">]</span>
</span><span class='line'>  <span class="k">then</span>
</span><span class='line'>      <span class="c">#echo $file</span>
</span><span class='line'>      <span class="c">#echo $type</span>
</span><span class='line'>      <span class="nb">echo</span> <span class="s2">&quot;&lt;a href=\&quot;$file\&quot;&gt;$file&lt;/a&gt;&lt;br/&gt;&quot;</span>
</span><span class='line'>  <span class="k">fi</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<p>simply run  listitem.sh, we will get the file list tables like following:</p>

<figure class='code'><figcaption><span>allfiles.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Automounting&quot;</span><span class="nt">&gt;</span>Automounting<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Autostart&quot;</span><span class="nt">&gt;</span>Autostart<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Autostart_with_consolekit&quot;</span><span class="nt">&gt;</span>Autostart_with_consolekit<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Autostop&quot;</span><span class="nt">&gt;</span>Autostop<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Awesome_3.0_to_3.1&quot;</span><span class="nt">&gt;</span>Awesome_3.0_to_3.1<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'>..........................................
</span></code></pre></td></tr></table></div></figure>


<p>Add them into the html like:</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'>   <span class="nt">&lt;body&gt;</span>
</span><span class='line'>     <span class="nt">&lt;h1&gt;</span>Table of Contents<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>     <span class="nt">&lt;p</span> <span class="na">style=</span><span class="s">&quot;text-indent:0pt&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Automounting&quot;</span><span class="nt">&gt;</span>Automounting<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Autostart&quot;</span><span class="nt">&gt;</span>Autostart<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'>......
</span><span class='line'>  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;XRandR_Screen_Table&quot;</span><span class="nt">&gt;</span>XRandR_Screen_Table<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;Xscreensaver&quot;</span><span class="nt">&gt;</span>Xscreensaver<span class="nt">&lt;/a&gt;&lt;br/&gt;</span>
</span><span class='line'>     <span class="nt">&lt;/p&gt;</span>
</span><span class='line'>   <span class="nt">&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Generate the ebook</h3>

<p>Use Calibre, click &ldquo;Add Book&rdquo;, navigate to your directory which contains &ldquo;index.html&rdquo;, choose it, and now you can do whatever you want to generate epub, mobi, or 6 inch pdf. Just enjoy your ebook!!!</p>

<figure class='code'><figcaption><span>index.html</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>[Trusty@DashArch Awesome (5)]$ ls -l -h
</span><span class='line'>total 4.5M
</span><span class='line'>-rw-r--r-- 1 Trusty root 887K Nov 20 21:07 Awesome - Dash.epub
</span><span class='line'>-rw-r--r-- 1 Trusty root 511K Nov 20 21:19 Awesome - Dash.mobi
</span><span class='line'>-rw-r--r-- 1 Trusty root 2.6M Nov 20 21:10 Awesome - Dash.pdf
</span><span class='line'>-rw-r--r-- 1 Trusty root 560K Nov 20 21:06 Awesome - Dash.zip
</span><span class='line'>-rw-r--r-- 1 Trusty root 1.1K Nov 20 21:18 metadata.opf
</span></code></pre></td></tr></table></div></figure>


<p>Depending on your settings, your generated ebook could be read on NOOK, Kindle, or other mobile equipment.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/20/problem-of-capcity/">Problem of Capcity</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-20T10:03:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:03 am</span></time>
        
         | <a href="/blog/2013/11/20/problem-of-capcity/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Image1:</p>

<p><img src="/images/rasp1.jpg" alt="rasp1.jpg" /></p>

<p>Image2:</p>

<p><img src="/images/rasp2.jpg" alt="rasp2.jpg" /></p>

<p>Image3:</p>

<p><img src="/images/rasp3.jpg" alt="rasp3.jpg" /></p>

<p>Image4:</p>

<p><img src="/images/rotater.jpg" alt="rasp4.jpg" /></p>

<p>Image5:</p>

<p><img src="/images/dubang.jpg" alt="rasp5.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/19/things-to-be-done-in-nov19/">Things to Be Done in Nov19</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-19T21:02:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>9:02 pm</span></time>
        
         | <a href="/blog/2013/11/19/things-to-be-done-in-nov19/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1. Awesome tips, for example, drop-down terminal.   <br/>
2. Verify the XBMC on Raspberry Pi.  <br/>
3. Using IRremote on XBMC and know its principle.   <br/>
4. BeagleBone&rsquo;s old kernel and the old style tutorial.  <br/>
5. Device tree of kernel on BeagleBone.  <br/>
6. MP3 Player in IRremote control on Arduino.   <br/>
7. Awesome Book in mobi or epub and send it to Kindle.  <br/>
8. How to enable the various display method on Arduino(12864, Nokia5110, etc?)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/19/install-openelec-on-sd-card/">Install OpenELEC on SD Card</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-19T20:37:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:37 pm</span></time>
        
         | <a href="/blog/2013/11/19/install-openelec-on-sd-card/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Partition the SD card</h3>

<p>Insert the SD card and view the partitions via fdisk -l, then</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# parted -s /dev/mmcblk0 mklabel msdos
</span><span class='line'>[root@XXXyyy Trusty]# fdisk -l
</span><span class='line'>Disk /dev/mmcblk0: 7.4 GiB, 7948206080 bytes, 15523840 sectors
</span><span class='line'>Units: sectors of 1 * 512 = 512 bytes
</span><span class='line'>Sector size (logical/physical): 512 bytes / 512 bytes
</span><span class='line'>I/O size (minimum/optimal): 512 bytes / 512 bytes
</span><span class='line'>Disklabel type: dos
</span><span class='line'>Disk identifier: 0x0002d03c
</span></code></pre></td></tr></table></div></figure>


<p>Make partition 1, fat32, and its size if 16 &ldquo;cyl&rdquo; (cylinders)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# parted -s /dev/mmcblk0 unit cyl mkpart primary fat32 -- 0 16
</span><span class='line'>Parameters
</span><span class='line'>unit unit
</span><span class='line'>   Set unit as the unit to use when displaying locations and  sizes, unit cyl means cylinders. 
</span><span class='line'>mkpart part-type [fs-type] start end
</span><span class='line'>Make  a  part-type  partition  for filesystem fs-type (if
</span><span class='line'>specified), beginning at start  and  ending  at  end  (by
</span><span class='line'>default  in megabytes).  part-type should be one of "pri‚Äê
</span><span class='line'>mary", "logical", or "extended".
</span></code></pre></td></tr></table></div></figure>


<p>Make the partition 1 bootable:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ parted -s /dev/mmcblk0 set 1 boot on
</span><span class='line'>Device         Boot Start       End Blocks  Id System
</span><span class='line'>/dev/mmcblk0p1 *     2048    258047 128000   c W95 FAT32 (LBA)
</span></code></pre></td></tr></table></div></figure>


<p>Make the second partition:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# parted -s /dev/mmcblk0 unit cyl mkpart primary ext2 -- 16 -2
</span><span class='line'>
</span><span class='line'>Device         Boot     Start       End  Blocks  Id System
</span><span class='line'>/dev/mmcblk0p1 *         2048    258047  128000   c W95 FAT32 (LBA)
</span><span class='line'>/dev/mmcblk0p2         258048  15491071 7616512  83 Linux
</span></code></pre></td></tr></table></div></figure>


<p>Now we can see the partitions:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# parted -s /dev/mmcblk0 print all
</span><span class='line'>Model: SD SU08G (sd/mmc)
</span><span class='line'>Disk /dev/mmcblk0: 7948MB
</span><span class='line'>Sector size (logical/physical): 512B/512B
</span><span class='line'>Partition Table: msdos
</span><span class='line'>Disk Flags: 
</span><span class='line'>
</span><span class='line'>Number  Start   End     Size    Type     File system  Flags
</span><span class='line'> 1      1049kB  132MB   131MB   primary               boot, lba
</span><span class='line'> 2      132MB   7931MB  7799MB  primary
</span></code></pre></td></tr></table></div></figure>


<h3>Make filesystems</h3>

<p>Make dos file systems(FAT32) in the first partition:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# mkfs.vfat -n System /dev/mmcblk0p1 
</span><span class='line'>mkfs.fat 3.0.23 (2013-10-15)
</span><span class='line'>mkfs.fat: warning - lowercase labels might not work properly with DOS or Windows
</span><span class='line'>-n means the volumn name
</span></code></pre></td></tr></table></div></figure>


<p>Make ext4 filesystems in the second partition:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# mkfs.ext4 -L Storage /dev/mmcblk0p2
</span><span class='line'>-L means the Label of the partition
</span></code></pre></td></tr></table></div></figure>


<h3>Copy to SD Card</h3>

<p>Mount the card</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy Trusty]# mount /dev/mmcblk0p1  /mnt
</span><span class='line'>[root@XXXyyy Trusty]# mount /dev/mmcblk0p2  /mnt1
</span></code></pre></td></tr></table></div></figure>


<p>Copy</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy bcm2835-bootloader-1100e2a]# pwd
</span><span class='line'>/media/x/code/openELEC/OpenELEC.tv/build.OpenELEC-RPi.arm-devel/bcm2835-bootloader-1100e2a
</span><span class='line'>[root@XXXyyy bcm2835-bootloader-1100e2a]# cp start.elf  /mnt/
</span><span class='line'>[root@XXXyyy bcm2835-bootloader-1100e2a]# ls
</span><span class='line'>bootcode.bin   fixup_cd.dat  fixup_x.dat       start_cd.elf  start_x.elf
</span><span class='line'>COPYING.linux  fixup.dat     LICENCE.broadcom  start.elf
</span><span class='line'>[root@XXXyyy bcm2835-bootloader-1100e2a]# sync
</span><span class='line'>[root@XXXyyy bcm2835-bootloader-1100e2a]# cp bootcode.bin /mnt/
</span><span class='line'>[root@XXXyyy bcm2835-bootloader-1100e2a]# sync
</span></code></pre></td></tr></table></div></figure>


<p>Copy kernel and System</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy target]# pwd
</span><span class='line'>/media/x/code/openELEC/OpenELEC.tv/target
</span><span class='line'>[root@XXXyyy target]# cp OpenELEC-RPi.arm-devel-20131119160254-r16396.kernel  /mnt/kernel.img
</span><span class='line'>[root@XXXyyy target]# sync
</span><span class='line'>[root@XXXyyy target]# cp OpenELEC-RPi.arm-devel-20131119160254-r16396.system /mnt/SYSTEM
</span><span class='line'>[root@XXXyyy target]# sync
</span></code></pre></td></tr></table></div></figure>


<p>Make the startup scripts:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@XXXyyy mnt]# echo "boot=/dev/mmcblk0p1 disk=/dev/mmcblk0p2 ssh quiet" | tee cmdline.txt
</span><span class='line'>boot=/dev/mmcblk0p1 disk=/dev/mmcblk0p2 ssh quiet
</span><span class='line'>[root@XXXyyy mnt]# ls
</span><span class='line'>bootcode.bin  cmdline.txt  kernel.img  start.elf  SYSTEM
</span><span class='line'>[root@XXXyyy mnt]# cat cmdline.txt 
</span><span class='line'>boot=/dev/mmcblk0p1 disk=/dev/mmcblk0p2 ssh quiet
</span></code></pre></td></tr></table></div></figure>


<h3>Startup</h3>

<p>Now Insert the SD Card into your Raspberry Pi, and enjoy the XBMC.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/19/using-autossh-for-keep-ssh-tunnel/">Using Autossh for Keep Ssh Tunnel</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-19T15:21:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>3:21 pm</span></time>
        
         | <a href="/blog/2013/11/19/using-autossh-for-keep-ssh-tunnel/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Preparation</h3>

<p>Install autossh:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S autossh
</span></code></pre></td></tr></table></div></figure>


<h3>Configure</h3>

<p>[root@DashArch Trusty]# cat /etc/systemd/system/autossh.service</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Unit]
</span><span class='line'>Description=AutoSSH service for port 1394 access to family machine
</span><span class='line'>After=network.target
</span><span class='line'>
</span><span class='line'>[Service]
</span><span class='line'>ExecStart=/usr/bin/autossh -M 22000  -N -T -D 1394 root@aaa.aaa.aaa.com
</span><span class='line'>
</span><span class='line'>[Install]
</span><span class='line'>WantedBy=multi-user.target
</span></code></pre></td></tr></table></div></figure>


<h3>Usage</h3>

<p>Change the proxy to 127.0.0.1, port is 1394, then you can use the ssh tunnel for browsing.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/19/use-reverse-ssh-for-across-something-2/">Use Reverse SSH for Across Something(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-19T14:03:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>2:03 pm</span></time>
        
         | <a href="/blog/2013/11/19/use-reverse-ssh-for-across-something-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>ssh command</h3>

<p>Take following command for detailed example of using ssh:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>alias mydaili='ssh -qTfnN -D '
</span><span class='line'>-q Quite Mode
</span><span class='line'>-T Disable pseudo-tty allocation
</span><span class='line'>-f background the ssh
</span><span class='line'>-n redirect the stdin from /dev/null
</span><span class='line'>-N Don't execute a remote command
</span><span class='line'>-D Bind address
</span></code></pre></td></tr></table></div></figure>


<h3>Using rsh</h3>

<p>rsh could be used for executing the command remotely, thus in my family&rsquo;s debian machine I could write following script:</p>

<figure class='code'><figcaption><span>remoteON.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>cat /bin/remoteON
</span><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'>rsh -l root localhost -p <span class="m">4381</span>  ssh -qTfnN -L 1XX.XXX.XXX.XXX:9004:1XX.XXX.XXX.XXX:8000 USERNAME@remoteserver.com <span class="p">&amp;</span>
</span><span class='line'>chmod <span class="m">777</span> /bin/remoteON
</span></code></pre></td></tr></table></div></figure>


<p>For killing the remote machines&rsquo;s running ssh tunnel process, write another script:</p>

<figure class='code'><figcaption><span>remoteOFF.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>!#/bin/sh
</span><span class='line'><span class="c">#Fetch the ssh id</span>
</span><span class='line'><span class="nv">sshid</span><span class="o">=</span><span class="sb">`</span>rsh -l root localhost -p <span class="m">4381</span> ps <span class="p">|</span> grep <span class="s2">&quot;ssh -qTfnN&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="sb">`</span>
</span><span class='line'><span class="c">#Kill the selected process</span>
</span><span class='line'>rsh -l root localhost -p <span class="m">4381</span> <span class="nb">kill</span> <span class="nv">$sshid</span>
</span><span class='line'><span class="nv">$ </span>chmod <span class="m">777</span> /bin/remoteOFF
</span></code></pre></td></tr></table></div></figure>


<h3>Write the local script</h3>

<p>Local Scripts is for calling the remoteON and remoteOFF.   <br/>
Script for starting the proxy</p>

<figure class='code'><figcaption><span>startproxy.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="c">#Start the openWRT Tunnel</span>
</span><span class='line'>rsh -l root 10.0.0.111 /bin/remoteON <span class="p">&amp;</span>
</span><span class='line'><span class="c">#Sleep 3 seconds</span>
</span><span class='line'>sleep 3
</span><span class='line'><span class="c">#Start the Debian Tunnel</span>
</span><span class='line'>rsh -l root 10.0.0.111 ssh -qTfnN -L 10.0.0.111:9001:1XX.XXX.XXX.XXX:9004 root@localhost -p <span class="m">4381</span> <span class="p">&amp;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Script for stopping the proxy</p>

<figure class='code'><figcaption><span>stopproxy.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="c"># Stop the openWRT Tunnel:</span>
</span><span class='line'>rsh -l root 10.0.0.111 /bin/remoteOFF <span class="p">&amp;</span>
</span><span class='line'><span class="c"># Sleep 3 seconds</span>
</span><span class='line'>sleep 3
</span><span class='line'><span class="c"># Stop the Debian Tunnel</span>
</span><span class='line'><span class="nv">sshid</span><span class="o">=</span><span class="sb">`</span>rsh -l root 10.0.0.111 ps -ef <span class="p">|</span> grep <span class="s2">&quot;ssh -qTfnN&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span><span class='line'>rsh -l root 10.0.0.111 <span class="nb">kill</span> <span class="nv">$sshid</span> <span class="p">&amp;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>How to use it?</h3>

<p>If you want to use proxy, simply ./startproxy.sh.   <br/>
After using the proxy, you can ./stopproxy.sh for totally release the connection and release the resources.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/11/18/use-reverse-ssh-for-across-something/">Use Reverse SSH for Across Something</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-11-18T19:01:00+08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>7:01 pm</span></time>
        
         | <a href="/blog/2013/11/18/use-reverse-ssh-for-across-something/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Enable No Password for Login</h3>

<p>Generate the public/private rsa key pair.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@OpenWrt:~# ssh-keygen -t rsa
</span><span class='line'>root@OpenWrt:~# ls ~/.ssh
</span><span class='line'>authorized_keys  id_rsa           id_rsa.pub       known_hosts
</span><span class='line'>Upload the id_rsa.pub to the Home's PC.
</span><span class='line'># cat .ssh/id_rsa.pub | ssh USER@HOME_PC 'cat &gt;&gt; .ssh/authorized_keys'
</span><span class='line'>Check If you can login without entering the password:
</span><span class='line'>$ ssh USER@HOME_PC
</span></code></pre></td></tr></table></div></figure>


<h3>OpenWRT Modification</h3>

<p>Since the default ssh client is dropbear on OpenWRT, thus the key length is 1024, we have to using the 2048 for most of the cases. so we have to remove dropbear, and install openssh-client for linking to our home PC.  <br/>
Change the /etc/init.d/dropbear&rsquo;s listenning port from 22 to 2222 or other ports, this doesn&rsquo;t matter, for later we will totally remove the dropbear.   <br/>
Now remove the dropbear</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ opkg remove dropbear
</span></code></pre></td></tr></table></div></figure>


<p>Install the packages of openssh:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ opkg install openssh-client openssh-sftp-client sshtunnel openssh-keygen
</span><span class='line'>$ opkg install openssh-client-utils
</span></code></pre></td></tr></table></div></figure>


<p>Now using &ldquo; ssh-keygen -t rsa&rdquo;  we will  get the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+--[ RSA 2048]----+
</span></code></pre></td></tr></table></div></figure>


<p>But previous we got is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+--[ DSA 1024]----+
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s why we can&rsquo;t use dropbear for login to HOME PC.</p>

<h3>autossh Configuration</h3>

<p>Install autossh on your own OpenWRT</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ opkg install autossh
</span></code></pre></td></tr></table></div></figure>


<p>Edit the configuration file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@OpenWrt:~# cat /etc/config/autossh 
</span><span class='line'>config autossh
</span><span class='line'>  option ssh  '-N -T -R 4381:localhost:22 root@goewugouog.gowugoeug.com '
</span><span class='line'>  option gatetime '0'
</span><span class='line'>  option monitorport  '20000'
</span><span class='line'>  option poll '600'
</span></code></pre></td></tr></table></div></figure>


<p>Start the server immediately, later it will be started automatically:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /etc/init.d/autossh start
</span></code></pre></td></tr></table></div></figure>


<h3>Jump to the Open World!!!</h3>

<p>Jump to the American Server on OpenWRT:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ssh -L 13@.XXX.XXX.XXX:9004:13g.XXX.XXX.XXX:8000 fXXXXXX@remote.american.com
</span></code></pre></td></tr></table></div></figure>


<p>From Home machine Jump to the OpenWRT in company:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ssh -L 10.0.0.111:9001:13@.XXX.XXX.XXX:9004 root@localhost -p 4381
</span></code></pre></td></tr></table></div></figure>


<p>Now the connection has been setup between your family network to company network, finally to the US network.</p>

<p>Enjoy Jumping!!!</p>

<h3>How to make it automatically?</h3>

<p>Maybe I can write the script to make it automatically executed.   Via python or via expect? Maybe try python.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/39">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/37">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/01/chef-for-deploying-openstack/">Chef for Deploying OpenStack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/26/chef-setup/">Chef Setup</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/25/tips-on-deleteing-neutron-subnet-and-router/">Tips on Deleteing Neutron Subnet and Router</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/25/san-jie-dian-da-jian-openstack-juno-4/">‰∏âËäÇÁÇπÊê≠Âª∫OpenStack Juno(4)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/25/san-jie-dian-da-jian-openstack-juno-3/">‰∏âËäÇÁÇπÊê≠Âª∫OpenStack Juno(3)</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>

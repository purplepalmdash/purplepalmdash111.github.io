
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="Preparation By default the lxd is installed in ubuntu1604. Image The image file are downloaded before we actually install it, install the image via: &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/2">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//fonts.googleapis.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/11/setup-lxd-on-ubuntu1604/">Setup LXD on Ubuntu1604</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-11T15:38:23+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>3:38 pm</span></time>
        
         | <a href="/blog/2016/05/11/setup-lxd-on-ubuntu1604/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Preparation</h3>

<p>By default the lxd is installed in ubuntu1604.</p>

<h3>Image</h3>

<p>The image file are downloaded before we actually install it, install the image via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lxc image import ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-16.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu1604
</span><span class='line'>$ lxc image list
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |             DESCRIPTION              |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu1604   | f4c4c60a6b75 | no     | Ubuntu 16.04 LTS server (20160420.3) | x86_64 | 137.54MB | May 10, 2016 at 2:18pm (UTC) </span></code></pre></td></tr></table></div></figure>


<h3>Start Container</h3>

<p>Start the container via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lxc launch ubuntu1604 first1404
</span><span class='line'>$ lxc list
</span><span class='line'>+------------+---------+------+------+------------+-----------+
</span><span class='line'>|    NAME    |  STATE  | IPV4 | IPV6 |    TYPE    | SNAPSHOTS |
</span><span class='line'>+------------+---------+------+------+------------+-----------+
</span><span class='line'>| first1404  | RUNNING |      |      | PERSISTENT | 0         |
</span><span class='line'>+------------+---------+------+------+------------+-----------+</span></code></pre></td></tr></table></div></figure>


<p>Attach to the running container via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lxc exec first1404 /bin/bash</span></code></pre></td></tr></table></div></figure>


<p>In this container you could do anything, for your customization of the container.</p>

<h3>More Images</h3>

<p>After your modification is done, shutdown the running container, and submit your
modification to a new container:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lxc publish second1604 --alias my-new-image
</span><span class='line'>$ lxc image list
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |             DESCRIPTION              |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| my-new-image | 67de38342bfa | no     |                                      | x86_64 | 192.29MB | May 11, 2016 at 7:07am (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu1604   | f4c4c60a6b75 | no     | Ubuntu 16.04 LTS server (20160420.3) | x86_64 | 137.54MB | May 10, 2016 at 2:18pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+</span></code></pre></td></tr></table></div></figure>


<h3>Container Networking</h3>

<p>The default networking is a seperated network, but we could set the lxd using the hosted
network, via following steps:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/network/interfaces
</span><span class='line'>
</span><span class='line'>auto ens3
</span><span class='line'>iface ens3 inet manual
</span><span class='line'>
</span><span class='line'>auto containerbr 
</span><span class='line'>iface containerbr inet static
</span><span class='line'>address 192.168.10.193
</span><span class='line'>netmask 255.255.0.0
</span><span class='line'>gateway 192.168.0.176
</span><span class='line'>dns-nameservers 180.76.76.76
</span><span class='line'>bridge_ports ens3</span></code></pre></td></tr></table></div></figure>


<p>Reboot the machine, you have the running bridge <code>containerbr</code>, now you could set your bridge to this
newly created bridge:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lxc profile device set default eth0 parent containerbr</span></code></pre></td></tr></table></div></figure>


<p>Via this you cuold set the same subnet networking address just as in <code>containerbr</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/10/tips-on-lxc/">Tips on Lxc</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-10T22:17:35+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:17 pm</span></time>
        
         | <a href="/blog/2016/05/10/tips-on-lxc/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Working Tips</h3>

<p>Just for importing the images and let it run in lxc</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dash@ubuntu:~/may10$ ls
</span><span class='line'>ubuntu-14.04-server-cloudimg-amd64-lxd.tar.xz   ubuntu-15.04-snappy-amd64-generic.img.xz       ubuntu-16.04-server-cloudimg-amd64-root.tar.xz
</span><span class='line'>ubuntu-14.04-server-cloudimg-amd64-root.tar.xz  ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz
</span><span class='line'>dash@ubuntu:~/may10$ lxc image import ubuntu-14.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-14.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu:14.04
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Image imported with fingerprint: b69c9370446a28c02ad5b0d41f07e028a1756a74bee62b7d59467201a6488fc2
</span><span class='line'>dash@ubuntu:~/may10$ lxc image list
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |            DESCRIPTION             |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu:14.04 | b69c9370446a | no     | Ubuntu 14.04 LTS server (20160406) | x86_64 | 118.89MB | May 10, 2016 at 2:16pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu:14.04 first1404
</span><span class='line'>Creating first1404
</span><span class='line'>error: Get https://cloud-images.ubuntu.com/releases/streams/v1/index.json: lookup cloud-images.ubuntu.com on 180.76.76.76:53: read udp 10.47.58.215:44871-&gt;180.76.76.76:53: i/o timeout
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch b69c9370446a first1404
</span><span class='line'>Creating first1404
</span><span class='line'>Starting first1404
</span><span class='line'>dash@ubuntu:~/may10$ lxc image import ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-16.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu1604
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Image imported with fingerprint: f4c4c60a6b752a381288ae72a1689a9da00f8e03b732c8d1b8a8fcd1a8890800
</span><span class='line'>dash@ubuntu:~/may10$ lxc image list
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |             DESCRIPTION              |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu1604   | f4c4c60a6b75 | no     | Ubuntu 16.04 LTS server (20160420.3) | x86_64 | 137.54MB | May 10, 2016 at 2:18pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu:14.04 | b69c9370446a | no     | Ubuntu 14.04 LTS server (20160406)   | x86_64 | 118.89MB | May 10, 2016 at 2:16pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu1604 first1404
</span><span class='line'>Creating first1404
</span><span class='line'>error: The container already exists
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu1604 first1604
</span><span class='line'>Creating first1604
</span><span class='line'>Starting first1604
</span><span class='line'>dash@ubuntu:~/may10$ lxc exec first1604 /bin/bash
</span><span class='line'>root@first1604:~# ls
</span><span class='line'>root@first1604:~# ifconfig
</span><span class='line'>eth0      Link encap:Ethernet  HWaddr 00:16:3e:b0:f2:c3  
</span><span class='line'>          inet addr:10.226.147.79  Bcast:10.226.147.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::216:3eff:feb0:f2c3/64 Scope:Link
</span><span class='line'>dash@ubuntu:~/may10$ ls
</span><span class='line'>ubuntu-14.04-server-cloudimg-amd64-lxd.tar.xz   ubuntu-15.04-snappy-amd64-generic.img.xz       ubuntu-16.04-server-cloudimg-amd64-root.tar.xz
</span><span class='line'>ubuntu-14.04-server-cloudimg-amd64-root.tar.xz  ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz
</span><span class='line'>dash@ubuntu:~/may10$ lxc image import ubuntu-14.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-14.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu:14.04
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Image imported with fingerprint: b69c9370446a28c02ad5b0d41f07e028a1756a74bee62b7d59467201a6488fc2
</span><span class='line'>dash@ubuntu:~/may10$ lxc image list
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |            DESCRIPTION             |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu:14.04 | b69c9370446a | no     | Ubuntu 14.04 LTS server (20160406) | x86_64 | 118.89MB | May 10, 2016 at 2:16pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu:14.04 first1404
</span><span class='line'>Creating first1404
</span><span class='line'>error: Get https://cloud-images.ubuntu.com/releases/streams/v1/index.json: lookup cloud-images.ubuntu.com on 180.76.76.76:53: read udp 10.47.58.215:44871-&gt;180.76.76.76:53: i/o timeout
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch b69c9370446a first1404
</span><span class='line'>Creating first1404
</span><span class='line'>Starting first1404
</span><span class='line'>dash@ubuntu:~/may10$ lxc image import ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-16.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu1604
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Image imported with fingerprint: f4c4c60a6b752a381288ae72a1689a9da00f8e03b732c8d1b8a8fcd1a8890800
</span><span class='line'>dash@ubuntu:~/may10$ lxc image list
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |             DESCRIPTION              |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu1604   | f4c4c60a6b75 | no     | Ubuntu 16.04 LTS server (20160420.3) | x86_64 | 137.54MB | May 10, 2016 at 2:18pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu:14.04 | b69c9370446a | no     | Ubuntu 14.04 LTS server (20160406)   | x86_64 | 118.89MB | May 10, 2016 at 2:16pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu1604 first1404
</span><span class='line'>Creating first1404
</span><span class='line'>error: The container already exists
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu1604 first1604
</span><span class='line'>Creating first1604
</span><span class='line'>Starting first1604
</span><span class='line'>dash@ubuntu:~/may10$ lxc exec first1604 /bin/bash
</span><span class='line'>root@first1604:~# ls
</span><span class='line'>root@first1604:~# ifconfig
</span><span class='line'>eth0      Link encap:Ethernet  HWaddr 00:16:3e:b0:f2:c3  
</span><span class='line'>          inet addr:10.226.147.79  Bcast:10.226.147.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::216:3eff:feb0:f2c3/64 Scope:Link
</span><span class='line'>dash@ubuntu:~/may10$ ls
</span><span class='line'>ubuntu-14.04-server-cloudimg-amd64-lxd.tar.xz   ubuntu-15.04-snappy-amd64-generic.img.xz       ubuntu-16.04-server-cloudimg-amd64-root.tar.xz
</span><span class='line'>ubuntu-14.04-server-cloudimg-amd64-root.tar.xz  ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz
</span><span class='line'>dash@ubuntu:~/may10$ lxc image import ubuntu-14.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-14.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu:14.04
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Image imported with fingerprint: b69c9370446a28c02ad5b0d41f07e028a1756a74bee62b7d59467201a6488fc2
</span><span class='line'>dash@ubuntu:~/may10$ lxc image list
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |            DESCRIPTION             |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu:14.04 | b69c9370446a | no     | Ubuntu 14.04 LTS server (20160406) | x86_64 | 118.89MB | May 10, 2016 at 2:16pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+------------------------------------+--------+----------+------------------------------+
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu:14.04 first1404
</span><span class='line'>Creating first1404
</span><span class='line'>error: Get https://cloud-images.ubuntu.com/releases/streams/v1/index.json: lookup cloud-images.ubuntu.com on 180.76.76.76:53: read udp 10.47.58.215:44871-&gt;180.76.76.76:53: i/o timeout
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch b69c9370446a first1404
</span><span class='line'>Creating first1404
</span><span class='line'>Starting first1404
</span><span class='line'>dash@ubuntu:~/may10$ lxc image import ubuntu-16.04-server-cloudimg-amd64-lxd.tar.xz ubuntu-16.04-server-cloudimg-amd64-root.tar.xz --alias ubuntu1604
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Transferring image: 100%
</span><span class='line'>Image imported with fingerprint: f4c4c60a6b752a381288ae72a1689a9da00f8e03b732c8d1b8a8fcd1a8890800
</span><span class='line'>dash@ubuntu:~/may10$ lxc image list
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>|    ALIAS     | FINGERPRINT  | PUBLIC |             DESCRIPTION              |  ARCH  |   SIZE   |         UPLOAD DATE          |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu1604   | f4c4c60a6b75 | no     | Ubuntu 16.04 LTS server (20160420.3) | x86_64 | 137.54MB | May 10, 2016 at 2:18pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>| ubuntu:14.04 | b69c9370446a | no     | Ubuntu 14.04 LTS server (20160406)   | x86_64 | 118.89MB | May 10, 2016 at 2:16pm (UTC) |
</span><span class='line'>+--------------+--------------+--------+--------------------------------------+--------+----------+------------------------------+
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu1604 first1404
</span><span class='line'>Creating first1404
</span><span class='line'>error: The container already exists
</span><span class='line'>dash@ubuntu:~/may10$ lxc launch ubuntu1604 first1604
</span><span class='line'>Creating first1604
</span><span class='line'>Starting first1604
</span><span class='line'>dash@ubuntu:~/may10$ lxc exec first1604 /bin/bash
</span><span class='line'>root@first1604:~# ls
</span><span class='line'>root@first1604:~# ifconfig
</span><span class='line'>eth0      Link encap:Ethernet  HWaddr 00:16:3e:b0:f2:c3  
</span><span class='line'>          inet addr:10.226.147.79  Bcast:10.226.147.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::216:3eff:feb0:f2c3/64 Scope:Link
</span><span class='line'>....</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/09/working-tips-on-mesos-slash-ansible/">Working Tips on Mesos/Ansible</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-09T12:20:34+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:20 pm</span></time>
        
         | <a href="/blog/2016/05/09/working-tips-on-mesos-slash-ansible/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Package Prepare</h3>

<p>We have the default vagrant box generated by bento, listed it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>âžœ  mesos vagrant box list | grep -i centos | grep -i virtualbox
</span><span class='line'>centos72                                     (virtualbox, 0)</span></code></pre></td></tr></table></div></figure>


<p>Now we want to generate a new box from it, and added our own configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant init centos72
</span><span class='line'>$ vagrant up
</span><span class='line'>$ vagrant ssh</span></code></pre></td></tr></table></div></figure>


<p>Edit for keeping the cache:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/yum.conf  | more
</span><span class='line'>[main]
</span><span class='line'>cachedir=/home/vagrant/rpms/$basearch/$releasever
</span><span class='line'>#keepcache=0
</span><span class='line'>keepcache=1</span></code></pre></td></tr></table></div></figure>


<p>Now poweroff the machine and export it to the new box:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant package --output centoslocalrpm.box
</span><span class='line'>$ vagrant box add centoslocalrpm centoslocalrpm.box</span></code></pre></td></tr></table></div></figure>


<p>Using the new box, the rpm packages could be saved into the folder
<code>/home/vagrant/rpms</code>.</p>

<h3>Deploy Using Ansible</h3>

<p>Refers to  <br/>
<a href="https://open.mesosphere.com/advanced-course/recreating-the-cluster-using-ansible/">https://open.mesosphere.com/advanced-course/recreating-the-cluster-using-ansible/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/06/working-tips-on-ansible-cobbler-2/">Working Tips on Ansible-cobbler(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-06T15:03:59+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>3:03 pm</span></time>
        
         | <a href="/blog/2016/05/06/working-tips-on-ansible-cobbler-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>AIM</h3>

<p>Change the vagrant box to libvirt, and let this libvirt machine working properly.</p>

<h3>Image Transformation</h3>

<p>Transform the image via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ VBoxManage clonehd /home/dash/VirtualBox\ VMs/ansible-cobbler_cobbler-ubuntu_1462410925173_15793/packer-virtualbox-iso-1454031074-disk1.vmdk /home/dash/output.img --format raw && qemu-img convert -f raw /home/dash/output.img -O qcow2 /home/dash/ansible-cobbler.qcow2
</span><span class='line'>0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
</span><span class='line'>Clone medium created in format 'raw'. UUID: 6fbb99be-8004-43b5-831b-ec794a001c10</span></code></pre></td></tr></table></div></figure>


<h3>Qemu Virtual Machine</h3>

<p>Create a new machine, then configure the networking, edit the cobbler setting/dhcp setting, then <code>cobbler sync</code>, now the cobbler is adjusting to new environment.</p>

<p>More detailed info could be seen in:</p>

<p><a href="http://purplepalmdash.github.io/blog/2015/07/10/wh-worktips-9/">http://purplepalmdash.github.io/blog/2015/07/10/wh-worktips-9/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/04/linux-tips-5/">Linux Tips(5)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-04T20:03:21+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>8:03 pm</span></time>
        
         | <a href="/blog/2016/05/04/linux-tips-5/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>1. Detach Running Tasks</h3>

<p><code>Ctrl+Z</code> for suspend the tasks, then <code>bg</code> it, now you could use <code>disown %1</code> for
detaching the running process.</p>

<p>Next time you login, you will see this background task is also running.</p>

<h3>2. Installation of Cobbler</h3>

<p>Shell Scripts:</p>

<p><a href="https://gist.github.com/luisbolson/1d0dc42976d2468171d0">https://gist.github.com/luisbolson/1d0dc42976d2468171d0</a></p>

<h3>3. yum groups</h3>

<p><a href="http://ramblings.narrabilis.com/creating-a-yum-repository-repo-and-creating-a-yum-group-to-install-kickstart">http://ramblings.narrabilis.com/creating-a-yum-repository-repo-and-creating-a-yum-group-to-install-kickstart</a></p>

<h3>4. rvm issue</h3>

<p>rvm met <code>openssl.so (LoadError)</code>, could be solved via following steps.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$  curl https://github.com/ruby/ruby/commit/801e1fe46d83c856844ba18ae4751478c59af0d1.diff &gt; openssl.patch\n
</span><span class='line'>$  rvm install 1.9.3 --with-openssl-dir=$HOME/.rvm/usr --patch ./openssl.patch </span></code></pre></td></tr></table></div></figure>


<h3>5. Get the name of rpm packages</h3>

<p>Only print the name of the rpm package:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># rpm -qp --queryformat '%{NAME}\n' *.rpm&gt;package.list</span></code></pre></td></tr></table></div></figure>


<h3>6. xargs tips</h3>

<p>Example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># find . -type f -exec grep -ilR "MY PATTERN" {} \; | xargs -I % cp % /dest/dir/</span></code></pre></td></tr></table></div></figure>


<p>For me, I find out all of the packges in cache file, and copy them to another position:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ find . | \grep rpm$ | xargs -I % cp % /home/dash/rpms</span></code></pre></td></tr></table></div></figure>


<h3>7. Make local repo</h3>

<p>From the stackoverflow answers.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Yes as you've described it, it sounds doable. I think I would be inclined to do the
</span><span class='line'>following steps.
</span><span class='line'>
</span><span class='line'>Setup directories
</span><span class='line'>$ mkdir {Desktop,Desktop_Platform,X_Window_System,Fonts}
</span><span class='line'>Download RPMs
</span><span class='line'>Then run these types of commands to download the RPMs for the given groups:
</span><span class='line'>
</span><span class='line'>$ repoquery --qf=%{name} -g --list --grouppkgs=all "Fonts" | \
</span><span class='line'>     xargs -I{} repotrack -a x86_64 -p Fonts/ {}
</span><span class='line'>You can wrap it in a for loop too:
</span><span class='line'>
</span><span class='line'>$ for i in "Desktop" "Desktop_Platform" "X_Window_System" "Fonts";do  
</span><span class='line'>    repoquery --qf=%{name} -g --list --grouppkgs=all "$i" | \
</span><span class='line'>       xargs -I{} repotrack -a x86_64 -p $i/ {}; 
</span><span class='line'>  done
</span><span class='line'>This will go through each group and download the packages into their respective
</span><span class='line'>directories.
</span><span class='line'>
</span><span class='line'>Re-installation
</span><span class='line'>Then use the command as you've described:
</span><span class='line'>
</span><span class='line'>$ yum --nogpgcheck localinstall {Desktop,Desktop_Platform,X_Window_System,Fonts}/*.rpm</span></code></pre></td></tr></table></div></figure>


<h3>8. Simple Screen Recorder</h3>

<p>Ubuntu:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo add-apt-repository ppa:maarten-baert/simplescreenrecorder
</span><span class='line'>sudo apt-get update
</span><span class='line'>sudo apt-get install simplescreenrecorder
</span><span class='line'># if you want to record 32-bit OpenGL applications on a 64-bit system:
</span><span class='line'>sudo apt-get install simplescreenrecorder-lib:i386</span></code></pre></td></tr></table></div></figure>


<p>ArchLinux:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S simplescreenrecorder</span></code></pre></td></tr></table></div></figure>


<h3>9. Convert virtualbox hd to qcow2</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>VBoxManage clonehd /home/dash/VirtualBox\ VMs/ansible-cobbler_cobbler-ubuntu_1462410925173_15793/packer-virtualbox-iso-1454031074-disk1.vmdk /home/dash/output.img --format raw && qemu-img convert -f raw /home/dash/output.img -O qcow2 /home/dash/ansible-cobbler.qcow2</span></code></pre></td></tr></table></div></figure>


<h3>10. Ansible issue</h3>

<p>The isssue is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ansible: ERROR: become is not a legal parameter in an Ansible Playbook</span></code></pre></td></tr></table></div></figure>


<p>Solved via upgrading to the newest version of ansible:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install software-properties-common
</span><span class='line'>$ sudo apt-add-repository ppa:ansible/ansible
</span><span class='line'>$ sudo apt-get update
</span><span class='line'>$ sudo apt-get install ansible</span></code></pre></td></tr></table></div></figure>


<p>Using the newest ansible you could aoid this error.</p>

<h3>11. Create customized lxc image</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://unix.stackexchange.com/questions/186638/how-to-make-a-local-template-for-a-linux-container-and-point-to-that</span></code></pre></td></tr></table></div></figure>


<p><a href="https://insights.ubuntu.com/2015/03/20/installing-lxd-and-the-command-line-tool/">https://insights.ubuntu.com/2015/03/20/installing-lxd-and-the-command-line-tool/</a></p>

<p><a href="https://www.stgraber.org/2016/03/30/lxd-2-0-image-management-512/">https://www.stgraber.org/2016/03/30/lxd-2-0-image-management-512/</a></p>

<p><a href="https://insights.ubuntu.com/2016/04/01/lxd-2-0-image-management-512/">https://insights.ubuntu.com/2016/04/01/lxd-2-0-image-management-512/</a></p>

<h3>12. Changing to eth0 in Ubuntu</h3>

<p>Modify the name of <code>enps*</code> to <code>eth0/1/2/3/4/</code>, via following steps:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>try this: Edit your /etc/default/grub. Change the line from
</span><span class='line'>
</span><span class='line'>GRUB_CMDLINE_LINUX=""
</span><span class='line'>to
</span><span class='line'>
</span><span class='line'>GRUB_CMDLINE_LINUX="net.ifnames=0 biosdevname=0"
</span><span class='line'>and, finally run:
</span><span class='line'>
</span><span class='line'># update-grub</span></code></pre></td></tr></table></div></figure>


<h3>13. MAAS Syncing PXE File</h3>

<p><a href="https://maas.ubuntu.com/docs/sstreams-mirror.html">https://maas.ubuntu.com/docs/sstreams-mirror.html</a>  <br/>
<a href="http://ytooyama.hatenadiary.jp/entry/2016/05/11/002532">http://ytooyama.hatenadiary.jp/entry/2016/05/11/002532</a></p>

<p>For building our own MAAS image:</p>

<p><a href="http://askubuntu.com/questions/744966/how-do-you-install-the-maas-image-builder-on-14-04-lts">http://askubuntu.com/questions/744966/how-do-you-install-the-maas-image-builder-on-14-04-lts</a></p>

<h3>14. Vagrant For MAAS</h3>

<p><a href="https://github.com/battlemidget/vagrant-maas">https://github.com/battlemidget/vagrant-maas</a></p>

<p><a href="https://github.com/battlemidget/vagrant-maas-in-a-box/blob/master/Vagrantfile">https://github.com/battlemidget/vagrant-maas-in-a-box/blob/master/Vagrantfile</a></p>

<h3>15. Convert vm to physical</h3>

<p>Thus you could enjoy packer building the physical machine! :)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /media/wherever-the-image-is/
</span><span class='line'>
</span><span class='line'># for VMWare
</span><span class='line'>sudo apt-get install qemu-kvm
</span><span class='line'>qemu-img convert your-vmware-disk.vmdk -O raw disk.img
</span><span class='line'>
</span><span class='line'># For VirtualBox
</span><span class='line'>VBoxManage internalcommands converttoraw your-virtualbox-disk.vdi /dev/sdX</span></code></pre></td></tr></table></div></figure>


<h3>16. Generate Random Seed</h3>

<p>Error message is <code>Please do some other work to give
the OS a chance to collect more entropy!</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo aptitude install haveged</span></code></pre></td></tr></table></div></figure>


<h3>17. DEB Repository in Cobbler</h3>

<p><a href="https://github.com/cobbler/cobbler/wiki/Creating-custom-apt-repositories-in-centos-or-el-based-cobbler">https://github.com/cobbler/cobbler/wiki/Creating-custom-apt-repositories-in-centos-or-el-based-cobbler</a></p>

<p>Trouble-Shooting:  <br/>
<a href="https://github.com/cobbler/cobbler/issues/1530">https://github.com/cobbler/cobbler/issues/1530</a></p>

<h3>18. Manually Install Mate Desktop</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo "debconf debconf/frontend select noninteractive" | sudo debconf-set-selections
</span><span class='line'>apt-get --allow-unauthenticated update -y
</span><span class='line'>apt-get --allow-unauthenticated upgrade -y
</span><span class='line'>apt-get --allow-unauthenticated install -y build-essential
</span><span class='line'>apt-get --allow-unauthenticated install -y ubuntu-mate-desktop
</span><span class='line'>apt-get --allow-unauthenticated install -y vim
</span><span class='line'>apt-get --allow-unauthenticated install -y chromium-browser
</span><span class='line'>apt-get --allow-unauthenticated install -y meld vim-gtk
</span><span class='line'>apt-get --allow-unauthenticated install -y evince
</span><span class='line'>sudo apt-get --allow-unauthenticated install -y language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base
</span><span class='line'>sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
</span><span class='line'>sudo localectl set-locale LANG=zh_CN.UTF-8
</span><span class='line'># TW/HK language support
</span><span class='line'>sudo apt-get --allow-unauthenticated install -y language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base
</span><span class='line'>sudo apt-get --allow-unauthenticated install -y `check-language-support -l zh`
</span><span class='line'>apt-get --allow-unauthenticated install -y fcitx
</span><span class='line'>apt-get --allow-unauthenticated install -y fcitx-table-wubi fcitx-table-wubi-large
</span><span class='line'>apt-get --allow-unauthenticated install -y fcitx-googlepinyin
</span><span class='line'>apt-get --allow-unauthenticated install -y gimp
</span><span class='line'>apt-get --allow-unauthenticated install -y ibus-pinyin 
</span><span class='line'>apt-get --allow-unauthenticated install -y thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca 
</span><span class='line'>apt-get --allow-unauthenticated install -y zsh
</span><span class='line'>apt-get --allow-unauthenticated install -y fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy
</span><span class='line'>apt-get --allow-unauthenticated install -y eclipse
</span><span class='line'>apt-get --allow-unauthenticated install -y gpicview
</span><span class='line'>apt-get --allow-unauthenticated install -y scrot
</span><span class='line'>apt-get --allow-unauthenticated install -y byobu
</span><span class='line'>apt-get --allow-unauthenticated install -y subversion git
</span><span class='line'>apt-get --allow-unauthenticated install -y kdiff3
</span><span class='line'>apt-get --allow-unauthenticated install -y docker</span></code></pre></td></tr></table></div></figure>


<p>Final Version should be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo "debconf debconf/frontend select noninteractive" | sudo debconf-set-selections
</span><span class='line'>unset DEBIAN_HAS_FRONTEND DEBIAN_FRONTEND DEBCONF_REDIR DEBCONF_OLD_FD_BASE
</span><span class='line'>export DEBIAN_FRONTEND=noninteractive
</span><span class='line'>apt-get update --assume-yes
</span><span class='line'>apt-get dist-upgrade --assume-yes
</span><span class='line'>apt-get install --assume-yes vim build-essential ubuntu-mate-desktop chromium-browser meld vim-gtk evince language-pack-zh-hans language-pack-zh-hans-base language-pack-gnome-zh-hans language-pack-gnome-zh-hans-base language-pack-zh-hant language-pack-zh-hant-base language-pack-gnome-zh-hant language-pack-gnome-zh-hant-base fcitx fcitx-table-wubi fcitx-table-wubi-large fcitx-googlepinyin gimp ibus-pinyin thunderbird-locale-en-us mythes-en-au hunspell-en-gb thunderbird-locale-en-gb fonts-arphic-ukai wbritish fcitx-sunpinyin openoffice.org-hyphenation language-pack-gnome-en hunspell-en-za fcitx-chewing fcitx-table-cangjie gimp-help-en language-pack-en mythes-en-us thunderbird-locale-en fcitx-module-cloudpinyin libreoffice-help-en-us firefox-locale-en libreoffice-help-en-gb fonts-arphic-uming hyphen-en-gb libreoffice-l10n-en-za fcitx-ui-qimpanel hunspell-en-au libreoffice-l10n-en-gb hyphen-en-us hunspell-en-ca zsh fonts-wqy-zenhei fonts-wqy-microhei ttf-wqy-microhei  ttf-wqy-zenhei  xfonts-wqy eclipse gpicview scrot byobu subversion git kdiff3 docker
</span><span class='line'>apt-get install --assume-yes  `check-language-support -l zh`
</span></code></pre></td></tr></table></div></figure>


<h3>19. Use rync for resume tranferring</h3>

<p>Command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rsync -P -e ssh remoteuser@remotehost:/remote/path /local/path</span></code></pre></td></tr></table></div></figure>


<h3>20. RackHD Howto</h3>

<p><a href="http://dojoblog.emc.com/rackhd-cpi/setting-up-rackhd/">http://dojoblog.emc.com/rackhd-cpi/setting-up-rackhd/</a></p>

<h3>21. sync repo</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>vagrant@ubuntu-1404:/etc/apt$ cat /var/mirrors/ubuntu/14.04/var/postmirror.sh 
</span><span class='line'>#!/bin/sh -x 
</span><span class='line'># the udebs script gets the actual files we need 
</span><span class='line'>#/mnt/repo/apt-mirror/var/udebs.sh  
</span><span class='line'># A quick apt directory structure primer: 
</span><span class='line'># an apt server (e.g. archive.ubuntu.com) contains repositories (e.g. trusty-backports), 
</span><span class='line'># which contain archives (e.g. multiverse), which contain directories 
</span><span class='line'># a complete example - http://archive.ubuntu.com/ubuntu/dists/trusty-backports/multiverse/debian-installer/  
</span><span class='line'># With this in mind, we create bash 'arrays' of the structure: 
</span><span class='line'># server we're syncing against 
</span><span class='line'>#MIRROR="cn.archive.ubuntu.com" 
</span><span class='line'>MIRROR="archive.ubuntu.com" 
</span><span class='line'># repositories we're mirroring 
</span><span class='line'>#REPOS="trusty trusty-updates trusty-security trusty-proposed trusty-backports" 
</span><span class='line'>REPOS="trusty"
</span><span class='line'># archives in repositories 
</span><span class='line'>#ARCHIVES="main multiverse restricted universe" 
</span><span class='line'>ARCHIVES="main"
</span><span class='line'># installer location inside archive 
</span><span class='line'>#DIRECTORIES="debian-installer dist-upgrader-all installer-amd64 installer-i386" 
</span><span class='line'>DIRECTORIES="debian-installer installer-amd64"
</span><span class='line'>#where we're storing it locally 
</span><span class='line'>LOCALDIR="/var/mirrors/ubuntu/14.04/mirror/mirrors.aliyun.com"
</span><span class='line'>#LOCALDIR="/mnt/repo/apt-mirror/mirror/archive.ubuntu.com"  
</span><span class='line'>for REPO in $REPOS; do 
</span><span class='line'>for ARCHIVE in $ARCHIVES; do 
</span><span class='line'>for DIRECTORY in $DIRECTORIES;do 
</span><span class='line'># create directory structure 
</span><span class='line'>if [ ! -e "$LOCALDIR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY" ]; then
</span><span class='line'>mkdir -p "$LOCALDIR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY"
</span><span class='line'>fi
</span><span class='line'># do the sync 
</span><span class='line'>rsync --recursive --times --links --hard-links --delete --delete-after \
</span><span class='line'>rsync://$MIRROR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY/ $LOCALDIR/ubuntu/dists/$REPO/$ARCHIVE/$DIRECTORY
</span><span class='line'>done
</span><span class='line'>done
</span><span class='line'>done
</span></code></pre></td></tr></table></div></figure>


<h3>22. Vagrantfile for adding more disks</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>To be done. </span></code></pre></td></tr></table></div></figure>


<h3>23. rvm install issue</h3>

<p>With openssl patched you can install rvm successfully:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget https://github.com/ruby/ruby/commit/801e1fe46d83c856844ba18ae4751478c59af0d1.diff -O openssl.patch
</span><span class='line'>$ rvm install --patch ./openssl.patch 2.2.3</span></code></pre></td></tr></table></div></figure>


<h3>24. performance tool</h3>

<p><a href="http://www.tecmint.com/linux-cpu-load-stress-test-with-stress-ng-tool/2/">http://www.tecmint.com/linux-cpu-load-stress-test-with-stress-ng-tool/2/</a></p>

<h3>25. X11 Forwarding Issue</h3>

<p>Problem:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>X11 forwarding request failed on channel 0</span></code></pre></td></tr></table></div></figure>


<p>Solved via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># pacman -S xorg-xauth
</span><span class='line'># vim /etc/ssh/sshd_config
</span><span class='line'>AddressFamily any
</span><span class='line'>X11Forwarding yes</span></code></pre></td></tr></table></div></figure>


<p>Then restart the sshd daemon, you will get X11 on ssh forwarding enabled.</p>

<p>Add new user <code>clouder</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># useradd -d /home/clouder/ clouder
</span><span class='line'># chown -R clouder:clouder /home/clouder/
</span><span class='line'># usermod -aG kvm clouder
</span><span class='line'># usermod -aG libvirt clouder</span></code></pre></td></tr></table></div></figure>


<p>polkit configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># vim /etc/polkit-1/rules.d/50-libvirt.rules 
</span><span class='line'>/* Allow users in kvm group to manage the libvirt
</span><span class='line'>daemon without authentication */
</span><span class='line'>polkit.addRule(function(action, subject) {
</span><span class='line'>    if (action.id == "org.libvirt.unix.manage" &&
</span><span class='line'>        subject.isInGroup("kvm")) {
</span><span class='line'>            return polkit.Result.YES;
</span><span class='line'>    }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>Install following packages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># pacman -Syu ebtables dnsmasq</span></code></pre></td></tr></table></div></figure>


<p>Open nested kvm.</p>

<h3>26. Hack into system</h3>

<p><a href="http://null-byte.wonderhowto.com/how-to/hack-like-pro-hack-shellshock-vulnerability-0157651/">http://null-byte.wonderhowto.com/how-to/hack-like-pro-hack-shellshock-vulnerability-0157651/</a></p>

<h3>27. Quickly setup graphite and grafana</h3>

<p>On ArchLinux, do following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir -p /root/data/graphite/storage/whisper/
</span><span class='line'>$ sudo docker run -d \
</span><span class='line'>  --name graphite \
</span><span class='line'>  -p 8080:80 \
</span><span class='line'>  -p 2003:2003 \
</span><span class='line'>  -v /local/path/to/.htpasswd:/etc/nginx/.htpasswd \
</span><span class='line'>  -v /root/data/graphite/storage/whisper:/opt/graphite/storage/whisper \
</span><span class='line'>  sitespeedio/graphite</span></code></pre></td></tr></table></div></figure>


<p>Now your graphite runs OK, default username/password is guest/guest.</p>

<p>Continue setup the docker container for grafana:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker run -i -p 3000:3000 grafana/grafana</span></code></pre></td></tr></table></div></figure>


<p>Or, setup our own persistent storage via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir -p /root/data/grafana/
</span><span class='line'>$ chmod 777 -R /root/data/grafana/
</span><span class='line'>$ docker run -d -v /root/data/grafana:/var/lib/grafana --name grafana-storage busybox:latest
</span><span class='line'>$ docker run  -d -p 3000:3000 --name=grafana --volumes-from grafana-storage grafana/grafana
</span><span class='line'>$ docker logs grafana</span></code></pre></td></tr></table></div></figure>


<p>The correct way for running grfafana via following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># docker run -d -p 3000:3000 --name=grafana -v /root/data/grafana:/var/lib/grafana  grafana/grafana</span></code></pre></td></tr></table></div></figure>


<h3>28. docker-enter issue</h3>

<p>If you met <code>importenv: not found</code> issue, do following to let docker-enter running:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># docker pull jpetazzo/nsenter
</span><span class='line'># docker run --rm -v /usr/local/bin:/target jpetazzo/nsenter
</span><span class='line'># docker-enter &lt;container_name&gt;</span></code></pre></td></tr></table></div></figure>


<h3>29. Docker-Collectd</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># docker run -d --net=host --privileged -v /:/hostfs:ro --name=collectd -e HOST_NAME=localhost -e \
</span><span class='line'>GRAPHITE_HOST=192.168.1.79 andreasjansson/collectd-write-graphite</span></code></pre></td></tr></table></div></figure>


<h3>30. For using bridged vagrant-libvirt</h3>

<p>An example Vagrantfile is listed as following , notice it&rsquo;s using ovsbr0.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># -*- mode: ruby -*-
</span><span class='line'># vi: set ft=ruby :
</span><span class='line'>
</span><span class='line'>############### Vagrant Configuration Here #############
</span><span class='line'>Vagrant.configure(2) do |config|
</span><span class='line'>
</span><span class='line'>  # vagrant issues #1673..fixes hang with configure_networks
</span><span class='line'>  config.ssh.shell = "bash -c 'BASH_ENV=/etc/profile exec bash'"
</span><span class='line'>  config.ssh.username = 'vagrant'
</span><span class='line'>  config.ssh.password = 'vagrant'
</span><span class='line'>  config.ssh.insert_key = 'true'
</span><span class='line'>  config.vm.provider :libvirt do |domain|
</span><span class='line'>    domain.nic_model_type = 'e1000'
</span><span class='line'>    domain.memory = 384
</span><span class='line'>    domain.nested = true
</span><span class='line'>    domain.cpu_mode = 'host-passthrough'
</span><span class='line'>  end
</span><span class='line'>
</span><span class='line'>  # bridge node. 
</span><span class='line'>  # Add one networking, modify hostname, define memory, CPU cores.
</span><span class='line'>  config.vm.define :bridge do |bridge|
</span><span class='line'>    bridge.vm.box = "csmgmtv4"
</span><span class='line'>    bridge.vm.hostname = "bridgenode"
</span><span class='line'>    bridge.vm.network :public_network, 
</span><span class='line'>  :dev =&gt; "ovsbr0",
</span><span class='line'>  :mode =&gt; "bridge",
</span><span class='line'>  :type =&gt; "bridge",
</span><span class='line'>  :ip =&gt; "192.168.178.2",
</span><span class='line'>  :ovs =&gt; "true"
</span><span class='line'>    bridge.vm.provider :libvirt do |domain|
</span><span class='line'>      domain.storage :file, :size =&gt; '100G'
</span><span class='line'>      domain.memory = 1024
</span><span class='line'>      domain.cpus = 1
</span><span class='line'>      domain.nested = true
</span><span class='line'>      domain.disk_bus = 'virtio'
</span><span class='line'>      domain.nic_model_type = 'virtio'
</span><span class='line'>      domain.volume_cache = 'writeback'
</span><span class='line'>    end
</span><span class='line'>  end
</span><span class='line'>end
</span></code></pre></td></tr></table></div></figure>


<h3>31. Using VPN in CloudStack</h3>

<p><a href="https://portal.redbridge.se/faq/getting-started/accessing-your-instance-from-the-outside/">https://portal.redbridge.se/faq/getting-started/accessing-your-instance-from-the-outside/</a></p>

<p><a href="https://blog.remibergsma.com/2012/11/18/securely-connect-an-advanced-private-cloudstack-network-by-using-a-vlan-aware-switch-and-a-basic-vpn-device/">https://blog.remibergsma.com/2012/11/18/securely-connect-an-advanced-private-cloudstack-network-by-using-a-vlan-aware-switch-and-a-basic-vpn-device/</a></p>

<p><a href="http://www.furorteutonicus.eu/2013/08/04/enabling-host-guest-networking-with-kvm-macvlan-and-macvtap/">http://www.furorteutonicus.eu/2013/08/04/enabling-host-guest-networking-with-kvm-macvlan-and-macvtap/</a></p>

<h3>32. python issue(easy_install)</h3>

<p>Solved via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget https://bootstrap.pypa.io/ez_setup.py -O - | python</span></code></pre></td></tr></table></div></figure>


<h3>33. VPN Over ssh</h3>

<p>Established via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pppd updetach noauth silent nodeflate pty "/usr/bin/ssh root@192.168.1.79 \ 
</span><span class='line'>/usr/bin/pppd nodetach notty noauth" ipparam vpn 10.0.8.1:10.0.8.2</span></code></pre></td></tr></table></div></figure>


<h3>34. X Windows for normal user</h3>

<p>X Window for normal user</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>âžœ  ~ chmod u+s /usr/bin/Xorg </span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/05/04/working-tips-on-ansible-cobbler/">Working Tips on Ansible-cobbler</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-05-04T15:36:55+08:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>3:36 pm</span></time>
        
         | <a href="/blog/2016/05/04/working-tips-on-ansible-cobbler/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Source</h3>

<p>The source are downloaded from:  <br/>
<a href="https://github.com/signed8bit/ansible-cobbler">https://github.com/signed8bit/ansible-cobbler</a></p>

<p>Git clone it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone https://github.com/signed8bit/ansible-cobbler.git</span></code></pre></td></tr></table></div></figure>


<h3>Test</h3>

<p>The test will be done via <code>vagrant up</code>, while we met the problem: the cobbler version
in ansible playbooks are too old, thus the command <code>cobbler get-loaders</code> won&rsquo;t acts
well. we have to changing to the newest cobbler version which is available in</p>

<p><a href="http://cobbler.github.io/">http://cobbler.github.io/</a></p>

<h3>Manually Steps(Ubuntu)</h3>

<p>Install the newest cobbler via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget -qO - http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/xUbuntu_14.04/Release.key | sudo apt-key add -
</span><span class='line'>$ sudo add-apt-repository "deb http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/xUbuntu_14.04/ ./"
</span><span class='line'>$ sudo apt-get install -y cobbler 
</span><span class='line'>$ cobbler --version
</span><span class='line'>Cobbler 2.6.11
</span><span class='line'>  source: ?, ?
</span><span class='line'>  build time: Sat Jan 23 14:13:42 2016</span></code></pre></td></tr></table></div></figure>


<p>Change Password of the <code>cobbler</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Change the password for the 'cobbler' username:
</span><span class='line'>htdigest /etc/cobbler/users.digest "Cobbler" cobbler</span></code></pre></td></tr></table></div></figure>


<p>visit the url of <code>http://xxx.xxx.xxx.xx/cobbler_web</code> and you could access the management interface of cobbler.</p>

<h3>Import CentOS7.2</h3>

<p>Import the iso via following command</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo mount -t iso9660 -o loop ./CentOS-7-x86_64-Everything-1511.iso /mnt1
</span><span class='line'>$ sudo cobbler import --name=CentOS-7.2 --arch=x86_64 --path=/mnt1</span></code></pre></td></tr></table></div></figure>


<p>Examine the imported iso:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@cobbler-ubuntu:~# cobbler profile list
</span><span class='line'>   CentOS-7.2-x86_64
</span><span class='line'>root@cobbler-ubuntu:~# cobbler distro list
</span><span class='line'>   CentOS-7.2-x86_64</span></code></pre></td></tr></table></div></figure>


<p>Change the default password of root:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># openssl passwd -1
</span><span class='line'># vim /etc/cobbler/settings 
</span><span class='line'>- default_password_crypted: "$1$mF86/UHC$WvcIcX2t6crBz2onWxyac."
</span><span class='line'>+ default_password_crypted: "$awegwaegoguoweuouoeh/"
</span><span class='line'># cobbler sync
</span><span class='line'># service cobbler restart
</span><span class='line'># service cobblerd restart
</span></code></pre></td></tr></table></div></figure>


<h3>Todo</h3>

<p>How to automatically install the mate desktop via kickstart?</p>

<p>First find out all of the pkgs in group, then add them into the kickstart file?</p>

<h3>For Making Mate</h3>

<p>Steps are listed as following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># curl http://mirrors.aliyun.com/repo/epel-7.repo&gt;/etc/yum.repos.d/epel-7.repo
</span><span class='line'># curl http://mirrors.aliyun.com/repo/Centos-7.repo&gt;CentOS-Base.repo
</span><span class='line'># yum groupinstall "X Window system"
</span><span class='line'># yum groupinstall "MATE Desktop"</span></code></pre></td></tr></table></div></figure>


<p>Remain the yum cache:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@localhost ~]# cat /etc/yum.conf 
</span><span class='line'>[main]
</span><span class='line'>#cachedir=/var/cache/yum/$basearch/$releasever
</span><span class='line'>cachedir=/root/cache/$basearch/$releasever
</span><span class='line'>keepcache=1</span></code></pre></td></tr></table></div></figure>


<p>For setting mate as the default desktop envs:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># systemctl isolate graphical.target
</span><span class='line'># systemctl set-default graphical.target</span></code></pre></td></tr></table></div></figure>


<h3>Repo In Cobbler</h3>

<p>We could setup the cobbler&rsquo;s repository via following steps:</p>

<p><img src="/images/2016_05_05_22_48_11_536x324.jpg" alt="/images/2016_05_05_22_48_11_536x324.jpg" /></p>

<p>The configuration of this repo:</p>

<p><img src="/images/2016_05_05_22_48_58_718x444.jpg" alt="/images/2016_05_05_22_48_58_718x444.jpg" /></p>

<p>Now you repo&rsquo;s configuration file should be like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@cobbler-ubuntu:/var/lib/cobbler/snippets# cat /srv/www/cobbler/repo_mirror/centos7_mate/config.repo 
</span><span class='line'>[centos7_mate]
</span><span class='line'>name=centos7_mate
</span><span class='line'>baseurl=http://${http_server}/cobbler/repo_mirror/centos7_mate
</span><span class='line'>enabled=1
</span><span class='line'>priority=99
</span><span class='line'>gpgcheck=0</span></code></pre></td></tr></table></div></figure>


<p>Copy the rpms into <code>/srv/www/cobbler/repo_mirror/centos7_mate/</code>, and then <code>createrepo</code> for generating the package informations.</p>

<p>Now edit the existing profile&rsquo;s repo configurations:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cobbler profile list
</span><span class='line'>   CentOS-7.2-x86_64
</span><span class='line'># cobbler profile edit --name=CentOS-7.2-x86_64 --repo='centos7_mate'</span></code></pre></td></tr></table></div></figure>


<p>Examine it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cobbler repo report --name=centos7_mate
</span><span class='line'>Name                           : centos7_mate
</span><span class='line'>Apt Components (apt only)      : []
</span><span class='line'>Apt Dist Names (apt only)      : []
</span><span class='line'>Arch                           : x86_64
</span><span class='line'>Breed                          : yum
</span><span class='line'>Comment                        : This Repo is for installing MATE Desktop
</span><span class='line'>Createrepo Flags               : &lt;&lt;inherit&gt;&gt;
</span><span class='line'>Environment Variables          : {}
</span><span class='line'>Keep Updated                   : False
</span><span class='line'>Mirror                         : 
</span><span class='line'>Mirror locally                 : True
</span><span class='line'>Owners                         : ['admin']
</span><span class='line'>Priority                       : 99
</span><span class='line'>External proxy URL             : 
</span><span class='line'>RPM List                       : []
</span><span class='line'>Yum Options                    : {}</span></code></pre></td></tr></table></div></figure>


<h3>Using the repo in kickstart</h3>

<p>First define the snippet:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@cobbler-ubuntu:/var/lib/cobbler/snippets# pwd
</span><span class='line'>/var/lib/cobbler/snippets
</span><span class='line'>root@cobbler-ubuntu:/var/lib/cobbler/snippets# cat mate
</span><span class='line'># Install mate
</span><span class='line'>mkdir -p /etc/yum.repos.d/back
</span><span class='line'>mv /etc/yum.repos.d/CentOS* /etc/yum.repos.d/back/
</span><span class='line'>yum install -y abattis-cantarell-fonts abrt abrt-addon-ccpp abrt-addon-kerneloops abrt-addon-pstoreoops abrt-addon-python abrt-addon-vmcore abrt-addon-xorg abrt-dbus abrt-desktop abrt-gui abrt-gui-libs abrt-java-connector abrt-libs abrt-python abrt-retrace-client accountsservice adwaita-cursor-theme adwaita-gtk2-theme adwaita-icon-theme alsa-plugins-pulseaudio alsa-utils atk atkmm atril atril-caja atril-libs at-spi2-atk at-spi2-core audit-libs-python augeas-libs avahi-autoipd avahi-glib avahi-libs bind-libs-lite bind-license brasero brasero-libs bzip2 ca-certificates cairo cairo-gobject cairomm caja caja-extensions caja-extensions-common caja-image-converter caja-open-terminal caja-schemas caja-sendto cdparanoia cdparanoia-libs cdrdao centos-indexhtml check checkpolicy cjkuni-uming-fonts clutter clutter-gst2 clutter-gtk cogl colord-libs compat-libcogl12 compat-libcogl-pango12 compat-libcolord1 coreutils cpp crda cronie cronie-anacron cryptsetup cups-libs cyrus-sasl-lib dbus-x11 dconf dconf-editor dejavu-fonts-common dejavu-sans-fonts dejavu-sans-mono-fonts dejavu-serif-fonts desktop-file-utils device-mapper device-mapper-event device-mapper-event-libs device-mapper-libs djvulibre-libs dleyna-connector-dbus dleyna-core dleyna-server dosfstools dracut dracut-config-rescue dracut-network dvd+rw-tools elfutils emacs-filesystem enchant engrampa eom exempi fftw-libs-double filezilla firefox firewall-config flac-libs fontconfig fontpackages-filesystem fortune-mod fros fuse fuse-libs gamin GConf2 gcr gd gdb gdisk gdk-pixbuf2 genisoimage geoclue2 ghostscript ghostscript-fonts giflib glibc glibc-common glibmm24 glx-utils gmp gnome-abrt gnome-desktop3 gnome-icon-theme gnome-icon-theme-extras gnome-icon-theme-legacy gnome-keyring gnome-keyring-pam gnome-online-accounts gnome-python2 gnome-python2-canvas gnome-themes-standard gnote gnu-free-fonts-common gnu-free-mono-fonts gnu-free-sans-fonts gnu-free-serif-fonts gnutls gom google-crosextra-caladea-fonts google-crosextra-carlito-fonts gparted gpm-libs graphite2 grilo grilo-plugins grub2 grub2-tools gsm gssdp gstreamer gstreamer1 gstreamer1-plugins-bad-free gstreamer1-plugins-base gstreamer1-plugins-good gstreamer-plugins-bad-free gstreamer-plugins-base gstreamer-plugins-good gstreamer-tools gtk2 gtk2-engines gtk2-immodule-xim gtk3 gtk3-immodule-xim gtkmm24 gtkmm30 gtk-murrine-engine gtksourceview2 gtkspell3 gucharmap gupnp gupnp-av gupnp-dlna gvfs gvfs-afc gvfs-archive gvfs-fuse gvfs-gphoto2 gvfs-mtp gvfs-smb harfbuzz harfbuzz-icu hicolor-icon-theme hunspell hunspell-en-US ibus ibus-chewing ibus-gtk2 ibus-gtk3 ibus-hangul ibus-kkc ibus-libpinyin ibus-libs ibus-m17n ibus-rawcode ibus-sayura ibus-setup ibus-table ibus-table-chinese icedax ilmbase ImageMagick initscripts iso-codes iw jasper-libs jbigkit-libs jomolhari-fonts json-glib kernel kernel-tools kernel-tools-libs kexec-tools khmeros-base-fonts khmeros-fonts-common kpartx krb5-libs lcms2 libao libarchive libart_lgpl libasyncns libatasmart libavc1394 libblkid libbluray libburn libcanberra libcanberra-gtk2 libcanberra-gtk3 libcdio libcdio-paranoia libcgroup libchewing libdmapsharing libdmx libdnet libdv libdvdnav libdvdread libepoxy liberation-fonts-common liberation-mono-fonts liberation-sans-fonts liberation-serif-fonts libevdev libevent libexif libfontenc libgdata libgee06 libglade2 libgnomecanvas libgnome-keyring libgphoto2 libgpod libgsf libgtop2 libgudev1 libgusb libgxps libhangul libICE libicu libiec61883 libieee1284 libimobiledevice libiptcdata libisofs libjpeg-turbo libkkc libkkc-common libkkc-data libldb libmatekbd libmatemixer libmateweather libmateweather-data libmbim libmediaart libmount libmpc libmpcdec libmspack libmtp libmx libnatpmp libnl libnm-gtk libnotify libntlm liboauth libofa libogg libosinfo libpeas libpinyin libpinyin-data libplist libpng libqmi libraw1394 libreport libreport-centos libreport-filesystem libreport-gtk libreport-plugin-mantisbt libreport-plugin-reportuploader libreport-plugin-rhtsupport libreport-plugin-ureport libreport-python libreport-web librsvg2 libsamplerate libsecret libsemanage-python libsexy libshout libsigc++20 libSM libsmbclient libsndfile libspectre libsrtp libssh2 libtalloc libtar libtdb libteam libtevent libthai libtheora libtiff libtomcrypt libtommath libtool-ltdl libudisks2 libusal libusb libusbx libuser-python libuuid libv4l libvisual libvorbis libvpx libwbclient libwebp libwmf-lite libwnck libwnck3 libwvstreams libX11 libX11-common libXau libxcb libXcomposite libXcursor libXdamage libXdmcp libXevie libXext libXfixes libXfont libXft libXi libXinerama libxkbfile libxklavier libxml2 libxml2-python libXmu libXpm libXrandr libXrender libXres libXScrnSaver libxshmfence libxslt libXt libXtst libXv libXvMC libXxf86dga libXxf86misc libXxf86vm lightdm lightdm-gobject lightdm-gtk lightdm-gtk-common lklug-fonts lockdev logrotate lohit-assamese-fonts lohit-bengali-fonts lohit-devanagari-fonts lohit-gujarati-fonts lohit-kannada-fonts lohit-malayalam-fonts lohit-marathi-fonts lohit-nepali-fonts lohit-oriya-fonts lohit-punjabi-fonts lohit-tamil-fonts lohit-telugu-fonts lrzsz lvm2 lvm2-libs lz4 m17n-contrib m17n-db m17n-lib madan-fonts marco mariadb-libs marisa mate-applets mate-backgrounds mate-calc mate-control-center mate-control-center-filesystem mate-desktop mate-desktop-libs mate-dictionary mate-disk-usage-analyzer mate-icon-theme mate-media mate-menus mate-menus-libs mate-menus-preferences-category-menu mate-netspeed mate-notification-daemon mate-panel mate-panel-libs mate-polkit mate-power-manager mate-screensaver mate-screenshot mate-search-tool mate-session-manager mate-settings-daemon mate-system-log mate-system-monitor mate-terminal mate-themes mate-user-guide mate-utils-common mathjax mathjax-ams-fonts mathjax-caligraphic-fonts mathjax-fraktur-fonts mathjax-main-fonts mathjax-math-fonts mathjax-sansserif-fonts mathjax-script-fonts mathjax-size1-fonts mathjax-size2-fonts mathjax-size3-fonts mathjax-size4-fonts mathjax-typewriter-fonts mathjax-winchrome-fonts mathjax-winie6-fonts mdadm media-player-info mesa-dri-drivers mesa-filesystem mesa-libEGL mesa-libgbm mesa-libGL mesa-libglapi mesa-libGLU mesa-libxatracker mesa-private-llvm mobile-broadband-provider-info ModemManager ModemManager-glib mozilla-filesystem mozo mpfr mtdev net-tools NetworkManager NetworkManager-adsl network-manager-applet NetworkManager-glib NetworkManager-libnm NetworkManager-openconnect NetworkManager-openvpn NetworkManager-pptp NetworkManager-team NetworkManager-tui NetworkManager-vpnc NetworkManager-vpnc-gnome nhn-nanum-fonts-common nhn-nanum-gothic-fonts nm-connection-editor nspr nss nss-softokn nss-softokn-freebl nss-sysinit nss-tools nss-util numactl-libs oddjob oddjob-mkhomedir opencc openconnect OpenEXR-libs openjpeg-libs openldap open-sans-fonts openssh openssh-clients openssh-server openssl openssl-libs open-vm-tools open-vm-tools-desktop openvpn opus orc overpass-fonts PackageKit-glib PackageKit-gstreamer-plugin paktype-naskh-basic-fonts pango pangomm paratype-pt-sans-fonts pcsc-lite-libs perl perl-Carp perl-constant perl-Encode perl-Exporter perl-File-Path perl-File-Temp perl-Filter perl-Getopt-Long perl-HTTP-Tiny perl-libs perl-macros perl-parent perl-PathTools perl-Pod-Escapes perl-podlators perl-Pod-Perldoc perl-Pod-Simple perl-Pod-Usage perl-Scalar-List-Utils perl-Socket perl-Storable perl-Text-ParseWords perl-threads perl-threads-shared perl-Time-HiRes perl-Time-Local pexpect pinentry-gtk pixman pkcs11-helper pluma pluma-data plymouth-graphics-libs plymouth-plugin-label plymouth-plugin-two-step plymouth-system-theme plymouth-theme-charge policycoreutils-python polkit polkit-gnome poppler poppler-data poppler-glib pptp procps-ng psmisc pulseaudio pulseaudio-libs pulseaudio-libs-glib2 pulseaudio-module-x11 pulseaudio-utils pycairo pygobject2 pygobject3 pygtk2 pygtk2-libglade pygtksourceview pyOpenSSL pytalloc python-augeas python-backports python-backports-ssl_match_hostname python-beaker python-chardet python-cups python-dmidecode python-inotify python-IPy python-kitchen python-mako python-markupsafe python-paste python-perf python-pwquality python-pyudev python-setuptools python-six python-tempita pyxdg qemu-guest-agent rarian rarian-compat rdma realmd recode redhat-menus rest rhythmbox rtkit samba-client-libs samba-common samba-common-libs samba-common-tools samba-libs sane-backends-libs satyr SDL seahorse selinux-policy selinux-policy-targeted setools-libs setroubleshoot setroubleshoot-plugins setroubleshoot-server sg3_utils-libs sil-abyssinica-fonts sil-nuosu-fonts sil-padauk-fonts simple-scan skkdic smc-fonts-common smc-meera-fonts sos sound-theme-freedesktop soundtouch speex spice-vdagent startup-notification stix-fonts stoken-libs sudo system-config-date system-config-date-docs system-config-language system-config-printer system-config-printer-libs system-config-users system-config-users-docs systemd systemd-libs systemd-python systemd-sysv taglib teamd telepathy-glib texlive-kpathsea-lib thai-scalable-fonts-common thai-scalable-waree-fonts totem totem-pl-parser tracker transmission-common transmission-gtk tuned tzdata ucs-miscfixed-fonts udisks2 unique upower urw-fonts usb_modeswitch usb_modeswitch-data usbmuxd usermode usermode-gtk util-linux vim-common vim-enhanced vim-filesystem vlgothic-fonts vorbis-tools vpnc vpnc-script vte wavpack web-assets-filesystem webkitgtk webkitgtk3 webrtc-audio-processing wireless-tools wodim wqy-microhei-fonts wqy-zenhei-fonts wvdial wxBase wxGTK xcb-util xchat xdg-user-dirs xdg-user-dirs-gtk xdg-utils xkeyboard-config xml-common xmlrpc-c xmlrpc-c-client xorg-x11-drivers xorg-x11-drv-ati xorg-x11-drv-dummy xorg-x11-drv-evdev xorg-x11-drv-fbdev xorg-x11-drv-intel xorg-x11-drv-nouveau xorg-x11-drv-qxl xorg-x11-drv-synaptics xorg-x11-drv-v4l xorg-x11-drv-vesa xorg-x11-drv-vmmouse xorg-x11-drv-vmware xorg-x11-drv-void xorg-x11-drv-wacom xorg-x11-font-utils xorg-x11-server-common xorg-x11-server-utils xorg-x11-server-Xorg xorg-x11-utils xorg-x11-xauth xorg-x11-xinit xorg-x11-xkb-utils xvattr yelp yelp-libs yelp-xsl yumex zenity
</span><span class='line'>systemctl isolate graphical.target
</span><span class='line'>systemctl set-default graphical.target</span></code></pre></td></tr></table></div></figure>


<p>Now involved this snippet in <code>ks_end</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># pwd
</span><span class='line'>/var/lib/cobbler/kickstarts
</span><span class='line'># vim sample_end.ks
</span><span class='line'>    # Insert a key
</span><span class='line'>    $SNIPPET('publickey')
</span><span class='line'>    # Instal mate
</span><span class='line'>    $SNIPPET('mate')
</span><span class='line'>    # End final steps
</span><span class='line'>    %end</span></code></pre></td></tr></table></div></figure>


<p>Now run <code>cobbler sync</code> for syncing your configurations.</p>

<p>Next time you bootstrap a machine, it will automatically runs into MATE desktop.</p>

<p><img src="/images/2016_05_05_22_56_57_672x489.jpg" alt="/images/2016_05_05_22_56_57_672x489.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/24/tipsonosexperiment/">TipsOnOSExperiment</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-24T17:32:12+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>5:32 pm</span></time>
        
         | <a href="/blog/2016/04/24/tipsonosexperiment/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ä¸ºäº†åœ¨å®¶é‡ŒéªŒè¯ä¸€ä¸‹DevStackçš„ç½‘ç»œé…ç½®ï¼Œç»„å»ºäº†ä¸€ä¸ªç½‘ç»œï¼Œæ¶‰åŠåˆ°çš„ç‚¹æ¯”è¾ƒå¤šï¼Œä»¥ä¸‹æ˜¯
å…·ä½“è®°å½•ã€‚</p>

<h3>äº¤æ¢æœºé…ç½®</h3>

<p>å‰æ®µæ—¶é—´ä»Žç¾Žå›½äºšé©¬é€Šä¹°å›žæ¥ä¸€ä¸ªTP-LINKçš„åƒå…†äº¤æ¢æœºä¸€ç›´æ²¡ç”¨èµ·æ¥ï¼Œåž‹å·æ˜¯TL-SG108E
ï¼Œ8å£å¯ç½‘ç®¡äº¤æ¢æœºã€‚ä½†å‰é¢æœ‰å†™è¿‡æ–‡ç« å¯ä»¥ç”¨æ¥å‚è€ƒ:</p>

<p><a href="http://purplepalmdash.github.io/blog/2015/12/12/ba-wan-tl-sg108e/">http://purplepalmdash.github.io/blog/2015/12/12/ba-wan-tl-sg108e/</a></p>

<p>ä½†è¿™ç¯‡æ–‡ç« é‡Œè®²çš„ä¸»è¦è¿˜æ˜¯ovsåŽè™šæ‹Ÿæœºçš„vlanï¼Œå’Œæœ€è¿‘è¦åšçš„DevStackçš„FloatIPé…ç½®ç¨
å¾®æœ‰ç‚¹å·®å¼‚ã€‚</p>

<h3>ç½‘ç»œè§„åˆ’</h3>

<p>å®¶é‡Œå·²æœ‰ç½‘ç»œ192.168.177.0/24, è¿™ä¸ªç½‘ç»œæ˜¯å¯ä»¥è®¿é—®Internetçš„ã€‚æ‰€ä»¥DevStackæœºå™¨ä¸Š
çš„eth0å°†è¿žæŽ¥åˆ°è¿™ä¸ªç½‘æ®µï¼Œå¹¶åœ¨å…¶ä¸Šåˆ†é…floating IP.</p>

<p>å¦å¤–æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªVLANéš”ç¦»çš„private networkï¼Œç”¨äºŽç»™DevStacké‡Œçš„è™šæ‹Ÿæœºé»˜è®¤å¯
åŠ¨åŽåˆ†é…IPåœ°å€ã€‚å°†DevStackæœºå™¨ä¸Šçš„eth1è¿žæŽ¥åˆ°æ­¤ç½‘ç»œã€‚</p>

<h3>é…ç½®äº¤æ¢æœº</h3>

<p>TP-LINKçš„DEB-100ç½‘å¡æ˜¯æ¯”è¾ƒçš®å®žï¼Œå¥ˆä½•win10é©±åŠ¨éœ€è¦æ‰¾ï¼Œéšä¾¿æ‰¾äº†ä¸ªæ·˜å®9.9åŒ…é‚®çš„
USBè½¬10å…†ç½‘å¡è¿žä¸ŠSurfaceProï¼Œå¼€å§‹é…ç½®äº¤æ¢æœºã€‚</p>

<p>æ­¥éª¤:  <br/>
æ‰“å¼€æ¡Œé¢çš„<code>Easy Smart Configuration Utility</code>ï¼Œå¼€å§‹è‡ªåŠ¨å‘çŽ°å±€åŸŸç½‘å†…çš„äº¤æ¢æœºï¼Œå¦‚
ä¸‹å›¾:</p>

<p><img src="/images/2016_04_24_17_58_49.jpg" alt="/images/2016_04_24_17_58_49.jpg" /></p>

<p>éœ€è¦é‡æ–°é…ç½®ä¸‹USBæœ‰çº¿ç½‘å¡çš„IPåœ°å€æ‰èƒ½è¿žæŽ¥ä¸Šäº¤æ¢æœº:</p>

<p><img src="/images/2016_04_24_18_02_45.jpg" alt="/images/2016_04_24_18_02_45.jpg" /></p>

<p>åŒå‡»å‘çŽ°çš„äº¤æ¢æœºï¼Œç”¨<code>admin/admin</code>ç™»å½•åŽçš„ç•Œé¢å¦‚ä¸‹:</p>

<p><img src="/iamges/2016_04_24_18_08_04.jpg" alt="/images/2016_04_24_18_08_04.jpg" /></p>

<p>ä»¥å‰æˆ‘æ›¾ç»æŠŠè¿™ä¸ªäº¤æ¢æœºé…ç½®æˆ802.1Q VLAN, è¿™æ¬¡åŸºäºŽç«¯å£æ¥éš”ç¦»ï¼Œæ‰€ä»¥è¦é…ç½®æˆ<code>Port
Based VLAN</code>, é…ç½®å®Œæ¯•åŽçš„ç”»é¢å¦‚ä¸‹:</p>

<p><img src="/images/2016_04_24_18_20_36.jpg" alt="/images/2016_04_24_18_20_36.jpg" /></p>

<p>è¿™ç§åŸºäºŽç«¯å£VLANçš„éªŒè¯æ–¹æ³•å¾ˆç®€å•ï¼Œå°†ä¸Šç½‘æœºå’Œå®½å¸¦è·¯ç”±å™¨åˆ†åˆ«æ’åœ¨1ï½ž4å’Œ5ï½ž8å£ï¼Œå³
å¯æµ‹è¯•å‡ºVLANè¢«ç«¯å£éš”ç¦»ã€‚ä½†è¿™å¥½åƒä¸æ˜¯DevStackä¸­éœ€è¦è®¾ç½®çš„ã€‚</p>

<p>è¿˜æ˜¯ç»§ç»­é…ç½®802.1Q VLAN. å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœä¹‹å‰é…ç½®ç«¯å£VLANæ—¶å°†SurfaceProçš„è¿ž
æŽ¥å’Œäº¤æ¢æœºç½‘æ®µéš”ç¦»äº†ï¼Œé‚£å¯èƒ½ä¼šè¿žæŽ¥ä¸ä¸Šï¼Œæ¢å›žåŒä¸€VLANå³å¯è¿žæŽ¥ä¸Šã€‚</p>

<p>é…ç½®vlan100å¦‚ä»¥ä¸‹å›¾æ‰€ç¤º:</p>

<p><img src="/images/2016_04_24_19_51_15.jpg" alt="/images/2016_04_24_19_51_15.jpg" /></p>

<h3>æµ‹è¯•VLAN</h3>

<p>å°†ä¸¤å°PCè¿žæŽ¥åœ¨5~8å£ä¸Šï¼ŒVLAN100ã€‚</p>

<p>PC1, ArchLinux, Systemdé…ç½®VLAN:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat enp0s25.100.network
</span><span class='line'>[Match]
</span><span class='line'>Name=enp0s25.100
</span><span class='line'>
</span><span class='line'>[Network]
</span><span class='line'>DNS=192.168.2.1
</span><span class='line'>Address=192.168.2.1/24
</span><span class='line'>$ cat enp0s25.100.netdev 
</span><span class='line'>[NetDev]
</span><span class='line'>Name=enp0s25.100
</span><span class='line'>Kind=vlan
</span><span class='line'>
</span><span class='line'>[VLAN]
</span><span class='line'>Id=100
</span><span class='line'>
</span><span class='line'>[Network]
</span><span class='line'>DNS=192.168.2.1
</span><span class='line'>Address=192.168.2.1/24
</span><span class='line'>Gateway=192.168.2.1
</span><span class='line'>$ pwd
</span><span class='line'>/etc/systemd/network</span></code></pre></td></tr></table></div></figure>


<p>é‡æ–°å¯åŠ¨PC1åŽï¼Œ<code>192.168.2.1</code>å°†æˆä¸ºVLAN100å£çš„åœ°å€ã€‚ä½œä¸º<code>192.168.2.1</code>,æˆ‘ä»¬åœ¨è¿™
ä¸ªç«¯å£ä¸Šå¯åŠ¨dhcpæœåŠ¡åŠè·¯ç”±è½¬å‘ç­‰æœåŠ¡ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S dhcp
</span><span class='line'>$ sudo systemctl enable dhcpd4.service</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>å¹²æŽ‰å†—ä½™çš„é»˜è®¤dhcpd.confæ–‡ä»¶ï¼Œå†™ä¸€ä¸ªæœ€å°çš„é…ç½®æ–‡ä»¶:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/dhcpd.conf.example 
</span><span class='line'>$ sudo vim /etc/dhcpd.conf         
</span><span class='line'>option domain-name-servers 180.76.76.76,223.5.5.5;
</span><span class='line'>option subnet-mask 255.255.255.0;
</span><span class='line'>option routers 192.168.2.1;
</span><span class='line'>subnet 192.168.2.0 netmask 255.255.255.0 {
</span><span class='line'>  range 192.168.2.150 192.168.2.250;
</span><span class='line'>
</span><span class='line'>  host macbookpro{
</span><span class='line'>   hardware ethernet 70:56:81:22:33:44;
</span><span class='line'>   fixed-address 192.168.2.199;
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>å¼€å¯dhcpdæœåŠ¡:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo systemctl start dhcpd4.service</span></code></pre></td></tr></table></div></figure>


<p>PC2, ç”¨openvswitchçš„vlané…ç½®, libvirtçš„XMLé…ç½®å¦‚ä¸‹:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;interface type='bridge'&gt;
</span><span class='line'>  &lt;mac address='52:54:00:fd:03:e9'/&gt;
</span><span class='line'>  &lt;source bridge='ovsbr0'/&gt;
</span><span class='line'>  &lt;vlan trunk='yes'&gt;
</span><span class='line'>    &lt;tag id='100' nativeMode='untagged'/&gt;
</span><span class='line'>  &lt;/vlan&gt;
</span><span class='line'>  &lt;virtualport type='openvswitch'&gt;
</span><span class='line'>    &lt;parameters interfaceid='fb3e7f34-6fcd-41dc-8fed-c3ffe0d54b18'/&gt;
</span><span class='line'>  &lt;/virtualport&gt;</span></code></pre></td></tr></table></div></figure>


<p>æµ‹è¯•ï¼Œå³å¯åŠ¨PC2ä¸Šçš„è™šæ‹Ÿæœºï¼Œè‹¥è™šæ‹Ÿæœºèƒ½èŽ·å¾—IPåœ°å€ï¼Œåˆ™è¯´æ˜ŽVLANé…ç½®æˆåŠŸã€‚</p>

<h3>DevStackç½‘ç»œé…ç½®</h3>

<p>æ“ä½œç³»ç»Ÿä¸ºUbuntu14.04, ç½‘å¡ä¸ºeth0(192.168.177.100)å’Œeth1(vlan 100)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/24/zai-devstackzhong-shi-yong-packer/">åœ¨DevStackä¸­ä½¿ç”¨Packer</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-24T10:16:39+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:16 am</span></time>
        
         | <a href="/blog/2016/04/24/zai-devstackzhong-shi-yong-packer/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>å¯¼å…¥æºé•œåƒ</h3>

<p>æºé•œåƒå¯ä»¥ä»Žubuntu.comä¸‹è½½åˆ°ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å…¥:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget https://cloud-images.ubuntu.com/trusty/current/trusty-server-cloudimg-amd64-disk1.img
</span><span class='line'>$ glance image-create --name ubuntu-trusty --disk-format qcow2 \
</span><span class='line'>--container-format bare --file trusty-server-cloudimg-amd64-disk1.img</span></code></pre></td></tr></table></div></figure>


<h3>openstack.jsonæ–‡ä»¶</h3>

<p>githubä¸Šæœ‰çŽ°æˆçš„ï¼Œå…‹éš†åˆ°æœ¬åœ°:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone https://github.com/Thingee/packer-devstack.git</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/22/rsync-the-vault-dot-centos-dot-com/">Rsync the vault.centos.com</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-22T19:39:58+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>7:39 pm</span></time>
        
         | <a href="/blog/2016/04/22/rsync-the-vault-dot-centos-dot-com/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For I want to do some configuration workings on old distribution of CentOS, I have to
use lots of materials which from vault.centos.com, following are the steps for syncing
them.</p>

<p>First, rsync in <code>vault.centos.com</code> is closed, thus we have to choose
<code>http://archive.kernel.org/centos/</code>.</p>

<h3>Rsync Scripts</h3>

<p>Refers to:   <br/>
<a href="https://www.totalnetsolutions.net/2013/10/02/setting-up-a-corporate-yum-repository-mirror-for-bandwidth-and-staged-update-management/">https://www.totalnetsolutions.net/2013/10/02/setting-up-a-corporate-yum-repository-mirror-for-bandwidth-and-staged-update-management/</a></p>

<h3>Make Repository</h3>

<p><a href="https://wiki.centos.org/HowTos/CreateLocalMirror">https://wiki.centos.org/HowTos/CreateLocalMirror</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/21/switching-to-win10/">Switching to Win10</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-21T10:06:44+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>10:06 am</span></time>
        
         | <a href="/blog/2016/04/21/switching-to-win10/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Background</h3>

<p>Since the monitor in my company are so ba&hellip;&hellip;..d, I have to change my working
environment from PC to SurfacePro, thus I have some tools changes, following are the
records.</p>

<h3>Tool List</h3>

<p>Terminal: XShell4, Make sure you have change the screen-size issue.   <br/>
<a href="purplepalmdash.github.io/blog/2015/11/13/win10-tips-for-using-xshell/">purplepalmdash.github.io/blog/2015/11/13/win10-tips-for-using-xshell/</a></p>

<p>Screen-Shot:  <br/>
I use picPick for replacing the scrot, the scrot is so convenient thus I found many
tools for replacing it.</p>

<p>picPick Configuration: the main purpose is for selecting the rectangle and save it
automatically to the folder with the timestamp.</p>

<p>Auto-Syncing tool:   <br/>
using WinSCP&rsquo;s keep remote the latest status:</p>

<p><img src="/images/2016_04_21_10_39_10.jpg" alt="/images/2016_04_21_10_39_10.jpg" /></p>

<p>OK, Now we could also using the same writing behavior just as under Linux Awesome
Desktop.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/index.html">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/06/29/site-to-site-vpn/">Site-to-site VPN</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/20/da-jian-ji-yu-dockerde-jian-kong-xi-tong/">æ­å»ºåŸºäºŽdockerçš„ç›‘æŽ§ç³»ç»Ÿ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/18/da-jian-wu-pan-centoszhuo-mian-huan-jing/">æ­å»ºæ— ç›˜CentOSæ¡Œé¢çŽ¯å¢ƒ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/07/rackhd-worktips/">RackHD Worktips</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/01/use-rakehd-for-deploying-systems/">Use RackHD for Deploying Systems</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>









<div style="display:none">
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2101056" charset="utf-8"></script>
</div>





</body>
</html>


<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="Following is the configuration of the vlan and whole network: In rc.local, RHEL. 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/23">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/08/configure-network-in-rc-dot-local/">Configure Network in rc.local</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-08T10:23:00+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:23 am</span></time>
        
         | <a href="/blog/2014/08/08/configure-network-in-rc-dot-local/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Following is the configuration of the vlan and whole network: <br/>
In rc.local, RHEL.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/sh
</span><span class='line'>#
</span><span class='line'># This script will be executed *after* all the other init scripts.
</span><span class='line'># You can put your own initialization stuff in here if you don't
</span><span class='line'># want to do the full Sys V style init stuff.
</span><span class='line'>
</span><span class='line'>touch /var/lock/subsys/local
</span><span class='line'>
</span><span class='line'>echo VLAN=yes &gt; /etc/sysconfig/network 
</span><span class='line'>
</span><span class='line'>/sbin/vconfig add eth1 10
</span><span class='line'>/sbin/vconfig add eth1 11
</span><span class='line'>/sbin/vconfig add eth1 12
</span><span class='line'>/sbin/vconfig add eth1 13
</span><span class='line'>/sbin/vconfig add eth1 30
</span><span class='line'>/sbin/vconfig add eth1 40
</span><span class='line'>
</span><span class='line'>/sbin/vconfig add eth1 100
</span><span class='line'>/sbin/vconfig add eth1 110
</span><span class='line'>/sbin/vconfig add eth1 120
</span><span class='line'>/sbin/vconfig add eth1 130
</span><span class='line'>/sbin/vconfig add eth1 200
</span><span class='line'>
</span><span class='line'>/sbin/ifconfig eth1.10 172.10.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.10:11 172.10.11.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.11 172.11.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.12 172.12.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.13 172.13.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.30 172.30.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.30:11 172.30.11.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.40 172.40.1.55 netmask 255.255.0.0 up
</span><span class='line'>
</span><span class='line'>/sbin/ifconfig eth1.100 20.100.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.110 20.110.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.120 20.120.1.55 netmask 255.255.0.0 up
</span><span class='line'>/sbin/ifconfig eth1.130 20.130.1.55 netmask 255.255.0.0 up
</span><span class='line'>
</span><span class='line'>/sbin/ifconfig eth1.10 inet6 add fd00::410:172:10:1:88/64
</span><span class='line'>/sbin/ifconfig eth1.10 inet6 add fd00::410:172:10:11:88/64
</span><span class='line'>/sbin/ifconfig eth1.11 inet6 add fd00::411:172:11:1:88/64
</span><span class='line'>/sbin/ifconfig eth1.12 inet6 add fd00::412:172:12:1:88/64
</span><span class='line'>/sbin/ifconfig eth1.13 inet6 add fd00::413:172:13:1:88/64
</span><span class='line'>/sbin/ifconfig eth1.30 inet6 add fd00::430:172:30:1:88/64
</span><span class='line'>/sbin/ifconfig eth1.30 inet6 add fd00::430:172:30:11:88/64
</span><span class='line'>/sbin/ifconfig eth1.40 inet6 add fd00::440:172:40:1:88/64
</span><span class='line'>
</span><span class='line'>route add -net 224.0.0.0 netmask 224.0.0.0 dev eth1.40
</span><span class='line'>/sbin/route add default gw 10.9.134.1 dev eth1
</span><span class='line'>
</span><span class='line'>echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</span><span class='line'>
</span><span class='line'>echo 1 &gt; /proc/sys/net/ipv6/conf/all/forwarding
</span><span class='line'>echo 1 &gt; /proc/sys/net/ipv6/conf/all/mc_forwarding
</span><span class='line'>
</span><span class='line'>modprobe sctp
</span><span class='line'>
</span><span class='line'>#/etc/init.d/xinetd restart
</span><span class='line'>#/usr/sbin/xinetd -stayalive -pidfile /var/run/xinetd.pid
</span><span class='line'>#echo "nameserver 10.9.133.243" &gt;&gt; /etc/resolv.conf
</span><span class='line'># Activate eth0 again. 
</span><span class='line'>/sbin/ifconfig eth0 1xx.xx.xxx.xxx netmask 255.255.255.0 up
</span><span class='line'>/sbin/route add default gw 1xx.xx.xxx.1 dev eth0
</span></code></pre></td></tr></table></div></figure>


<p>For eth0 will lose configuration, so we add the eth0 again.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/31/writing-style-under-linux/">Writing Style Under Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-31T15:15:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>3:15 pm</span></time>
        
         | <a href="/blog/2014/07/31/writing-style-under-linux/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Writing</h3>

<p>Use <code>rake new_post</code> for generate a new blog.  <br/>
<img src="/images/writing1.jpg" alt="/images/writing1.jpg" /></p>

<p>Use vim for editing the article:  <br/>
<img src="/images/writing2.jpg" alt="/images/writing2.jpg" /></p>

<h3>Building</h3>

<p>Building the blogs:  <br/>
<img src="/images/writing3.jpg" alt="/images/writing3.jpg" /></p>

<p>Now build successful:   <br/>
<img src="/images/writing4.jpg" alt="/images/writing4.jpg" /></p>

<h3>Browsing</h3>

<p>View the result in browser:  <br/>
<img src="/images/writing5.jpg" alt="/images/writing5.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/31/moving-system-on-1t-harddisk/">Moving System on 1T Harddisk</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-31T15:05:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>3:05 pm</span></time>
        
         | <a href="/blog/2014/07/31/moving-system-on-1t-harddisk/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Preparation</h3>

<p>View the newly added harddisk via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ fdisk -l
</span><span class='line'>Disk /dev/sdb: 931.5 GiB, 1000204886016 bytes, 1953525168 sectors
</span><span class='line'>Units: sectors of 1 * 512 = 512 bytes
</span><span class='line'>Sector size (logical/physical): 512 bytes / 4096 bytes
</span><span class='line'>I/O size (minimum/optimal): 4096 bytes / 4096 bytes
</span><span class='line'>[Trusty@/dev/disk/by-uuid]$ ls -l /dev/disk/by-id 
</span><span class='line'>total 0
</span><span class='line'>lrwxrwxrwx 1 root root  9 Jul 31 14:50 ata-WDC_WD10JPVX-00JC3T0_WD-WX31A54D4529 -&gt; ../../sdb
</span></code></pre></td></tr></table></div></figure>


<p>Now we know the id of the harddisk, Create a vmdk file which links to this physical disk.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@/media/x/Moving]$ pwd
</span><span class='line'>/media/x/Moving
</span><span class='line'>[Trusty@/media/x/Moving]$ VBoxManage internalcommands createrawvmdk -filename ./moving.vmdk -rawdisk /dev/disk/by-id/ata-WDC_WD10JPVX-00JC3T0_WD-WX31A54D4529 
</span><span class='line'>RAW host disk access VMDK file ./moving.vmdk created successfully.
</span><span class='line'>$ wget http://mirrors.kernel.org/archlinux/iso/2014.07.03/archlinux-2014.07.03-dual.iso
</span></code></pre></td></tr></table></div></figure>


<p>Now create a new virtual machine in virtualbox. Begin to install.</p>

<h3>Installation</h3>

<p>The detailed steps could be viewed in my previous blogs,  &ldquo;moving-from-working-pc-to-own-usb-disk-based&rdquo;.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -S chromium firefox xorg xorg-xinit awesome xf86-video-intel xf86-video-ati pidgin thunderbird wget libreoffice gnome-terminal tigervnc xfce4  evince gimp smplayer alsa-utils gvim eclipse git subversion wireshark-gtk tcpdump ddd gdb meld qemu virtualbox wqy-bitmapfont wqy-microhei wqy-microhei-lite wqy-zenhei fcitx fcitx-libpinyin rox gpicview conky fcitx-googlepinyin nodejs cronie ntfs-3g liferea
</span><span class='line'>$ pacman -S zsh
</span><span class='line'>$ useradd -m -g root -G audio -s /bin/zsh Trusty
</span><span class='line'>$ pacman -S sudo
</span><span class='line'># Add yaourt, and 
</span><span class='line'>$ pacman -Syu && pacman -S yaourt
</span><span class='line'>$ yaourt sipe webqq
</span></code></pre></td></tr></table></div></figure>


<p>Configure E-mail and Office Communicator:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Communicator:   UCCAPI/15.0.4481.1000 OC/15.0.4481.1000
</span><span class='line'>TLS-DSK.   
</span></code></pre></td></tr></table></div></figure>


<p>Tips for reconfiguring:  <br/>
1. Install fcitx-configtool, then we could configure the fcitx and let it add more input method, or the default one is english.  <br/>
2. Install hdtemp, lm_sensors, which will be used in conkyrc.   <br/>
3. Copy the .config/awesome, and copy the themes to /usr/share/awesome/themes, the directory is named wabbit. This step is required in this time&rsquo;s installation, previous I don&rsquo;t remember this step, perhaps awesome changes.  <br/>
4. Goagent, install python2-pyopenssl. Then goagent could be used.  <br/>
5. mycapscr:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir ~/capscr
</span><span class='line'>$ sudo pacman -S scrot
</span><span class='line'>$ cat /usr/bin/mycapscr
</span></code></pre></td></tr></table></div></figure>


<p>6. Install xampp</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo yaourt xampp, then configure it. 
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>7. Install udiskie for automount.  <br/>
8. Install xlock-more for xlock.  <br/>
9. Flash for chromium: yaourt chromium-pepper-flash. Then restart the chromim for using flash.  <br/>
10. Enable the auto-login for ssh.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat ~/.ssh/id_rsa.pub| ssh Trusty@1xx.xx.xxx.xxx'cat &gt;&gt; /home/Trusty/.ssh/authorized_keys'
</span><span class='line'>$ cat ~/.ssh/id_rsa.pub| ssh root@1xx.xx.xxx.xxx'cat&gt;&gt;/root/.ssh/authorized_keys'
</span><span class='line'>$ cat ~/.ssh/id_rsa.pub| ssh Tomcat@MisteryPlace.xxx.xxx.xxx.com 'cat&gt;&gt;~/.ssh/authorized_keys'
</span></code></pre></td></tr></table></div></figure>


<p>
11. Font Configuration</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$  sudo mkdir -p /usr/share/fonts/vista
</span><span class='line'>$  sudo cp /mnt/usr/share/fonts/vista/YaHei.Consolas.1.11b.ttf /usr/share/fonts/vista
</span><span class='line'>$  sudo chmod 644 /usr/share/fonts/vista/*.ttf
</span><span class='line'>$  cd /usr/share/fonts/vista/
</span><span class='line'>$  sudo mkfontscale && sudo mkfontdir && sudo fc-cache -fv
</span></code></pre></td></tr></table></div></figure>


<p>Then change the terminal font to YaHei   <br/>
12. blog writing use:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ echo insecure &gt;&gt; ~/.curlrc
</span><span class='line'>$ curl -k --insecure  -L https://get.rvm.io | bash -s stable --ruby
</span><span class='line'>$ rvm install 1.9.3
</span><span class='line'>$ gem install bundler
</span><span class='line'>$ bundle install
</span></code></pre></td></tr></table></div></figure>


<p>You have to enable the terminal emulator&rsquo;s setting by enable &ldquo;Run command as login shell&rdquo;.   <br/>
Then you have to add the ssh key to the github.com.   <br/>
13. Configure bridged network for qemu use.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># systemctl start systemd-networkd.service 
</span><span class='line'>[root@TrustyArch network]# systemctl enable systemd-networkd.service
</span><span class='line'>Created symlink from /etc/systemd/system/multi-user.target.wants/systemd-networkd.service to /usr/lib/systemd/system/systemd-networkd.service.
</span><span class='line'># systemctl disable dhcpcd@enp0s25
</span><span class='line'>[root@TrustyArch Trusty]# systemctl enable dhcpcd@enp0s25
</span><span class='line'>Created symlink from /etc/systemd/system/multi-user.target.wants/dhcpcd@enp0s25.service to /usr/lib/systemd/system/dhcpcd@.service.
</span><span class='line'>[root@TrustyArch Trusty]# systemctl disable dhcpcd@enp0s25
</span><span class='line'>Removed symlink /etc/systemd/system/multi-user.target.wants/dhcpcd@enp0s25.service.
</span><span class='line'>[root@TrustyArch network]# cat MyDhcp.network 
</span><span class='line'>[Match]
</span><span class='line'>Name=enp0s25
</span><span class='line'>
</span><span class='line'>[Network]
</span><span class='line'>DHCP=yes
</span><span class='line'>[root@TrustyArch network]# pwd
</span><span class='line'>/etc/systemd/network
</span></code></pre></td></tr></table></div></figure>


<p>Now the network is configured to dhcpcd@enp0s25.</p>

<p>Continue to edit for bridge :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@TrustyArch network]# cat MyBridge.netdev 
</span><span class='line'>[NetDev]
</span><span class='line'>Name=br0
</span><span class='line'>Kind=bridge
</span><span class='line'>MacAddress=
</span><span class='line'>[root@TrustyArch network]# cat MyBridge.network 
</span><span class='line'>[Match]
</span><span class='line'>Name=br0
</span><span class='line'>
</span><span class='line'>[Network]
</span><span class='line'>DHCP=yes
</span><span class='line'>[root@TrustyArch network]# cat MyEth.network 
</span><span class='line'>[Match]
</span><span class='line'>Name=enp0s25
</span><span class='line'>
</span><span class='line'>[Network]
</span><span class='line'>Bridge=br0
</span><span class='line'>$ systemctl restart systemd-networkd.service
</span></code></pre></td></tr></table></div></figure>


<p>Now restart and you will see the status via: <code>systemctl status systemd-networkd.service</code></p>

<p>14. mlocate</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S mlocate
</span><span class='line'>sudo updatedb
</span></code></pre></td></tr></table></div></figure>


<p>15. Whatpulse</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yaourt whatpulse
</span></code></pre></td></tr></table></div></figure>


<p>Be sure to download the setup script, eg, the source code package, and grant all of the priviledge to your username.</p>

<p>16. Vim Customization  <br/>
Copy the old .vimrc, and update it. Vundle will do everything for you.</p>

<p>17. Samba Configuration</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S samba
</span></code></pre></td></tr></table></div></figure>


<p>Then configure the samba configure, the configuration file should be the same or modifed from the old one.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo systemctl enable smbd.service
</span><span class='line'>$ sudo systemctl enable nmbd.service
</span><span class='line'>$ sudo systemctl start smbd.service
</span><span class='line'>$ sudo systemctl start nmbd.service
</span><span class='line'>$ sudo smbpasswd -a Trusty
</span></code></pre></td></tr></table></div></figure>


<p>Now in the guest machine you can use samba server for downloading.</p>

<p>18. Virtualbox Migration.  <br/>
Create new machines using the exisiting hard-disk.  <br/>
Then:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>modprobe vboxdrv
</span><span class='line'>modprobe vboxnetflt
</span></code></pre></td></tr></table></div></figure>


<p>Change the key for switching back to host system.  <br/>
File->Preference->Input->Virtual Machine-> Host Key Combination.</p>

<p>19. Network Indicator  <br/>
Install wicd via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S wicd wicd-gtk
</span><span class='line'>$ sudo systemctl start wicd.service
</span><span class='line'>$ sudo systemctl enable wicd.service
</span></code></pre></td></tr></table></div></figure>


<p>Then enable it in the awesome or change view files.  <br/>
I enable it in rc.lua of awesome WM.</p>

<p>20.  unrar</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S unrar 
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>21. Vrome Customization</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>set useletters=0
</span></code></pre></td></tr></table></div></figure>


<p>22. Opera</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yaourt -S opera
</span></code></pre></td></tr></table></div></figure>


<p>23. Nautilus</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S nautilus
</span></code></pre></td></tr></table></div></figure>


<p>24. xampp configuration  <br/>
Refer to 2014-04-23-deploy-xampp-on-archlinux.markdown</p>

<p>25. Firefox customization  <br/>
Install Vimperator.  <br/>
Install video download.</p>

<p>26. Nokia 525  <br/>
Install gmtp via yaourt:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yaourt gmtp
</span></code></pre></td></tr></table></div></figure>


<p>27. Virtualbox Modules.   <br/>
Add following definitions:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>[root@TrustyArch modules-load.d]# cat virtualbox.conf 
</span><span class='line'>vboxdrv vboxnetflt vboxnetadp
</span><span class='line'>[root@TrustyArch modules-load.d]# pwd
</span><span class='line'>/etc/modules-load.d
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>28. Install qupzilla.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S qupzilla
</span></code></pre></td></tr></table></div></figure>


<p>29. Install gitbook.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo npm install gitbook -g
</span></code></pre></td></tr></table></div></figure>


<p>30. Install calibre.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S calibre
</span></code></pre></td></tr></table></div></figure>


<p>31. Install tree.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo pacman -S tree
</span></code></pre></td></tr></table></div></figure>


<p>32. gitbook-pdf  <br/>
First install phantomjs:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yaourt -S phantomjs
</span></code></pre></td></tr></table></div></figure>


<p>Then :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo npm install gitbook-pdf -g
</span></code></pre></td></tr></table></div></figure>


<p>Then generate book via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ gitbook pdf ./my_repository
</span></code></pre></td></tr></table></div></figure>


<p>33. Auto logon
Auto login in tty1 at start-up:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@DashArch ~]$ sudo mkdir /etc/systemd/system/getty@tty1.service.d
</span><span class='line'>[Trusty@DashArch ~]$ cat /etc/systemd/system/getty\@tty1.service.d/autologin.conf 
</span><span class='line'>[Service]
</span><span class='line'>ExecStart=
</span><span class='line'>ExecStart=-/usr/bin/agetty --autologin Trusty --noclear %I 38400 linux
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/30/zai-githubshang-bu-shu-ni-de-octopressbo-ke/">在github上部署你的octopress博客</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-30T21:10:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:10 pm</span></time>
        
         | <a href="/blog/2014/07/30/zai-githubshang-bu-shu-ni-de-octopressbo-ke/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>环境: ArchLinux</p>

<h3>准备</h3>

<p>ArchLinux上安装git 和 ruby:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S git ruby 
</span></code></pre></td></tr></table></div></figure>


<p>安装rvm, 因为我用代理的缘故，所以使用了<code>-k --insecure</code> 选项，如果你的网络未收到任何阻挠，推荐你使用<code>curl -L https://get.rvm.io | bash -s stable --ruby</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ echo insecure &gt;&gt; ~/.curlrc
</span><span class='line'>$ curl -k --insecure  -L https://get.rvm.io | bash -s stable --ruby
</span></code></pre></td></tr></table></div></figure>


<p>重新登录终端：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@archi386 ~]# which rvm
</span><span class='line'>/usr/local/rvm/bin/rvm
</span><span class='line'>[root@archi386 ~]# rvm install 1.9.3
</span><span class='line'>[root@archi386 ~]# rvm use 1.9.3
</span><span class='line'>Using /usr/local/rvm/gems/ruby-1.9.3-p547
</span><span class='line'>[root@archi386 ~]# rvm rubygems latest
</span><span class='line'>Rubygems 2.2.2 already available in installed ruby, skipping installation, use --force to reinstall.
</span></code></pre></td></tr></table></div></figure>


<p>在上面的步骤后，你可以运行下列命令，确认自己的ruby版本是1.9.3</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@archi386 ~]# ruby --version
</span><span class='line'>ruby 1.9.3p547 (2014-05-14 revision 45962) [i686-linux]
</span></code></pre></td></tr></table></div></figure>


<p>在你定义的目录里, 安装Octopress:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git clone git://github.com/imathis/octopress.git octopress
</span><span class='line'>$ cd octopress
</span><span class='line'>$ gem install bundler
</span><span class='line'>$ bundle install
</span></code></pre></td></tr></table></div></figure>


<p>接下来，安装默认的主题:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake install
</span></code></pre></td></tr></table></div></figure>


<p>补充：在ArchLinux上，需要更改Gemfile: 添加下面两行：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  gem 'therubyracer'
</span><span class='line'>  gem 'execjs'
</span></code></pre></td></tr></table></div></figure>


<p>而后执行<code>bundle install</code>后方可运行<code>rake generate</code>.</p>

<h3>Github</h3>

<p>申请新的github帐号：  <br/>
到<a href="https://github.com/join">https://github.com/join</a>申请你的github帐号， 提供一个例子如下：   <br/>
<img src="/images/githubjoin.jpg" alt="/images/githubjoin.jpg" /></p>

<p>创建一个新的代码仓库:  <br/>
<img src="/images/createnew.jpg" alt="/images/createnew.jpg" />  <br/>
取名：  <br/>
<img src="/images/reponame.jpg" alt="/images/reponame.jpg" /></p>

<p>如果要使用github的托管网页服务，需要让你的邮箱通过验证。</p>

<h3>部署博客</h3>

<p>运行下列命令后，照着格式填写诸如'git@github.com:maofphn/maofphn.github.io.git`的地址。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rake setup_github_pages
</span></code></pre></td></tr></table></div></figure>


<p>生成和部署博客:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rake generate
</span><span class='line'>$ rake deploy
</span></code></pre></td></tr></table></div></figure>


<p>而后访问<a href="http://maofphn.github.io">http://maofphn.github.io</a>就可以看到生成的网站了。  <br/>
要写新博文，用下列命令:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rake new_post["文章标题"]
</span></code></pre></td></tr></table></div></figure>


<p>生成的是markdown文件，所以你需要熟悉markdown语法，这里有个作弊手册:  <br/>
<a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet">https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet</a></p>

<h3>Trouble Shooting</h3>

<p>In ubuntu, you need to intall <code>ruby-dev</code> first, then you could use <code>bundle install</code> for building the local repository.    <br/>
Or you will met:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Error: failed to build gem native extension
</span></code></pre></td></tr></table></div></figure>


<p>If you met following error,</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>YAML Exception reading index.markdown: invalid byte sequence in US-ASCII
</span></code></pre></td></tr></table></div></figure>


<p>Then you should do following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># For using bundle
</span><span class='line'>export LANG=en_US.UTF-8
</span><span class='line'>export LANGUAGE=en_US.UTF-8
</span><span class='line'>export LC_ALL=en_US.UTF-8
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/20/video-card-problem-on-archlinux/">Video Card Problem on ArchLinux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-20T10:52:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:52 am</span></time>
        
         | <a href="/blog/2014/07/20/video-card-problem-on-archlinux/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The video card crash problem is caused by acceleration method chosen. My ArchLinux Installed on 2013.06.30, while at that time the default acceleration method is uxa, but now most of it uses sna. So if I choose sna instead of uxa, then problem will be solved.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~]$ cat /var/log/Xorg.0.log | grep -i uxa
</span><span class='line'>[  7841.603] (**) intel(0): Option "AccelMethod" "uxa"
</span><span class='line'>[  7841.638] (II) UXA(0): Driver registered support for the following operations:
</span><span class='line'>[  7841.638] (II) intel(0): Use legacy UXA acceleration.
</span><span class='line'>[Trusty@~]$ vim at /etc/X11/xorg.conf.d/20-intel.conf
</span><span class='line'>2 files to edit
</span><span class='line'>[Trusty@~]$ sudo vim /etc/X11/xorg.conf.d/20-intel.conf
</span><span class='line'>[Trusty@~]$ cat /etc/X11/xorg.conf.d/20-intel.conf
</span><span class='line'>Section "Device"
</span><span class='line'>   Identifier  "Intel Graphics"
</span><span class='line'>   Driver      "intel"
</span><span class='line'>   Option      "AccelMethod"  "sna"
</span><span class='line'>EndSection
</span></code></pre></td></tr></table></div></figure>


<p>After Reboot, view the result. :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~]$ cat /var/log/Xorg.0.log | grep -i sna
</span><span class='line'>[    73.402] (**) intel(0): Option "AccelMethod" "sna"
</span><span class='line'>[    73.532] (II) intel(0): SNA initialized with Sandybridge (gen6, gt2) backend
</span><span class='line'>[Trusty@~]$ cat /var/log/Xorg.0.log | grep -i uxa
</span></code></pre></td></tr></table></div></figure>


<p>Hope crash won&rsquo;t happen again.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/12/porting-weather-app-into-node-dot-js-3/">Porting Weather APP Into Node.js(3)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-12T16:19:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:19 pm</span></time>
        
         | <a href="/blog/2014/07/12/porting-weather-app-into-node-dot-js-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Get the timstamp of the record</h3>

<p>ObjectID could automatically store the insert timestamp, see following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; db.usercollection.find().pretty()
</span><span class='line'>........
</span><span class='line'>........
</span><span class='line'>&gt; ObjectId("53be4e7eb5ca215e38c5f651").getTimestamp()
</span><span class='line'>ISODate("2014-07-10T08:27:42Z")
</span><span class='line'>&gt; ObjectId("53be4e7cb5ca215e38c5f650").getTimestamp()
</span><span class='line'>ISODate("2014-07-10T08:27:40Z")
</span></code></pre></td></tr></table></div></figure>


<h3>Time Format</h3>

<p>Run following commands to get the timestamp since 1970:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; day=new Date()
</span><span class='line'>Sat Jul 12 2014 21:15:10 GMT+0800 (CST)
</span><span class='line'>&gt; day
</span><span class='line'>Sat Jul 12 2014 21:15:10 GMT+0800 (CST)
</span><span class='line'>&gt; day.getTime()
</span><span class='line'>1405170910049
</span></code></pre></td></tr></table></div></figure>


<p>The date which we fetched should be multiply 1000.  <br/>
And write a for loop for getting out the real date:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  // helper function
</span><span class='line'>  function getDate(d) {
</span><span class='line'>      return new Date(d);
</span><span class='line'>  }
</span><span class='line'>  console.log("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
</span><span class='line'>  // Refers to 1405170910049
</span><span class='line'>  // WhatWeGet 1405170047
</span><span class='line'>  // Should multiply 1000, Print out all of the timestamp
</span><span class='line'>  for ( kk = 1; kk &lt; 24; kk++)
</span><span class='line'>  {
</span><span class='line'>     console.log(getDate(date_data[kk]*1000));
</span><span class='line'>  }
</span></code></pre></td></tr></table></div></figure>


<p>Print the type of the variable:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>console.log(typeof (#{weatherlist[3].Temperature}));
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/12/hightlight-jade-file/">Hightlight Jade File</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-12T14:36:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:36 pm</span></time>
        
         | <a href="/blog/2014/07/12/hightlight-jade-file/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Install <code>vim-jade</code> via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Bundle 'digitaltoad/vim-jade'
</span></code></pre></td></tr></table></div></figure>


<p>Then in vim type <code>:BundleInstall</code> this will automatically install the plugin of vim-jade.   <br/>
Enable the Highlight of jade file via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>au BufNewFile,BufRead,BufReadPost *.jade set filetype=jade
</span></code></pre></td></tr></table></div></figure>


<p>Now everytime you open jade file, it will be automatically be highlighted.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/09/porting-weather-app-into-node-dot-js-2/">Porting Weather APP Into Node.js(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-09T10:34:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:34 am</span></time>
        
         | <a href="/blog/2014/07/09/porting-weather-app-into-node-dot-js-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Add packages dependencies:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  "dependencies": {
</span><span class='line'>    "express": "^4.5.1",
</span><span class='line'>    "logfmt": "^1.1.2",
</span><span class='line'>    "static-favicon": "~1.0.0",
</span><span class='line'>    "morgan": "~1.0.0",
</span><span class='line'>    "cookie-parser": "~1.0.1",
</span><span class='line'>    "body-parser": "~1.0.0",
</span><span class='line'>    "debug": "~0.7.4",
</span><span class='line'>    "jade": "~1.3.0", 
</span><span class='line'>    "mongodb": "*",
</span><span class='line'>    "monk": "*"
</span><span class='line'>  },
</span></code></pre></td></tr></table></div></figure>


<p>Then <code>npm install</code> to install the dependencies.</p>

<p>Install the package and save the version in package.json:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>npm install forecast --save
</span><span class='line'>npm install cron --save
</span><span class='line'>npm install http --save
</span><span class='line'>npm install cheerio --save
</span></code></pre></td></tr></table></div></figure>


<p>Merge the TestNanjing.js and web.js file, let the fetch to be a function, or to be module.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/07/porting-weather-app-into-node-dot-js/">Porting Weather APP Into Node.js</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-07T18:36:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>6:36 pm</span></time>
        
         | <a href="/blog/2014/07/07/porting-weather-app-into-node-dot-js/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Website Design</h3>

<p>Use express for generating the whole website.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pwd 
</span><span class='line'>/home/Trusty/code/nodejs/weather
</span><span class='line'>[Trusty@~/code/nodejs/weather]$ express weather
</span></code></pre></td></tr></table></div></figure>


<p>The express framework will be generated.</p>

<p>Add following dependencies into the weather/package.json:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"jade": "~1.3.0", 
</span><span class='line'>"mongodb": "*",
</span><span class='line'>"monk": "*"
</span></code></pre></td></tr></table></div></figure>


<p>Install packages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd weather
</span><span class='line'>$ npm install
</span></code></pre></td></tr></table></div></figure>


<p><code>mkdir data</code>, this command will create a directory named <code>data</code> which is used for holding our mongodb.  <br/>
Now visit <a href="http://localhost:3000/">http://localhost:3000/</a> you will see the demo html website.</p>

<p>This website should have the inteface for operating the database(MongoDB), so I will add some sub-pages for handling the request for insert and query the database.</p>

<h4>Insert Records Into MongoDB</h4>

<p>Design database in MongoDB:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mongo
</span><span class='line'>$ show dbs
</span><span class='line'>admin       (empty)
</span><span class='line'>local       0.078GB
</span><span class='line'>my-website  0.078GB
</span><span class='line'>mydb        0.078GB
</span><span class='line'>nodetest1   0.078GB
</span><span class='line'>test        (empty)
</span><span class='line'>$ use weathertest
</span></code></pre></td></tr></table></div></figure>


<p>The DataSet should be designed as following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>    "_id" : 1234,
</span><span class='line'>    "AQI" : "70",
</span><span class='line'>    "Level" : "良", 
</span><span class='line'>    "FirstPollution" : "臭氧1小时", 
</span><span class='line'>    "PM2_5" : "51", 
</span><span class='line'>    "PM10" : "70", 
</span><span class='line'>    "CO" : "0.148", 
</span><span class='line'>    "NO2" : "31", 
</span><span class='line'>    "O3_1hour" : "168", 
</span><span class='line'>    "O3_8hour" : "68", 
</span><span class='line'>    "S02" : "13" 
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>So the insert sentense should be like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>db.usercollection.insert({ "AQI" : "70", "Level" : "良", "FirstPollution" : "臭氧1小时", "PM2_5" : "51", "PM10" : "70", "CO" : "0.148", "NO2" : "31", "O3_1hour" : "168", "O3_8hour" : "68", "SO2" :"13"})
</span></code></pre></td></tr></table></div></figure>


<p>Verify the insert result via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; db.usercollection.find().pretty()
</span><span class='line'>{
</span><span class='line'>  "_id" : ObjectId("53ba7e137346b7523d951084"),
</span><span class='line'>  "AQI" : "70",
</span><span class='line'>  "Level" : "良",
</span><span class='line'>  "FirstPollution" : "臭氧1小时",
</span><span class='line'>  "PM2_5" : "51",
</span><span class='line'>  "PM10" : "70",
</span><span class='line'>  "CO" : "0.148",
</span><span class='line'>  "NO2" : "31",
</span><span class='line'>  "O3_1hour" : "168",
</span><span class='line'>  "O3_8hour" : "68",
</span><span class='line'>  "SO2" : "13"
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>Should add more informations into the database, for example the temperature/humidity, which could also be fetched via npm package.  <br/>
First delete the inserted item via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; db.usercollection.remove({"_id" : ObjectId("53ba7e137346b7523d951084")});
</span><span class='line'>WriteResult({ "nRemoved" : 1 })
</span><span class='line'>&gt; db.usercollection.find().pretty()
</span></code></pre></td></tr></table></div></figure>


<p>Then insert a new organized records and verify the insertion :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>db.usercollection.insert({ "Temperature" : "21.9", "DewPoint" : "19.93", "Humidity" : "0.89", "Pressure" : "1004.85", "Ozeone" : "289.03",  "AQI" : "70", "Level" : "良", "FirstPollution" : "臭氧1小时", "PM2_5" : "51", "PM10" : "70", "CO" : "0.148", "NO2" : "31", "O3_1hour" : "168", "O3_8hour" : "68", "SO2" :"13", "CurrentTime": "ISODate()"})
</span><span class='line'>&gt; db.usercollection.find().pretty()
</span><span class='line'>{
</span><span class='line'>  "_id" : ObjectId("53ba82f97346b7523d951085"),
</span><span class='line'>  "Temperature" : "21.9",
</span><span class='line'>  "DewPoint" : "19.93",
</span><span class='line'>  "Humidity" : "0.89",
</span><span class='line'>  "Pressure" : "1004.85",
</span><span class='line'>  "Ozeone" : "289.03",
</span><span class='line'>  "AQI" : "70",
</span><span class='line'>  "Level" : "良",
</span><span class='line'>  "FirstPollution" : "臭氧1小时",
</span><span class='line'>  "PM2_5" : "51",
</span><span class='line'>  "PM10" : "70",
</span><span class='line'>  "CO" : "0.148",
</span><span class='line'>  "NO2" : "31",
</span><span class='line'>  "O3_1hour" : "168",
</span><span class='line'>  "O3_8hour" : "68",
</span><span class='line'>  "SO2" : "13"
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>We will insert many many records into the database, how to distinguish them? By Timestamp!!!</p>

<p>In MongoDB we have the built-in Function Date():</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; Date()
</span><span class='line'>Mon Jul 07 2014 19:29:36 GMT+0800 (CST)
</span></code></pre></td></tr></table></div></figure>


<p>Each inserted Dataset&rsquo;s timestamp could be fetched out via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; ObjectId("53ba876d7346b7523d951088").getTimestamp()
</span><span class='line'>ISODate("2014-07-07T11:41:33Z")
</span></code></pre></td></tr></table></div></figure>


<p>Next step is using node.js api for processing the dataset.</p>

<h4>Display The Inserted Records</h4>

<p>We want to display the result like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;ul&gt;
</span><span class='line'>    &lt;li&gt;Temperature: 21.9, DewPoint: 19.93, Humidity: 0.89, Pressure: 1004.85, Ozeone: 289.03, AQI: 70, Level: 良, FirstPollution: 臭氧1小时, PM2.5: 51, PM10: 70, CO: 0.148, NO2: 31, O3一小时： 168, O3八小时： 68, So2: 13。 &lt;/li&gt;
</span><span class='line'>    &lt;li&gt;Temperature: 21.9, DewPoint: 19.93, Humidity: 0.89, Pressure: 1004.85, Ozeone: 289.03, AQI: 70, Level: 良, FirstPollution: 臭氧1小时, PM2.5: 51, PM10: 70, CO: 0.148, NO2: 31, O3一小时： 168, O3八小时： 68, So2: 13。 &lt;/li&gt;
</span><span class='line'>    &lt;li&gt;Temperature: 21.9, DewPoint: 19.93, Humidity: 0.89, Pressure: 1004.85, Ozeone: 289.03, AQI: 70, Level: 良, FirstPollution: 臭氧1小时, PM2.5: 51, PM10: 70, CO: 0.148, NO2: 31, O3一小时： 168, O3八小时： 68, So2: 13。 &lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Change the router/index.js, add following lines:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* GET weatherlist page. */
</span><span class='line'>router.get('/weatherlist', function(req, res) {
</span><span class='line'>    var db = req.db;
</span><span class='line'>    var collection = db.get('usercollection');
</span><span class='line'>    collection.find({},{},function(e,docs){
</span><span class='line'>        res.render('weatherlist', {
</span><span class='line'>            "weatherlist" : docs
</span><span class='line'>        });
</span><span class='line'>    });
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>Add the new file named <code>weatherlist.jade</code> under views/ folder:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>block content
</span><span class='line'>    h1.
</span><span class='line'>        Weather List
</span><span class='line'>    ul
</span><span class='line'>        each weather, i in weatherlist
</span><span class='line'>            li
</span><span class='line'>                首要污染物: #{weather.FirstPollution}, &lt;br /&gt;级别: #{weather.Level},&lt;br /&gt;AQI: #{weather.AQI},&lt;br /&gt;PM2.5: #{weather.PM2_5},&lt;br /&gt;PM10: #{weather.PM10}, &lt;br /&gt;一氧化碳: #{weather.CO}, &lt;br /&gt;二氧化氮: #{weather.NO2}, &lt;br /&gt;臭氧一小时浓度: #{weather.O3_1hour}, &lt;br /&gt;臭氧八小时浓度: #{weather.O3_8hour}, &lt;br /&gt;二氧化硫: #{weather.SO2}, &lt;br /&gt;温度: #{weather.Temperature}, &lt;br /&gt;露点: #{weather.DewPoint}, &lt;br /&gt;湿度: #{weather.Humidity}, &lt;br /&gt;气压: #{weather.Pressure}, &lt;br /&gt;Ozeone: #{weather.Ozeone}
</span></code></pre></td></tr></table></div></figure>


<p>Now visit <a href="http://localhost:3000/weatherlist">http://localhost:3000/weatherlist</a> we could see the record has been listed on the page.</p>

<h4>Insert Records In Nodejs</h4>

<p>We should use a crontab task for inserting the record once we fetched the data.  <br/>
The fetching process could be seperated from the web frame, or we could put the script into the directory, and let cron run it, it&rsquo;s OK.</p>

<p>Following is a sample code for inserting record into mongoDB:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* 
</span><span class='line'>* This example uses the node MongoDB module to connect to the local
</span><span class='line'>* mongodb database on this virtual machine
</span><span class='line'>*
</span><span class='line'>* More here: http://mongodb.github.io/node-mongodb-native/markdown-docs/insert.html
</span><span class='line'>*/
</span><span class='line'>
</span><span class='line'>//require node modules (see package.json)
</span><span class='line'>var MongoClient = require('mongodb').MongoClient
</span><span class='line'>    , format = require('util').format;
</span><span class='line'>
</span><span class='line'>//connect away
</span><span class='line'>MongoClient.connect('mongodb://127.0.0.1:27017/test', function(err, db) {
</span><span class='line'>  if (err) throw err;
</span><span class='line'>  console.log("Connected to Database");
</span><span class='line'>
</span><span class='line'>  //simple json record
</span><span class='line'>  var document = {name:"David1", title:"About MongoDB1"};
</span><span class='line'>  
</span><span class='line'>  //insert record
</span><span class='line'>  db.collection('test').insert(document, function(err, records) {
</span><span class='line'>      if (err) throw err;
</span><span class='line'>      console.log("Record added as "+records[0]._id);
</span><span class='line'>      //After insertion, close it.
</span><span class='line'>      db.close();
</span><span class='line'>      return;
</span><span class='line'>  });
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>Once fetched, insert into the weathertest Database.</p>

<h4>Display How Many Items</h4>

<p>It should fetch the latest 24 items from the database, thus we should modify the code for fetching out 24 items.</p>

<p>Edit routes/index.js:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* GET weatherlist page. */
</span><span class='line'>router.get('/weatherlist', function(req, res) {
</span><span class='line'>    var db = req.db;
</span><span class='line'>    var collection = db.get('usercollection');
</span><span class='line'>
</span><span class='line'>    collection.find({},{limit:24},function(e,docs){
</span><span class='line'>        res.render('weatherlist', {
</span><span class='line'>            "weatherlist" : docs
</span><span class='line'>        });
</span><span class='line'>    });
</span><span class='line'>
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<h4>Deploy it on heroku</h4>

<p>Via following commands we could setup a brand new APP on heroku:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ heroku login
</span><span class='line'>$ cat web.js
</span><span class='line'>// web.js
</span><span class='line'>var express = require("express");
</span><span class='line'>var logfmt = require("logfmt");
</span><span class='line'>var app = express();
</span><span class='line'>
</span><span class='line'>app.use(logfmt.requestLogger());
</span><span class='line'>
</span><span class='line'>app.get('/', function(req, res) {
</span><span class='line'>  res.send('Hello World!');
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>var port = Number(process.env.PORT || 5000);
</span><span class='line'>app.listen(port, function() {
</span><span class='line'>  console.log("Listening on " + port);
</span><span class='line'>});
</span><span class='line'>$ npm init
</span><span class='line'>$ npm install express logfmt --save
</span><span class='line'>$ cat package.json
</span><span class='line'>  "engines": {
</span><span class='line'>    "node": "0.10.x"
</span><span class='line'>  }
</span><span class='line'>$ cat Procfile 
</span><span class='line'>web: node web.js
</span><span class='line'>$ foreman start
</span><span class='line'>$ chromium http://localhost:5000
</span><span class='line'>$ git init
</span><span class='line'>$ git add .
</span><span class='line'>$ git commit -m "init"
</span><span class='line'>$ git remote add heroku git@heroku.com:node-weather-app.git
</span><span class='line'>$ git push heroku master
</span></code></pre></td></tr></table></div></figure>


<p>Now visit <a href="http://node-weather-app.herokuapp.com">http://node-weather-app.herokuapp.com</a> you can see &ldquo;Hello World!&rdquo;.</p>

<p>When adding MongoDB add-ons, it says failed with following information:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ heroku addons:add mongolab
</span><span class='line'>Adding mongolab on node-weather-app... failed
</span><span class='line'> !    Please verify your account to install this add-on plan
</span><span class='line'> !    For more information, see https://devcenter.heroku.com/categories/billing
</span><span class='line'> !    Verify now at https://heroku.com/verify
</span></code></pre></td></tr></table></div></figure>


<p>Apply the free account at<a href="https://www.mongosoup.de/">https://www.mongosoup.de/</a>, then login and create a new database plan, Next time if you want to view your database, simply open your browser and go to <a href="https://controlpanel.mongosoup.de/">https://controlpanel.mongosoup.de/</a>.   <br/>
Click the Databases, and select the database, then <code>show password</code>, it will shows you with the Database info, something like:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Connection string:   mongodb://############:###########@dbs004.mongosoup.de/cc_KNoBTXxNbHhS
</span></code></pre></td></tr></table></div></figure>


<p>It seems the account failed, so I create a new account using another email, xxxxxxxxxx.  <br/>
This time the app&rsquo;s name is named nodeweatherapp
git@heroku.com:nodeweatherapp.git   <br/>
And this time we will use root account for uploading.</p>

<pre><code>    Git URL: git@heroku.com:nodeweather.gi
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/07/my-translator-in-archlinux-3/">My Translator in ArchLinux(3)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-07T14:15:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:15 pm</span></time>
        
         | <a href="/blog/2014/07/07/my-translator-in-archlinux-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Using radis for cache the dictionary.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># In C, it's simple to use do...while(), but in python, we need to judge the input, 
</span><span class='line'># Fortunately, the input is very simple, because get infos from RedisQue is blocking.
</span><span class='line'># Forever Listening...
</span><span class='line'>while True:
</span><span class='line'>    # Key in RedisQueue is 'dic', and we simply get its content:
</span><span class='line'>    q = RedisQueue('dic')
</span><span class='line'>    # cmdargs = q.get()
</span><span class='line'>    # cmdargs = str(sys.argv) ## args
</span><span class='line'>    to_be_refer_word = q.get()
</span><span class='line'>    try:
</span><span class='line'>        result = my_dict_reader.get_dict_by_word(str(to_be_refer_word))  ## Using args[1] for querying
</span><span class='line'>        print result[0].values()[0]       ## output result in terminal
</span><span class='line'>        result_str = "\'&lt;span color=\"green\" size=\"14000\"&gt;"+result[0].values()[0]+"&lt;/span&gt;\'"  ## Build the command line for notify-send
</span><span class='line'>        call(["notify-send", to_be_refer_word, result_str])       ## Call notify-send to print on screen, last for 5 seconds
</span><span class='line'>    except Exception, e:
</span><span class='line'>        print "Not Find!"
</span></code></pre></td></tr></table></div></figure>


<p>Then we write the query file named <code>refer.py</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/python2
</span><span class='line'># -*- coding: utf-8 -*-
</span><span class='line'># For using RedisQueue to fetch the refer words 
</span><span class='line'>import sys
</span><span class='line'>from RedisQueue import RedisQueue
</span><span class='line'>
</span><span class='line'>q = RedisQueue('dic')
</span><span class='line'>q.put(str(sys.argv[1]))
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>Add the following lines as <code>/usr/bin/mydic</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Using redis
</span><span class='line'>python2 /home/Trusty/code/python/mypython/stardict/refer.py $@
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>This will greatly improve the refer time, you could get the real-time result via <code>mydic New_Words</code></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/24">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/22">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/19/wh-worktips-5/">WH Worktips(5)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/19/wh-worktips-4/">WH Worktips(4)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/18/use-virtualenv-for-downloading-pip-packages/">Use VirtualEnv for Downloading PIP Packages</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/18/wh-worktips-3/">WH Worktips(3)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/18/wh-worktips-2/">WH Worktips(2)</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>


<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="Cross-compiler Preparation The official documentation said use gcc-3.4.1 for compiling the kernel. 1
2
3
4
5
6
7
8
9
10
$ cat ~/.zshrc | grep -i &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/23">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/18/cross-compile-the-kernel-for-utu2440/">Cross-compile the Kernel for Utu2440</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-18T16:09:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:09 pm</span></time>
        
         | <a href="/blog/2014/10/18/cross-compile-the-kernel-for-utu2440/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Cross-compiler Preparation</h3>

<p>The official documentation said use gcc-3.4.1 for compiling the kernel.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat ~/.zshrc | grep -i set341
</span><span class='line'>alias set341='export PATH=/opt/cross/arm-linux-gcc_3.4.1/bin:$PATH'
</span><span class='line'>$ set341
</span><span class='line'>$ pwd
</span><span class='line'>/media/y/embedded/utu2440/UTU2440-F-T1-20080328/YC2440CDROM_DM9000_080328/utuLinuxfor2440V1.5.8/utu-linux_for_s3c2440_dm9000_V1.5.8
</span><span class='line'>$ arm-linux-gcc -v
</span><span class='line'>Reading specs from /opt/cross/arm-linux-gcc_3.4.1/bin/../lib/gcc/arm-linux/3.4.1/specs
</span><span class='line'>Configured with: /work/crosstool-0.27/build/arm-linux/gcc-3.4.1-glibc-2.3.2/gcc-3.4.1/configure --target=arm-linux --host=i686-host_pc-linux-gnu --prefix=/usr/local/arm/3.4.1 --with-headers=/usr/local/arm/3.4.1/arm-linux/include --with-local-prefix=/usr/local/arm/3.4.1/arm-linux --disable-nls --enable-threads=posix --enable-symvers=gnu --enable-__cxa_atexit --enable-languages=c,c++ --enable-shared --enable-c99 --enable-long-long
</span><span class='line'>Thread model: posix
</span><span class='line'>gcc version 3.4.1
</span></code></pre></td></tr></table></div></figure>


<h3>Kernel Compilation</h3>

<p>Compile the kernel via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ make menuconfig
</span><span class='line'>"Load an Alternate Configuration File"-&gt; config_480272_ts
</span><span class='line'>$ make uImage -j4
</span></code></pre></td></tr></table></div></figure>


<p>Trouble shooting: in ArchLinux, install uboot&rsquo;s mkimage tool via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yaourt -S uboot-mkimage
</span></code></pre></td></tr></table></div></figure>


<p>After compilation finished, copy it to tftpd server and test:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp arch/arm/boot/uImage /media/nfs/rootfs/
</span><span class='line'>$ ls -l uImage 
</span><span class='line'>-rwxrwxrwx 1 root root 1483696 Oct 19  2014 uImage
</span><span class='line'>$ ls -l s3c_kernel/uImage_T5_480x272_ts 
</span><span class='line'>-rw------- 1 nobody nobody 1483468 Oct 19  2014 s3c_kernel/uImage_T5_480x272_ts
</span></code></pre></td></tr></table></div></figure>


<p>We use the compiled kernel and let it runs into the system. Next step we will upgrade the Linux kernel, this may lead to some kernel driver related working.      <br/>
Current kernel is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@utu-linux /]# uname -a
</span><span class='line'>Linux utu-linux 2.6.13-utulinux2440 #380 Sat Oct 18 16:14:06 CST 2014 armv4tl unknown
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/18/tftpd-on-ubuntu/">Tftpd on Ubuntu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-18T15:24:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>3:24 pm</span></time>
        
         | <a href="/blog/2014/10/18/tftpd-on-ubuntu/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For updating the kernel on s3c2440 board, I have to setup the tftpd server.</p>

<h3>tftpd server</h3>

<p>Install tfpd-hpa:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get install tftpd-hpa
</span></code></pre></td></tr></table></div></figure>


<p>Setup the directory name and edit the /etc/default/tftpd-hpa:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@joggler:/etc# cat /etc/default/tftpd-hpa 
</span><span class='line'># /etc/default/tftpd-hpa
</span><span class='line'>
</span><span class='line'>TFTP_USERNAME="tftp"
</span><span class='line'>TFTP_DIRECTORY="/media/nfs/rootfs"
</span><span class='line'>TFTP_ADDRESS="0.0.0.0:69"
</span><span class='line'>TFTP_OPTIONS="--secure"
</span></code></pre></td></tr></table></div></figure>


<p>Then restart the server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>service tftpd-hpa restart
</span></code></pre></td></tr></table></div></figure>


<p>Other commands:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>service tftpd-hpa status
</span><span class='line'>service tftpd-hpa stop
</span><span class='line'>service tftpd-hpa start
</span><span class='line'>service tftpd-hpa restart
</span><span class='line'>service tftpd-hpa force-reload
</span></code></pre></td></tr></table></div></figure>


<h3>Testing</h3>

<p>In the same machine, use following commands for testing the tftpd server(Make sure you have the get.txt under the root directory of your tftpd specified directory):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ tftp localhost
</span><span class='line'>tftp&gt; get get.txt
</span><span class='line'>tftp&gt; quit
</span></code></pre></td></tr></table></div></figure>


<h3>utu2440</h3>

<p>Test the utu2440&rsquo;s load_kernel function.   <br/>
Copy the corresponding kernel file in tftpd server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp s3c_kernel/uImage_T5_480x272_ts ./uImage
</span><span class='line'>$ chmod 777 uImage
</span></code></pre></td></tr></table></div></figure>


<p>First set the ipaddr for utu2440&rsquo;s uboot:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>utu-bootloader=&gt;&gt;&gt;setenv ipaddr 10.0.0.15
</span><span class='line'>utu-bootloader=&gt;&gt;&gt;ping 10.0.0.1
</span><span class='line'>dm9000 i/o: 0x18000300, id: 0x90000a46 
</span><span class='line'>MAC: 00:0c:20:02:0a:5b
</span><span class='line'>host 10.0.0.1 is alive
</span></code></pre></td></tr></table></div></figure>


<p>then set the server&rsquo;s address to 10.0.0.11(that&rsquo;s joggler with tftpd server enabled), use <code>printenv</code> for inspecting your configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>utu-bootloader=&gt;&gt;&gt;setenv ipaddr 10.0.0.15
</span><span class='line'>utu-bootloader=&gt;&gt;&gt;printenv
</span><span class='line'>ipaddr=10.0.0.15
</span><span class='line'>serverip=10.0.0.11
</span></code></pre></td></tr></table></div></figure>


<p>View the embedded &lsquo;install-kernel&rsquo; command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>utu-bootloader=&gt;&gt;&gt;printenv
</span><span class='line'>install-kernel=tftp 30000000 uImage;nand erase 60000 200000;nand write.i 30000000 60000 0
</span><span class='line'>utu-bootloader=&gt;&gt;&gt;run install-kernel
</span><span class='line'>dm9000 i/o: 0x18000300, id: 0x90000a46 
</span><span class='line'>MAC: 00:0c:20:02:0a:5b
</span><span class='line'>TFTP from server 10.0.0.11; our IP address is 10.0.0.15
</span><span class='line'>Filename 'uImage'.
</span><span class='line'>Load address: 0x30000000
</span><span class='line'>Loading: #################################################################
</span><span class='line'>         #################################################################
</span><span class='line'>         #################################################################
</span><span class='line'>         #################################################################
</span><span class='line'>         ##############################
</span><span class='line'>done
</span><span class='line'>Bytes transferred = 1483468 (16a2cc hex)
</span><span class='line'>
</span><span class='line'>NAND erase: device 0 offset 0x60000, size 0x200000
</span><span class='line'>Erasing at 0x25c000 -- 100% complete.
</span><span class='line'>OK
</span><span class='line'>
</span><span class='line'>NAND write: device 0 offset 0x60000, size 0x0
</span><span class='line'>
</span><span class='line'>Writing data at 0x1ca200 -- 100% complete.
</span><span class='line'> 1483776 bytes written: OK
</span><span class='line'>utu-bootloader=&gt;&gt;&gt;boot
</span></code></pre></td></tr></table></div></figure>


<p>Yes now you could compile your own kernel for utu2440.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/18/autorestart-autrace/">AutoRestart Autrace</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-18T11:07:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:07 am</span></time>
        
         | <a href="/blog/2014/10/18/autorestart-autrace/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>autrace is a proxy tool which I used for auto-converting the proxy for cross the firewall, it runs in remote server but sometimes it will runs into crash condition. Following is the command for auto-restart this proxy tool.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat autrace.sh
</span><span class='line'>#!/bin/sh
</span><span class='line'>while true; do
</span><span class='line'>   /home/xxxxxxxx/code/autrace -s 
</span><span class='line'>done
</span></code></pre></td></tr></table></div></figure>


<p>Everytime we run autrace.sh like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/home/xxxxx/code/autrace.sh &
</span></code></pre></td></tr></table></div></figure>


<p>thus autrace will automatically be restart if it crashes.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/18/ethernet-wakeup/">Ethernet Wakeup</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-18T09:48:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:48 am</span></time>
        
         | <a href="/blog/2014/10/18/ethernet-wakeup/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Purpose</h3>

<p>I want to wake up my laotop via RaspberryPi, since Rpi&rsquo;s power consumption is extremely low, so this will greatly save the power for laptop.</p>

<h3>Check Status</h3>

<p>On laptop, type following command to see whether your ethernet card support Wake-On-LAN or not:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~]$ sudo ethtool enp0s25 | grep Wake-on
</span><span class='line'>  Supports Wake-on: pumbg
</span><span class='line'>  Wake-on: g
</span></code></pre></td></tr></table></div></figure>


<p>The values define what activity to wake on: p (PHY activity), u (unicast activity), m (multicast activity), b (broadcast activity), a (ARP activity), and g (magic packet activity).We need g for WOL to work.</p>

<h3>RaspberryPI Configuration</h3>

<p>Make sure <code>wol</code> is installed, then you should know the target PC&rsquo;s ipaddress and mac address.   <br/>
Wakeup the remote machine via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wol -i 10.0.0.230 c8:xx:xx:xx:xx:xx
</span></code></pre></td></tr></table></div></figure>


<p>You could also set this command into a alias in ~/.bashrc.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/16/blueman/">Blueman</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-16T21:14:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:14 pm</span></time>
        
         | <a href="/blog/2014/10/16/blueman/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since I installed the ArchLinux around 3 months ago, but I am too busy to enable the bluetooth headset, now I am free finally, so this is the steps for enable the bluetooth headset.</p>

<h3>Software Installation</h3>

<p>Install blueman:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S blueman
</span><span class='line'>$ sudo pacman -S bluez-utils bluez-libs python2-pybluez
</span></code></pre></td></tr></table></div></figure>


<p>Wait, this method is not OK for current bluez5, so I need to switch to other method.  <br/>
Use official website,  named"Bluetooth headset" on ArchLinux Wiki.</p>

<h3>Bluez5/Pulseaudio</h3>

<p>Install packages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S pulseaudio-alsa bluez bluez-libs bluez-utils
</span><span class='line'>$ systemctl start bluetooth
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/15/trouble-shooting-on-docker/">Trouble-Shooting on Docker</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-15T19:07:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>7:07 pm</span></time>
        
         | <a href="/blog/2014/10/15/trouble-shooting-on-docker/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The guideline I follow is from :   <br/>
<a href="https://wiki.archlinux.org/index.php/Docker">https://wiki.archlinux.org/index.php/Docker</a></p>

<h3>Working behind Proxy</h3>

<p>When docker runs under the proxy, it will be blocked by the firewall, thus in the ArchLinux we have to kill the systemd started docker daemon, and manually set the proxy configuration for the docker daemon, following is the tips:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ systemctl stop docker.service
</span><span class='line'>$ sudo HTTP_PROXY=http://1xx.*.*.2xx:2xx3 docker -d &
</span></code></pre></td></tr></table></div></figure>


<p>Then you run the docker for create the new machine  will be OK.</p>

<h3>Default Configuration</h3>

<p>That leads me for thinking the default configuration of ArchLinux , change it to :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /usr/lib/systemd/system/docker.service
</span><span class='line'>[Unit]
</span><span class='line'>Description=Docker Application Container Engine
</span><span class='line'>Documentation=http://docs.docker.com
</span><span class='line'>After=network.target docker.socket
</span><span class='line'>Requires=docker.socket
</span><span class='line'>
</span><span class='line'>[Service]
</span><span class='line'>ExecStart=/usr/bin/docker -d 
</span><span class='line'>LimitNOFILE=1048576
</span><span class='line'>LimitNPROC=1048576
</span><span class='line'>
</span><span class='line'>[Install]
</span><span class='line'>Also=docker.socket
</span></code></pre></td></tr></table></div></figure>


<p>Add following line, but failed, Arch Wiki also indicates its failure:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Service]
</span><span class='line'>Environment="http_proxy=192.168.1.1:3128"
</span><span class='line'>ExecStart=
</span><span class='line'>ExecStart=/usr/bin/docker -d -g /var/yourDockerDir
</span></code></pre></td></tr></table></div></figure>


<p>So everytime you want to enable proxy, simply manually reload it.</p>

<p>Then reload the service status and restart the docker.service:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo systemctl daemon-reload
</span><span class='line'>sudo systemctl restart docker.service
</span></code></pre></td></tr></table></div></figure>


<p>Test the docker to view if it runs well:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker info
</span></code></pre></td></tr></table></div></figure>


<h3>Docker Management</h3>

<p>List the installed images:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~/code/octo/heroku/Tomcat]$ sudo docker images
</span><span class='line'>REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
</span><span class='line'>archlinux           latest              a063a516f4c7        About an hour ago   293 MB
</span><span class='line'>busybox             latest              e72ac664f4f0        13 days ago         2.433 MB
</span><span class='line'>base/archlinux      2014.07.03          ea234cde99e6        12 weeks ago        282.9 MB
</span><span class='line'>base/archlinux      2014.04.01          56c61f5c2920        12 weeks ago        293.3 MB
</span><span class='line'>base/archlinux      latest              dce0559daa1b        12 weeks ago        282.9 MB
</span></code></pre></td></tr></table></div></figure>


<p>List Containers:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~/code/octo/heroku/Tomcat]$ sudo docker ps -a
</span><span class='line'>CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                         PORTS               NAMES
</span><span class='line'>50baf5783c6e        busybox:latest      "/bin/echo hello wor   6 minutes ago       Exited (0) 6 minutes ago                           mad_carson          
</span><span class='line'>2f7108d2ee0e        archlinux:latest    "echo Success."        About an hour ago   Exited (0) About an hour ago                       jolly_galileo       
</span></code></pre></td></tr></table></div></figure>


<p>List the running Containers:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~/code/octo/heroku/Tomcat]$ docker ps
</span><span class='line'>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</span></code></pre></td></tr></table></div></figure>


<p>Now start a container via(This command will run into the container and execute the /bin/bash):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker run -i -t archlinux /bin/bash
</span><span class='line'>[root@b6ab14b2ce65 /]# 
</span></code></pre></td></tr></table></div></figure>


<p>Check the container status:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker ps
</span><span class='line'>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</span><span class='line'>b6ab14b2ce65        archlinux:latest    "/bin/bash"         27 seconds ago      Up 25 seconds                           high_wright   
</span></code></pre></td></tr></table></div></figure>


<p>When you exit, then the ps won&rsquo;t display the corresponding items.</p>

<h3>Install More Images</h3>

<p>Install via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker run ubuntu /bin/echo hello world
</span><span class='line'>$ docker run centos /bin/echo hello world
</span></code></pre></td></tr></table></div></figure>


<p>Run it ubuntu:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker run -i -t ubuntu /bin/bash   
</span><span class='line'>root@34b68719493b:/# cat /etc/issue
</span><span class='line'>Ubuntu 14.04.1 LTS \n \l
</span></code></pre></td></tr></table></div></figure>


<p>Run into centos:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ docker run -i -t centos /bin/bash   
</span><span class='line'>bash-4.2# uname -a
</span><span class='line'>Linux e3ec1911331b 3.16.4-1-ARCH #1 SMP PREEMPT Mon Oct 6 08:22:27 CEST 2014 x86_64 x86_64 x86_64 GNU/Linux
</span><span class='line'>bash-4.2# cat /etc/issue
</span><span class='line'>\S
</span><span class='line'>Kernel \r on an \m
</span><span class='line'>
</span><span class='line'>bash-4.2# which yum
</span><span class='line'>/usr/bin/yum
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/15/building-android-on-server/">Building Android on Server</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-15T10:41:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>10:41 am</span></time>
        
         | <a href="/blog/2014/10/15/building-android-on-server/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>New LXC Machine</h3>

<p>Building Android need a Ubuntu machine, so I created the LXC machine which runs Ubuntu.  <br/>
Install the bootstrap:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>zypper in bootstrap
</span></code></pre></td></tr></table></div></figure>


<p>Then create the Ubuntu LXC via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export LANG=en_US.UTF-8
</span><span class='line'>Linux59:~ # lxc-create -n Ubuntu_Container -t /usr/share/lxc/templates/lxc-ubuntu
</span></code></pre></td></tr></table></div></figure>


<p>Start the container, username and password are ubuntu:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>lxc-start -n Ubuntu_Container
</span></code></pre></td></tr></table></div></figure>


<h3>Configure the LXC Machine</h3>

<p>Better we have the static IP, and let the Container startup when machine boot.</p>

<h4>Static IP Configuration</h4>

<p>Change the network configuration via modifying the /etc/network/interfaces:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>auto eth0
</span><span class='line'>
</span><span class='line'># Enable it for dhcp
</span><span class='line'>#iface eth0 inet dhcp
</span><span class='line'>
</span><span class='line'># Enable them for static IP address
</span><span class='line'>iface eth0 inet static
</span><span class='line'>address 1xx.xxx.xxx.159
</span><span class='line'>netmask 255.255.255.0
</span><span class='line'>network 1xx.xxx.xxx.0
</span><span class='line'>broadcast 1xx.xxx.xxx.255
</span><span class='line'>gateway 1xx.xxx.xxx.1
</span></code></pre></td></tr></table></div></figure>


<p>Then next time you login into the machine, it hold the address of 159.</p>

<h4>Start Together With Host Machine</h4>

<p>Create a new definition file of systemd under the /usr/lib/systemd/system directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Linux59:/usr/lib/systemd/system # cat lxc\@.service
</span><span class='line'>[Unit]
</span><span class='line'>Description=%i LXC
</span><span class='line'>After=network.target
</span><span class='line'>
</span><span class='line'>[Service]
</span><span class='line'>Type=forking
</span><span class='line'>ExecStart=/usr/bin/lxc-start -d -n %i
</span><span class='line'>ExecStop=/usr/bin/lxc-stop -n %i
</span><span class='line'>
</span><span class='line'>[Install]
</span><span class='line'>WantedBy=multi-user.target
</span><span class='line'>
</span><span class='line'>Linux59:/usr/lib/systemd/system # pwd
</span><span class='line'>/usr/lib/systemd/system
</span></code></pre></td></tr></table></div></figure>


<p>Let <code>Ubuntu_Container</code> runs when system bootup.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># systemctl enable lxc@Ubuntu_Container.service
</span><span class='line'>ln -s '/usr/lib/systemd/system/lxc@.service' '/etc/systemd/system/multi-user.target.wants/lxc@Ubuntu_Container.service'
</span></code></pre></td></tr></table></div></figure>


<h4>Update</h4>

<p>visudo to change the settings:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ubuntu  ALL=(ALL:ALL) ALL
</span><span class='line'>Defaults env_keep = "http_proxy https_proxy ftp_proxy"
</span></code></pre></td></tr></table></div></figure>


<p>Enable proxy for apt-get:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/apt/apt.conf
</span><span class='line'>Acquire::http::Proxy "http://127.0.0.1:9001";
</span></code></pre></td></tr></table></div></figure>


<p>Update the system and install some packages:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get update
</span><span class='line'>$ sudo apt-get install tmux openjdk-7-jdk
</span><span class='line'>$ sudo update-alternatives --config java && sudo update-alternatives --config javac
</span><span class='line'>$ sudo apt-get install git gnupg flex bison gperf    zip curl libc6-dev libncurses5-dev:i386 x11proto-core-dev   libx11-dev:i386 libreadline6-dev:i386 libgl1-mesa-glx:i386   libgl1-mesa-dev  mingw32 tofrodos   python-markdown libxml2-utils xsltproc zlib1g-dev:i386
</span><span class='line'>$ sudo apt-get install build-essential 
</span><span class='line'>$ sudo apt-get install g++-multilib
</span><span class='line'>$ sudo ln -s /usr/lib/i386-linux-gnu/mesa/libGL.so.1 /usr/lib/i386-linux-gnu/libGL.so
</span></code></pre></td></tr></table></div></figure>


<h4>Configuration on USB</h4>

<p>Create following file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ubuntu@Ubuntu_Container:~$ cat /etc/udev/rules.d/51-android.rules 
</span><span class='line'># adb protocol on passion (Nexus One)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e12", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on passion (Nexus One)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="0bb4", ATTR{idProduct}=="0fff", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on crespo/crespo4g (Nexus S)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e22", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on crespo/crespo4g (Nexus S)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e20", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on stingray/wingray (Xoom)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="22b8", ATTR{idProduct}=="70a9", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on stingray/wingray (Xoom)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="708c", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on maguro/toro (Galaxy Nexus)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="04e8", ATTR{idProduct}=="6860", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on maguro/toro (Galaxy Nexus)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e30", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on panda (PandaBoard)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d101", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on panda (PandaBoard ES)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="d002", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on panda (PandaBoard)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d022", MODE="0600", OWNER="ubuntu"
</span><span class='line'># usbboot protocol on panda (PandaBoard)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d00f", MODE="0600", OWNER="ubuntu"
</span><span class='line'># usbboot protocol on panda (PandaBoard ES)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d010", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on grouper/tilapia (Nexus 7)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e42", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on grouper/tilapia (Nexus 7)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e40", MODE="0600", OWNER="ubuntu"
</span><span class='line'># adb protocol on manta (Nexus 10)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4ee2", MODE="0600", OWNER="ubuntu"
</span><span class='line'># fastboot protocol on manta (Nexus 10)
</span><span class='line'>SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4ee0", MODE="0600", OWNER="ubuntu"
</span></code></pre></td></tr></table></div></figure>


<h3>Building</h3>

<h4>Enable git proxy</h4>

<p>Configure the git configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ubuntu@Ubuntu_Container:~$ git config --global user.email "xxx@gmail.com"
</span><span class='line'>ubuntu@Ubuntu_Container:~$ git config --global user.name "xxx"
</span></code></pre></td></tr></table></div></figure>


<p>Compile the connect.c for getting the cross-firewall tool.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ gcc -o connect connect.c
</span><span class='line'>$ sudo mv connect /usr/bin
</span><span class='line'>$ sudo chmod  777 /usr/bin/connect
</span><span class='line'>$ cat /usr/bin/myproxy 
</span><span class='line'>/usr/bin/connect -H 127.0.0.1:9001 $@
</span><span class='line'>$ sudo chmod 777 /usr/bin/myproxy
</span></code></pre></td></tr></table></div></figure>


<p>Let your git authenticated by github, please refers to the following article:  <br/>
<a href="http://kkkttt.github.io/blog/2014/10/14/verified-to-github/">http://kkkttt.github.io/blog/2014/10/14/verified-to-github/</a></p>

<p>Then add the proxy setting in .gitconfig:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[core]
</span><span class='line'>  gitproxy = /usr/bin/myproxy
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h4>Preparation</h4>

<p>Install repo:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   57  echo $PATH
</span><span class='line'>/home/ubuntu/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
</span><span class='line'>   58  curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
</span><span class='line'>   59  chmod a+x ~/bin/repo
</span></code></pre></td></tr></table></div></figure>


<p>Make a new directory for holding the source code:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir ~/code
</span><span class='line'>$ repo init -u https://android.googlesource.com/platform/manifest
</span></code></pre></td></tr></table></div></figure>


<p>sync the repository:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ repo sync
</span></code></pre></td></tr></table></div></figure>


<h4>Build</h4>

<p>Set the environment variables:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>. build/envsetup.sh
</span><span class='line'>lunch 
</span></code></pre></td></tr></table></div></figure>


<p>In lunch you could select whatever you like.  <br/>
Then make via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>make -j 8
</span></code></pre></td></tr></table></div></figure>


<p>Trouble-shooting:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Your version is: java version "1.7.0_65".
</span><span class='line'>The correct version is: Java SE 1.6.
</span></code></pre></td></tr></table></div></figure>


<p>Ok, we change the java version via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install software-properties-common
</span><span class='line'>$ sudo apt-get install python-software-properties
</span><span class='line'>Add the PPA:
</span><span class='line'>$ sudo add-apt-repository ppa:webupd8team/java
</span><span class='line'>Update the repo index:
</span><span class='line'>$ sudo apt-get update
</span><span class='line'>$ sudo apt-get install oracle-java6-installer
</span></code></pre></td></tr></table></div></figure>


<p>After installation, update the java version via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>$ sudo update-alternatives --config java
</span><span class='line'>[sudo] password for ubuntu: 
</span><span class='line'>There are 3 choices for the alternative java (providing /usr/bin/java).
</span><span class='line'>
</span><span class='line'>  Selection    Path                                            Priority   Status
</span><span class='line'>------------------------------------------------------------
</span><span class='line'>* 0            /usr/lib/jvm/java-6-oracle/jre/bin/java          1062      auto mode
</span><span class='line'>  1            /usr/lib/jvm/java-6-openjdk-amd64/jre/bin/java   1061      manual mode
</span><span class='line'>  2            /usr/lib/jvm/java-6-oracle/jre/bin/java          1062      manual mode
</span><span class='line'>  3            /usr/lib/jvm/java-7-openjdk-amd64/jre/bin/java   1051      manual mode
</span><span class='line'>
</span><span class='line'>Press enter to keep the current choice[*], or type selection number: 
</span></code></pre></td></tr></table></div></figure>


<p>Now you could run building.</p>

<h3>Trouble Shooting</h3>

<p>Build error:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>If you are building an old version of android probably youll have this error
</span><span class='line'>
</span><span class='line'>host C++: obbtool &lt;= frameworks/base/tools/obbtool/Main.cpp
</span><span class='line'>:0:0: error: _FORTIFY_SOURCE redefined [-Werror]
</span><span class='line'>:0:0: note: this is the location of the previous definition
</span><span class='line'>cc1plus: all warnings being treated as errors
</span><span class='line'>To fix this, edit build/core/combo/HOST_linux-x86.mk and replace:
</span><span class='line'>
</span><span class='line'>HOST_GLOBAL_CFLAGS += -D_FORTIFY_SOURCE=0
</span><span class='line'>with
</span><span class='line'>
</span><span class='line'>HOST_GLOBAL_CFLAGS += -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=0
</span><span class='line'>And thats it.
</span></code></pre></td></tr></table></div></figure>


<p>When you meet &ldquo;error: reference counts cannot be declared mutable&rdquo;, install gcc/g++ 4.4 and re-compiling.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install gcc-4.4 g++-4.4  g++-4.4-multilib gcc-4.4-multilib
</span><span class='line'>make CC=gcc-4.4 CXX=g++-4.4
</span></code></pre></td></tr></table></div></figure>


<p>View the CPU ranking:  <br/>
<img src="http://itianti.sinaapp.com/index.php/cpu" alt="http://itianti.sinaapp.com/index.php/cpu" /></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>490  Intel Core i5-2520M @ 2.50GHz    3537
</span><span class='line'>851   Intel Xeon 5160 @ 3.00GHz    2047
</span></code></pre></td></tr></table></div></figure>


<h3>View Result</h3>

<p>Since we use the remote machine, we have to enable the vncserver, first install it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get install vnc4server
</span></code></pre></td></tr></table></div></figure>


<p>Install lubuntu-desktop as the default X:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get install lubuntu-desktop
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/15/serial-port-on-bbb/">Serial Port on BBB</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-15T09:37:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:37 am</span></time>
        
         | <a href="/blog/2014/10/15/serial-port-on-bbb/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Serial Port Settings</h3>

<p>Use following settings for the serial monitor software:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>The default serial port settings for the board are:
</span><span class='line'>Baud 115,200
</span><span class='line'>Bits 8
</span><span class='line'>Parity N
</span><span class='line'>Stop Bits 1
</span><span class='line'>Handshake None
</span></code></pre></td></tr></table></div></figure>


<h3>Connection</h3>

<p>The serial port in BBB is listed as following:  <br/>
<img src="/images/BBBSerial.jpg" alt="/images/BBBSerial.jpg" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/14/verified-to-github/">Verified to Github</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-14T19:59:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>7:59 pm</span></time>
        
         | <a href="/blog/2014/10/14/verified-to-github/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>General Method</h3>

<p>When you were denied by github, use following method for get through:  <br/>
Generate the key-gen</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh-keygen
</span></code></pre></td></tr></table></div></figure>


<p>Then Creat the following files:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat /home/Trusty/.ssh/config
</span><span class='line'>Host github.com
</span><span class='line'>User xxx@xxx.com
</span><span class='line'>Hostname ssh.github.com
</span><span class='line'>PreferredAuthentications publickey
</span><span class='line'>IdentityFile ~/.ssh/id_rsa
</span><span class='line'>Port 443
</span></code></pre></td></tr></table></div></figure>


<p>Now use following command for setting the connection:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh -T git@github.com
</span></code></pre></td></tr></table></div></figure>


<h3>Under firewall</h3>

<p>First add the ~/.ssh/id_rsa.pub to the github&rsquo;s &ldquo;SSH keys&rdquo;.   <br/>
If your machine runs under the firewall, you have to do things like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh -L 2121:github.com:22 root@1xxx.xxx.xxx.158
</span></code></pre></td></tr></table></div></figure>


<p>Then in another terminal, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh -T git@localhost -p 2121
</span><span class='line'>Hi xxx! You've successfully authenticated, but GitHub does not provide shell access.
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/14/tips-for-deploying-archlinux-on-bbb/">Tips for Deploying ArchLinux on BBB</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-14T17:33:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>5:33 pm</span></time>
        
         | <a href="/blog/2014/10/14/tips-for-deploying-archlinux-on-bbb/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The detailed installation guideline could be found at:  <br/>
<a href="http://archlinuxarm.org/platforms/armv7/ti/beaglebone-black">http://archlinuxarm.org/platforms/armv7/ti/beaglebone-black</a></p>

<p>But while there are some tips in changing the uEnv.txt, to enable the boot from 2nd mmc partition. following is the configuration file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@alarm mnt]# cat uEnv.txt
</span><span class='line'>optargs=coherent_pool=1M
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>#u-boot eMMC specific overrides; Angstrom Distribution (BeagleBone Black) 2013-06-20
</span><span class='line'>kernel_file=zImage
</span><span class='line'>initrd_file=uInitrd
</span><span class='line'> 
</span><span class='line'>loadzimage=load mmc ${mmcdev}:${mmcpart} ${loadaddr} ${kernel_file}
</span><span class='line'>loadinitrd=load mmc ${mmcdev}:${mmcpart} 0x81000000 ${initrd_file}; setenv initrd_size ${filesize}
</span><span class='line'>loadfdt=load mmc ${mmcdev}:${mmcpart} ${fdtaddr} /dtbs/${fdtfile}
</span><span class='line'>#
</span><span class='line'> 
</span><span class='line'>console=ttyO0,115200n8
</span><span class='line'># If you want to boot from usb
</span><span class='line'>#mmcroot=/dev/sda1 ro
</span><span class='line'># If you want to boot from SD card
</span><span class='line'>mmcroot=/dev/mmcblk0p2 ro
</span><span class='line'>mmcrootfstype=ext4 rootwait fixrtc
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>Now reboot and then you could see the BBB runs into the ArchLinux.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/24">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/22">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/07/29/ubuntu1504-s-cobbler-server/">Ubuntu1504's Cobbler Server</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/29/trying-spacewalk/">Trying SpaceWalk</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/28/worktips-on-landscape/">WorkTips on LandScape</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/27/tips-on-packer/">Tips on Packer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/07/25/chromebook-kernel-issue/">Chromebook Kernel Issue</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>

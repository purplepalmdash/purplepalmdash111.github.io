
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="前面已经安装并配置了编译链和qemu，现在可以用qemu来模拟arm平台了。 1. Hello, Qemu! 输入下面的代码: hello.c - hello.c 1
2
3
4
5
6
#include&lt;stdio.h&gt;
int main()
{ printf(&quot;Hello &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/49">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/08/yong-qemumo-ni-arm-1/">用Qemu模拟ARM(1)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-08T10:45:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>8</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:45 am</span></time>
        
         | <a href="/blog/2013/07/08/yong-qemumo-ni-arm-1/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前面已经安装并配置了编译链和qemu，现在可以用qemu来模拟arm平台了。</p>

<p>1. Hello, Qemu!</p>

<p>输入下面的代码:</p>

<figure class='code'><figcaption><span>hello.c - hello.c </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include&lt;stdio.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello, Qemu!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>编译并运行:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ arm-none-linux-gnueabi-gcc -o hello hello.c -static
</span><span class='line'>$ qemu-arm ./hello
</span><span class='line'>$ file hello
</span><span class='line'>hello: ELF 32-bit LSB  executable, ARM, EABI5 version 1 (SYSV), \
</span><span class='line'> statically linked, for GNU/Linux 2.6.16, not stripped</span></code></pre></td></tr></table></div></figure>


<p>不加-static变量的话，运行时则需要使用-L选项链接到相应的运行库</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-arm -L /home/Trusty/CodeSourcery/\
</span><span class='line'>Sourcery_CodeBench_Lite_for_ARM_GNU_Linux/\
</span><span class='line'>arm-none-linux-gnueabi/libc/  ./hello_1 
</span><span class='line'>Hello, Qemu!
</span><span class='line'>$ file hello_1
</span><span class='line'>hello_1: ELF 32-bit LSB  executable, ARM, EABI5 version 1 (SYSV),\
</span><span class='line'> dynamically linked (uses shared libs), for GNU/Linux 2.6.16, not stripped</span></code></pre></td></tr></table></div></figure>


<p>动态编译和静态编译生成的文件大小差别：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -l -h
</span><span class='line'>total 656K
</span><span class='line'>-rwxr-xr-x 1 Trusty root 640K Jul  7 18:46 hello
</span><span class='line'>-rwxr-xr-x 1 Trusty root 6.6K Jul  7 18:48 hello_1</span></code></pre></td></tr></table></div></figure>


<h3>小插曲1：</h3>

<p>系统里安装了两套编译链arm-none-eabi-和arm-none-linux-eabi-,很容易让人混淆，可参考编译链的命名规则：</p>

<p>arch(架构)-vendor(厂商名)-(os(操作系统名)-)abi(Application Binary
Interface，应用程序二进制接口)</p>

<p>举例说明：</p>

<ul>
<li>x86_64-w64-mingw32 = x86_64 &ldquo;arch"字段 (=AMD64), w64 (=mingw-w64
是"vendor"字段), mingw32 (=GCC所见的win32 API)</li>
<li>i686-unknown-linux-gnu = 32位 GNU/linux编译链</li>
<li>arm-none-linux-gnueabi = ARM 架构, 无vendor字段, linux 系统, gnueabi ABI.</li>
<li>arm-none-eabi = ARM架构, 无厂商, eabi ABI(embedded abi)</li>
</ul>


<p>两种编译链的主要区别在于库的差别，前者没有后者的库多，后者主要用于在有操作系统的时候编译APP用的。前者不包括标准输入输出库在内的很多C标准库，适合于做面向硬件的类似单片机那样的开发。因而如果采用arm-none-eabi-gcc来编译hello.c会出现链接错误。</p>

<h3>小插曲2：</h3>

<p>qemu-arm和qemu-system-arm的区别：</p>

<ul>
<li>qemu-arm是用户模式的模拟器(更精确的表述应该是系统调用模拟器)，而qemu-system-arm则是系统模拟器，它可以模拟出整个机器并运行操作系统</li>
<li>qemu-arm仅可用来运行二进制文件，因此你可以交叉编译完例如hello
world之类的程序然后交给qemu-arm来运行，简单而高效。而qemu-system-arm则需要你把hello
world程序下载到客户机操作系统能访问到的硬盘里才能运行。</li>
</ul>


<p>2. 使用qemu-system-arm运行Linux内核</p>

<p>从www.kernel.org下载最新内核,而后解压</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ tar xJf linux-3.10.tar.xz
</span><span class='line'>$ cd linux-3.10
</span><span class='line'>$ make ARCH=arm versatile_defconfig
</span><span class='line'>$ make menuconfig ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi-</span></code></pre></td></tr></table></div></figure>


<p>上面的命令指定内核架构为arm，交叉编译链为arm-none-linux-gnueabi,
需要在make menuconfig弹出的窗口中选择到 “Kernel Features”, 激活“Use the ARM
EABI to compile the kernel”,
如果不激活这个选项的话，内核将无法加载接下来要制作的initramfs。</p>

<p>如果需要在u-boot上加载内核，就要编译为uImage的格式，uImage通过mkimage程序来压缩的，ArchLinux的yaourt仓库里可以找到这个包：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yaourt -S mkimage</span></code></pre></td></tr></table></div></figure>


<p>安装好mkimage后，开始编译内核，因为CPU有4核，所以开启了-j8选项以加速编译:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ make ARCH=arm CROSS_COMPILE=arm-none-linux-gnueabi- all -j8 uImage </span></code></pre></td></tr></table></div></figure>


<p>接下来我们可以在qemu-system-arm中测试我们的内核了</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-system-arm -M versatilepb -m 128M -kernel ./arch/arm/boot/uImage</span></code></pre></td></tr></table></div></figure>


<p>在弹出的窗口中可以内核运行到了kernel
panic状态，这是因为内核无法加载root镜像的缘故，我们将制作一个最简单的hello
world的文件系统，告知kernel运行之。</p>

<figure class='code'><figcaption><span>init.c - init.c </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>编译并制作启动镜像:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ arm-none-linux-gnueabi-gcc -o init init.c -static
</span><span class='line'>$ echo init |cpio -o --format=newc &gt; initramfs
</span><span class='line'>1280 blocks
</span><span class='line'>$ file initramfs 
</span><span class='line'>initramfs: ASCII cpio archive (SVR4 with no CRC)</span></code></pre></td></tr></table></div></figure>


<p>接下来我们回到编译目录下执行：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-system-arm -M versatilepb -kernel ./arch/arm/boot/uImage  -initrd
</span><span class='line'>../initramfs -serial stdio -append "console=tty1"</span></code></pre></td></tr></table></div></figure>


<p>这时候可以看到，kernel运行并在Qemu自带的终端里打印出"Hello World!&ldquo;。</p>

<p>如果我们改变console变量为ttyAMA0, 将在启动qemu-system-arm的本终端上打印出qemu的输出。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/07/qemukuai-su-shang-shou/">Qemu快速上手</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-07T15:19:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>3:19 pm</span></time>
        
         | <a href="/blog/2013/07/07/qemukuai-su-shang-shou/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1. 安装Qemu</p>

<p>ArchLinux的仓库里包含有qemu已编译好的包:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -Ss qemu
</span><span class='line'>extra/qemu 1.4.2-2 [installed]
</span><span class='line'>    A generic and open source processor emulator which achieves a good \
</span><span class='line'>emulation speed by using dynamic translation.
</span><span class='line'>$ pacman -S qemu</span></code></pre></td></tr></table></div></figure>


<p>会根据默认配置安装好几乎所有平台支持的Qemu.</p>

<p>或者你可以手动下载源码包进行编译:官方下载地址在<a href="http://wiki.qemu.org/Download">http://wiki.qemu.org/Download</a></p>

<p>安装完qemu后运行qemu-system-i386, 如果弹出窗口，则说明qemu安装正确。</p>

<p>2. 创建新虚拟机磁盘镜像</p>

<p>创建虚拟机的第一步是创建一个新的磁盘镜像，qemu提供了对多种磁盘镜像格式的支持，如raw、qcow2、qed、vdi等，qemu-img的帮助里介绍qcow2是最多才多艺(Versatile)的格式，支持压缩、加密等功能，还能最大程度节省磁盘空间。我们选择它来做磁盘镜像(Virtualbox可以直接读取qcow2格式的虚拟机镜像)。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-img create -f qcow2 ubuntu.qcow2 16G
</span><span class='line'>Formatting 'ubuntu.qcow2', fmt=qcow2 size=17179869184 encryption=off \
</span><span class='line'>cluster_size=65536 lazy_refcounts=off </span></code></pre></td></tr></table></div></figure>


<p>3. 启动并安装虚拟机:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-system-i386 -hda ubuntu.qcow2 -boot d -cdrom \
</span><span class='line'>./ubuntu-13.04-desktop-i386.iso -m 1024 -enable-kvm</span></code></pre></td></tr></table></div></figure>


<p>-boot d代表优先从光驱启动，对应的选项有a, b (软驱 1 和 2), c (硬盘优先), d (光盘优先), n-p(支持Etherboot的网卡1-4).</p>

<p>安装ubuntu的步骤很直观，这里就不用篇幅描述了。安装完毕后，使用下列命令启动安装好的虚拟机镜像</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-system-i386 -hda ubuntu.qcow2 -m 1024 -enable-kvm</span></code></pre></td></tr></table></div></figure>


<p>4. 配置虚拟机网络：</p>

<p>4.1 使用桥接网络</p>

<p>这种方法需要改动系统配置，使用bridge-utils来创建虚拟网卡和实际网卡之间的桥接。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -Ss bridge-utils
</span><span class='line'>core/bridge-utils 1.5-2
</span><span class='line'>    Utilities for configuring the Linux ethernet bridge
</span><span class='line'>$ pacman -S bridge-utils</span></code></pre></td></tr></table></div></figure>


<p>创建桥接设备(br0)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ modprobe bridge
</span><span class='line'>$ brctl addbr br0</span></code></pre></td></tr></table></div></figure>


<p>出现add bridge failed: Package not installed时的解决方法：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ brctl addbr br0
</span><span class='line'>add bridge failed: Package not installed
</span><span class='line'># 查看kernel中关于bridge配置选项
</span><span class='line'>$ zcat /proc/config.gz | grep CONFIG_BRIDGE=
</span><span class='line'>CONFIG_BRIDGE=m
</span><span class='line'># 查看是否存在ko文件
</span><span class='line'>$ ls /usr/lib/modules/`uname -r`/kernel/net/bridge
</span><span class='line'>bridge.ko.gz  netfilter
</span><span class='line'># 加载bridge内核模块
</span><span class='line'>$ modprobe bridge
</span><span class='line'># 检查内核模块是否被加载
</span><span class='line'>$ lsmod | grep ^bridge
</span><span class='line'>bridge                 93187  0 </span></code></pre></td></tr></table></div></figure>


<p>若modprobe bridge后lsmod看不到bridge模块，有可能是因为更新完系统安装到新的kernel version后没有重启，ArchLinux是一个非常激进的发行版，内核往往几天一升级，习惯休眠或长期不关机的用户可能会碰到这个问题。</p>

<p>检查bridge网络</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ brctl show br0
</span><span class='line'>bridge name   bridge id       STP enabled interfaces
</span><span class='line'>br0       8000.000000000000   no</span></code></pre></td></tr></table></div></figure>


<p>关于STP:
Spanning Tree Protocol (STP) is a Layer 2 protocol that runs on bridges and
switches. The specification for STP is IEEE 802.1D. The main purpose of STP is
to ensure that you do not create loops when you have redundant paths in your
network. Loops are deadly to a network.
生成树协议运行于bridge或交换机上，主要目的为确保在存在冗余路径时网络中不会生成回路，回路会造成网络的死循环。</p>

<p>用下列命令查看网口信息, 或者ifconfig -a直接查看也可:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ifconfig -s | awk '{print $1}' | grep -v "Iface\|lo"
</span><span class='line'>enp0s25</span></code></pre></td></tr></table></div></figure>


<p>将enp0s25加入到br0</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /sbin/ifconfig enp0s25 down
</span><span class='line'>$ /sbin/ifconfig enp0s25 0.0.0.0 promisc up
</span><span class='line'>$ brctl addif br0 enp0s25
</span><span class='line'>$ dhcpcd br0</span></code></pre></td></tr></table></div></figure>


<p>查看bridge端口信息,发现enp0s25已经被加入了br0：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ brctl show br0
</span><span class='line'>bridge name   bridge id       STP enabled interfaces
</span><span class='line'>br0       8000.c8cbb8b48913   no      enp0s25</span></code></pre></td></tr></table></div></figure>


<p>有关bridge网络的dhcp相关配置，可以参考<a href="http://Tomcat.no-ip.biz/blog/2013/07/07/archlinuxwang-luo-pei-zhi-wen-ti/">ArchLinux网络配置问题</a>。</p>

<p>创建qemu启动脚本:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /etc/qemu-ifup
</span><span class='line'>#!/bin/sh
</span><span class='line'>  
</span><span class='line'>echo "Executing /etc/qemu-ifup"
</span><span class='line'>echo "Bringing up $1 for bridged mode..."
</span><span class='line'>sudo /usr/bin/ip link set $1 up promisc on
</span><span class='line'>echo "Adding $1 to br0..."
</span><span class='line'>sudo /usr/bin/brctl addif br0 $1
</span><span class='line'>sleep 2</span></code></pre></td></tr></table></div></figure>


<p>更改脚本权限：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ chmod 750 /etc/qemu-ifup 
</span><span class='line'>$ chown -R root /etc/qemu-ifup 
</span><span class='line'>$ chgrp kvm /etc/qemu-ifup </span></code></pre></td></tr></table></div></figure>


<p>创建qemu结束脚本</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /etc/qemu-ifdown
</span><span class='line'>#!/bin/sh
</span><span class='line'> 
</span><span class='line'>echo "Executing /etc/qemu-ifdown"
</span><span class='line'>sudo /usr/bin/ip link set $1 down
</span><span class='line'>sudo /usr/bin/brctl delif br0 $1
</span><span class='line'>sudo /usr/bin/ip link delete dev $1</span></code></pre></td></tr></table></div></figure>


<p>更改脚本权限:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ chmod 750 /etc/qemu-ifdown 
</span><span class='line'>$ chown -R root /etc/qemu-ifdown 
</span><span class='line'>$ chgrp kvm /etc/qemu-ifdown </span></code></pre></td></tr></table></div></figure>


<p>添加当前用户到kvm用户组并在visudo中开放对应命令的权限：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ usermod -a -G kvm Trusty
</span><span class='line'>$ visudo
</span><span class='line'>Cmnd_Alias      QEMU=/usr/bin/ip,/usr/bin/modprobe,/usr/bin/brctl
</span><span class='line'>%kvm     ALL=NOPASSWD: QEMU</span></code></pre></td></tr></table></div></figure>


<p>建立run-qemu文件，并添加到系统路径中.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /bin/run-qemu
</span><span class='line'>#!/bin/bash
</span><span class='line'>USERID=`whoami`
</span><span class='line'>precreationg=$(/usr/bin/ip tuntap list | /usr/bin/cut -d: -f1 | /usr/bin/sort)
</span><span class='line'>sudo /usr/bin/ip tuntap add user $USERID mode tap
</span><span class='line'>postcreation=$(/usr/bin/ip tuntap list | /usr/bin/cut -d: -f1 | /usr/bin/sort)
</span><span class='line'>IFACE=$(comm -13 &lt;(echo "$precreationg") &lt;(echo "$postcreation"))
</span><span class='line'>
</span><span class='line'># This line creates a random mac address. The downside is the dhcp server will
</span><span class='line'>assign a different ip each time
</span><span class='line'>printf -v macaddr "52:54:%02x:%02x:%02x:%02x" $(( $RANDOM & 0xff)) $(( $RANDOM &
</span><span class='line'>0xff )) $(( $RANDOM & 0xff)) $(( $RANDOM & 0xff ))
</span><span class='line'># Instead, uncomment and edit this line to set an static mac address. The
</span><span class='line'>benefit is that the dhcp server will assign the same ip.
</span><span class='line'># macaddr='52:54:be:36:42:a9'
</span><span class='line'>  
</span><span class='line'>qemu-system-i386 -enable-kvm -net nic,macaddr=$macaddr -net tap,ifname="$IFACE"
</span><span class='line'>$*
</span><span class='line'>  
</span><span class='line'>sudo ip link set dev $IFACE down &&gt; /dev/null
</span><span class='line'>sudo ip tuntap del $IFACE mode tap &&gt; /dev/null 
</span><span class='line'>$ sudo chmod a+w /bin/run-qemu</span></code></pre></td></tr></table></div></figure>


<p>使用下列命令来运行qemu</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /bin/run-qemu -hda ./ubuntu.qcow2 -m 1024 -vga std</span></code></pre></td></tr></table></div></figure>


<p>运行多个run-qemu实例后的网络信息如下：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ifconfig -s
</span><span class='line'>Iface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
</span><span class='line'>br0       1500    70676      0      0 0         64334      0      0      0 BMRU
</span><span class='line'>enp0s25   1500   103814      0      0 0         75661      0      0      0 BMPRU
</span><span class='line'>lo       65536      983      0      0 0           983      0      0      0 LRU
</span><span class='line'>tap0      1500        3      0      0 0            11      0      0      0 BMPRU
</span><span class='line'>tap1      1500        3      0      0 0            11      0      0      0 BMPRU</span></code></pre></td></tr></table></div></figure>


<p>4.2 使用VDE(Virtual Distrubuted Ethernet)创建Qemu网络，这种方法无需改变系统配置。</p>

<p>有关VDE的配置可以参考前面写过的<a href="http://Tomcat.no-ip.biz/blog/2013/07/04/zai-centosshang-an-zhuang-ji-yu-qemude-xu-ni-ji/">在CentOS上安装基于Qemu的虚拟机</a>一文。</p>

<p>值得注意的是, vdeswitch和slirpvde都可以在ArchLinux的软件库中找到:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -Ss vde
</span><span class='line'>extra/vde2 2.3.2-4 [installed]
</span><span class='line'>    Virtual Distributed Ethernet for emulators like qemu</span></code></pre></td></tr></table></div></figure>


<p>使用VDE创建的网络对外是不可见的，它使用由slirpvde分配的dhcp地址，通常以10.0.0开头，VDE配置的网络也可以在VirtualBox中看到，VirtualBox中关于NAT的网络配置就是基于VDE的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/07/archlinuxwang-luo-pei-zhi-wen-ti/">ArchLinux DHCP配置问题</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-07T12:10:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:10 pm</span></time>
        
         | <a href="/blog/2013/07/07/archlinuxwang-luo-pei-zhi-wen-ti/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>安装完ArchLinux后，发现网卡无法从路由器通过dhcp得到地址，ArchLinux的dhcp客户端是dhcpcd,默认配置文件。路由器型号是TP-link WR340G v5, 2010年入手的。</p>

<p>手动调用dhcpcd时候发现LOG里有NAK消息爆出。</p>

<p>翻了下Arch的论坛，这个问题是由于dhcpcd的参数配置引发的，某些dhcpcd向路由器请求的参数无法得到而导致，个人觉得大约是WR340G版本够老，无法提供这些个参数。</p>

<h2>解决方案一：</h2>

<p>编辑/etc/dhcpcd.conf， 注释掉classless_static_routes 和 interface_mtu即可:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># option classless_static_routes
</span><span class='line'>
</span><span class='line'># Respect the network MTU.
</span><span class='line'># option interface_mtu</span></code></pre></td></tr></table></div></figure>


<p>而后我们可以用systemd在每次启动的时候自动调用dhcpcd绑定地址:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ systemctl enable dhcpcd@enp0s25
</span><span class='line'>$ systemctl start dhcpcd@enp0s25</span></code></pre></td></tr></table></div></figure>


<h2>解决方案二:</h2>

<p>安装dhclient:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -S dhclient
</span><span class='line'>$ dhclient enp0s25</span></code></pre></td></tr></table></div></figure>


<p>这种方法需要每次手动输入，不过我们可以使用netctl包来自动管理网络接口信息：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp /etc/netctl/examples/ethernet-dhcp /etc/netctl/ethernet-dhcp</span></code></pre></td></tr></table></div></figure>


<p>由netctl.profile查到指定dhcp客户端的字段，而后在/etc/netctl/ethernet-dhcp文件中添加：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>DHCPClient=dhclient
</span><span class='line'># !!! 别忘了修改dhcp侦听的设备地址：
</span><span class='line'># Interface=eth0
</span><span class='line'>Interface=enp0s25</span></code></pre></td></tr></table></div></figure>


<p>把ethernet-dhcp作为netctl的默认启动配置文件：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ netctl enable ethernet-dhcp</span></code></pre></td></tr></table></div></figure>


<p>立即开启netctl:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ netctl start ethernet-dhcp</span></code></pre></td></tr></table></div></figure>


<p>查看netctl服务运行情况，我的网络是桥接的，和依据上面步骤配出来的字段会有所不同</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ systemctl list-units -t service | grep netctl
</span><span class='line'>netctl@bridge.service        loaded active exited  Example Bridge connection</span></code></pre></td></tr></table></div></figure>


<p>如果切换了网络环境，例如如果在待机唤醒时处于另一网络中，则需要用下列命令重新配置网络:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ netctl restart ethernet-dhcp</span></code></pre></td></tr></table></div></figure>


<p>两种方法各有千秋，前者比较灵活，但是遇到复杂网络配置的时候可能会很棘手，譬如多网卡/桥接等模型时容易把人弄晕。后者配置选项很多，但一劳永逸。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/06/archlinuxshang-an-zhuang-armbian-yi-lian/">ArchLinux上安装arm编译链</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-06T20:14:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:14 pm</span></time>
        
         | <a href="/blog/2013/07/06/archlinuxshang-an-zhuang-armbian-yi-lian/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在X86_64的ArchLinux上安装Mentor Graphics提供的arm交叉编译链时出现下列问题：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./arm-2013.05-23-arm-none-eabi.bin 
</span><span class='line'>Checking for required programs: awk grep sed bzip2 gunzip
</span><span class='line'>===============================================================
</span><span class='line'>Error: Missing 32-bit libraries on 64-bit Linux host
</span><span class='line'>===============================================================
</span><span class='line'>Your 64-bit Linux host is missing the 32-bit libraries
</span><span class='line'>required to install and use Sourcery CodeBench.</span></code></pre></td></tr></table></div></figure>


<p>解决方法：</p>

<p>编辑/etc/pacman.conf，去掉下列两行的注释</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[multilib]
</span><span class='line'>Include = /etc/pacman.d/mirrorlist</span></code></pre></td></tr></table></div></figure>


<p>而后安装必要的ia32相关的包：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -Sy
</span><span class='line'>$ pacman -S lib32-glibc
</span><span class='line'>$ pacman -S lib32-gtk lib32-gtk2</span></code></pre></td></tr></table></div></figure>


<p>安装好以后执行前面被中断的安装进程，这时候可以顺利安装了。</p>

<p>安装完毕后记得把交叉编译链的路径加入到系统路径中，最好在~/.bashrc里加上一笔:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export PATH=$HOME/CodeSourcery/Sourcery_CodeBench_Lite_for_ARM_EABI/bin:$PATH
</span><span class='line'>export PATH=$HOME/CodeSourcery/Sourcery_CodeBench_Lite_for_ARM_GNU_Linux/bin:$PATH</span></code></pre></td></tr></table></div></figure>


<p>ArchLinux的yaourt仓库里也有arm-none-eabi和arm-none-linux-eabi等交叉编译链，但是每次编译都会出现莫名其妙的错误，使用现成的编译链能大大节省开发时间。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/05/archlinuxchu-bu-pei-zhi-wang-luo/">ArchLinux初步配置网络</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-05T20:21:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:21 pm</span></time>
        
         | <a href="/blog/2013/07/05/archlinuxchu-bu-pei-zhi-wang-luo/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>刚安装好的ArchLinux上只有基本的系统组件，启动以后连ifconfig都没有（其实ifconfig早在N年前就被干掉，以ip命令代替了)。在这种一穷二白的情况下，如何配置好网络参数？下面的步骤可以让人一劳永逸。</p>

<p>1. 查看网络接口信息:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ip link show
</span><span class='line'>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT 
</span><span class='line'>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span><span class='line'>2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
</span><span class='line'>    link/ether 08:00:27:09:fd:b7 brd ff:ff:ff:ff:ff:ff
</span><span class='line'>可以看到enp0s3为有线端口，未启动，无地址无网关无路由。</span></code></pre></td></tr></table></div></figure>


<p>2. 启动网口：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ip link enp0s3 up</span></code></pre></td></tr></table></div></figure>


<p>3. 配置网卡地址:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ip addr add 192.168.1.133/24 broadcast 192.168.1.255 dev enp0s3</span></code></pre></td></tr></table></div></figure>


<p>参数解释：IP地址: 192.168.1.133, 广播地址:192.168.1.255</p>

<p>4. 配置默认路由为192.168.1.1:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ip default-gateway 192.168.1.1</span></code></pre></td></tr></table></div></figure>


<p>5. 查看接口信息:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#路由信息
</span><span class='line'>$ ip route show
</span><span class='line'>#地址信息
</span><span class='line'>$ ip addr show</span></code></pre></td></tr></table></div></figure>


<p>6. 添加dns解析信息:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /etc/resolv.conf</span></code></pre></td></tr></table></div></figure>


<p>输入ISP提供的dns服务器信息，例如:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nameserver 58.XXX.xx.xx
</span><span class='line'>nameserver 221.x.x.xx</span></code></pre></td></tr></table></div></figure>


<p>7. 安装net-tools，这里包含了ifconfig，终于可以不用忍受ip命令的折磨了。但是我记得看过一个高手的文章，他建议使用ip而不是使用陈旧的功能有限的ifconfig，高手开了个玩笑：“记住每次你敲ifconfig时，就会有一只无辜的小猫咪因为偷吃奶酪被击杀，可怜可怜小猫咪吧 :(”。虽然ifconfig很方便也是大多数教程里的常用配置，还是建议大家尽快适应繁琐的ip命令。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -S net-tools</span></code></pre></td></tr></table></div></figure>


<p>8. 安装dhcpcd并加入到系统启动项中:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pacman -S dhcpcd
</span><span class='line'># 临时启动dhcpcd
</span><span class='line'>$ systemctl start dhcpcd@enp0s3
</span><span class='line'># 将dhcpcd加入到启动项中
</span><span class='line'>$ systemctl enable dhcpcd@enp0s3</span></code></pre></td></tr></table></div></figure>


<p>现在重启机器，就可以从dhcp服务器自动获取地址并配置dns服务器等信息了。</p>

<p>9. 其他：</p>

<p>删除当前已经绑定的IP地址：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ip addr del 192.168.1.134/32 dev enp0s3</span></code></pre></td></tr></table></div></figure>


<p>若机器处于有防火墙的机器中，则需要配置好proxy信息才能正常使用网络，在命令行下，输入一下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ export http_proxy=http://ip_address:ip_port
</span><span class='line'>$ export https_proxy=http://ip_address:ip_port
</span><span class='line'>$ export ftp_proxy=http://ip_address:ip_port
</span><span class='line'>$ export ftps_proxy=http://ip_address:ip_port</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/05/zai-centosshang-an-zhuang-ji-yu-qemude-xu-ni-ji-2/">在CentOS上安装基于qemu的虚拟机(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-05T16:18:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>4:18 pm</span></time>
        
         | <a href="/blog/2013/07/05/zai-centosshang-an-zhuang-ji-yu-qemude-xu-ni-ji-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1. 启动完毕后客户机无法得到网络地址：</p>

<p>故事的小插曲：由于虚拟机是“偷”跑在某台服务器上，不便在系统路径里留下痕迹，只能使用CPU/内存资源，采取了挂载NFS文件系统的方法，Qemu和vde均自行编译，先于vde编译的Qemu在配置的时候未能激活vde选项，造成客户机中无法找到vde配置的网络。</p>

<p>现象:重新编译qemu,使用下列命令时报错：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./configure --prefix=Your_place_here --target-list="i386-softmmu \
</span><span class='line'>x86_64-softmmu  i386-linux-user x86_64-linux-user" --enable-kvm \
</span><span class='line'>--enable-user --enable-vde</span></code></pre></td></tr></table></div></figure>


<p>安装vde2到系统路径后重编译qemu成功。而后</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ export LD_LIBRARY_PATH=/usr/lib:$LD_LIBRARY_PATH</span></code></pre></td></tr></table></div></figure>


<p>则可正常启动vde/qemu</p>

<p>2. 开启Linux内核的forwarding, 这样客户机可以接入Internet.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo 1>/proc/sys/net/ipv4/ip_forward</span></code></pre></td></tr></table></div></figure>


<p>3. 增加更多的核:</p>

<p>在启动参数中添加:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-cpu host -smp cores=2,threads=1</span></code></pre></td></tr></table></div></figure>


<p>To be continued.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/05/linuxwang-ji-mi-ma-hou-shi-yong-grubzhong-zhi-mi-ma/">Linux忘记密码后使用grub重置密码</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-05T12:45:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>12:45 pm</span></time>
        
         | <a href="/blog/2013/07/05/linuxwang-ji-mi-ma-hou-shi-yong-grubzhong-zhi-mi-ma/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Linux忘记密码后，可以通过修改Grub启动参数来进行修复, 举Ubuntu13.04为例：</p>

<p>出现Grub菜单时，按"e"键或是其他键进入Grub的编辑方式。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>menuentry 'Ubuntu' --class ubuntu --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-baec278e-2b9f-4513-a6f1-e148ac6295d7' {
</span><span class='line'>recordfail
</span><span class='line'>  load_video
</span><span class='line'>  gfxmode $linux_gfx_mode
</span><span class='line'>  insmod gzio
</span><span class='line'>  insmod part_msdos
</span><span class='line'>  insmod ext2
</span><span class='line'>  set root='hd0,msdos2'
</span><span class='line'>  if [ x$feature_platform_search_hint = xy ]; then
</span><span class='line'>    search --no-floppy --fs-uuid --set=root --hint-bios=hd0,msdos2 --hint-efi=hd0,msdos2 --hint-baremetal=ahci0,msdos2  baec278e-2b9f-4513-a6f1-e148ac6295d7
</span><span class='line'>  else
</span><span class='line'>    search --no-floppy --fs-uuid --set=root baec278e-2b9f-4513-a6f1-e148ac6295d7
</span><span class='line'>  fi
</span><span class='line'>  linux   /boot/vmlinuz-3.8.0-19-generic root=UUID=baec278e-2b9f-4513-a6f1-e148ac6295d7 ro   
</span><span class='line'>  initrd  /boot/initrd.img-3.8.0-19-generic
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>改动下面这行</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>linux    /boot/vmlinuz-3.8.0-19-generic root=UUID=baec278e-2b9f-4513-a6f1-e148ac6295d7 ro</span></code></pre></td></tr></table></div></figure>


<p>为</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>linux    /boot/vmlinuz-3.8.0-19-generic root=UUID=baec278e-2b9f-4513-a6f1-e148ac6295d7 rw init=/bin/bash</span></code></pre></td></tr></table></div></figure>


<p>init=/bin/bash将把系统启动到一个没有root密码的shell, rw则允许修改密码，否则ro的情况下无法更新密码。</p>

<p>使用改动后的grub启动系统。在Grub2中一般是按F10, Grub中则是回车后按"b"键，具体需参考grub的帮助。</p>

<p>系统启动到shell后, 输入passwd username重设自己的密码后，reboot系统即可。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/04/zai-centosshang-an-zhuang-ji-yu-qemude-xu-ni-ji/">在CentOS上安装基于qemu的虚拟机</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-04T17:11:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>5:11 pm</span></time>
        
         | <a href="/blog/2013/07/04/zai-centosshang-an-zhuang-ji-yu-qemude-xu-ni-ji/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1. 从源码安装qemu和vde(Virtual Distributed Ethernet)
Qemu的安装过程比较标准，编译vde时则需要有些小改动:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ svn co https://vde.svn.sourceforge.net/svnroot/vde/trunk/vde-2 vde_svn
</span><span class='line'>$ cd vde_svn
</span><span class='line'>$ autoreconf -fi
</span><span class='line'>$ ./configure --enable-experimental --prefix=./Your_Destination
</span><span class='line'>$ make
</span><span class='line'>$ sudo make install</span></code></pre></td></tr></table></div></figure>


<p>在编译vde时，需要安装python-devel包并创建一个空的"stropts.h"文件才能通过编译:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yum install python-devel
</span><span class='line'>$ touch /usr/include/stropts.h</span></code></pre></td></tr></table></div></figure>


<p>2. 创建虚拟网络, 并使用slirpvde建立默认的dhcpd服务器:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vde_switch -s /tmp/switch
</span><span class='line'>$ slirpvde -s /tmp/switch --dhcp
</span><span class='line'>Starting slirpvde: virtual_host=10.0.2.2/24
</span><span class='line'>                   DNS         =10.0.2.3
</span><span class='line'>                   dhcp_start  =10.0.2.15
</span><span class='line'>                   vde switch  =/tmp/switch</span></code></pre></td></tr></table></div></figure>


<p>3. 创建qemu镜像并开始使用cdrom镜像安装系统:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-img create -f qcow2 Windows.qcow2 16G
</span><span class='line'>Formatting 'Windows.qcow2', fmt=qcow2 size=17179869184 encryption=off cluster_size=65536 lazy_refcounts=off 
</span><span class='line'>
</span><span class='line'># 使用创建的镜像安装系统 
</span><span class='line'>$ qemu-system-i386 -net nic,macaddr=52:54:00:00:EE:17 -net \
</span><span class='line'>vde,vlan=0,sock=/tmp/switch -m 765 -enable-kvm  -cdrom \
</span><span class='line'>/path_to_your_iso.iso  -boot d \
</span><span class='line'>/path_to_your_image/Windows.qcow2 -vga std -vnc :7</span></code></pre></td></tr></table></div></figure>


<p>4. 在本机上，可以使用vncviewer来查看安装情况：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vncviewer Your_server_ip:7</span></code></pre></td></tr></table></div></figure>


<p>5. 安装完毕后，启动创建好的虚拟机：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-system-i386 -net nic,macaddr=52:54:00:00:EE:17 -net \
</span><span class='line'>vde,vlan=0,sock=/tmp/switch -m 765 -enable-kvm  \
</span><span class='line'>-hda /path_to_your_image/Windows.qcow2 -vga std -vnc :7</span></code></pre></td></tr></table></div></figure>


<p>6. 指定物理网卡:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>model=? ,rtl8139可以被Windows自动驱动
</span><span class='line'>qemu-system-i386 -net nic,model=rtl8139,macaddr=52:54:00:00:EE:17 -net vde,sock=/tmp/switch -m 765 -enable-kvm -hda ./virt/Windows/Windows.qcow2 -vga std -vnc :7</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/03/markdownsyntax/">MarkdownSyntax</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-03T16:18:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2013</span></span> <span class='time'>4:18 pm</span></time>
        
         | <a href="/blog/2013/07/03/markdownsyntax/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1. 自动编号的问题:</p>

<p>Markdown里的自动编号只适用于块(block)中的自动编号，也就是说，在使用了例如Solarized格式化代码块以后，全局中的自动编号不再起作用。
正常的自动编号, 不会有问题, 前标号分别为1/2/3:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1. item 1
</span><span class='line'>2. item 2 
</span><span class='line'>3. item 3</span></code></pre></td></tr></table></div></figure>


<p>加入代码块后的情形:
 item 1/item 2/item 3都将以1. item开头, 前标号变成1/1/1:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1. item 1
</span><span class='line'>// code blocks
</span><span class='line'>2. item 2 
</span><span class='line'>// code blocks
</span><span class='line'>3. item 3</span></code></pre></td></tr></table></div></figure>


<p>解决方法：使用Markdown转义字符, 在.前加\</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1\. item 1
</span><span class='line'>2\. item 2 
</span><span class='line'>3\. item 3</span></code></pre></td></tr></table></div></figure>


<p>2. Solarized高亮代码的两种用法:</p>

<p>把代码放在如下块中:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//Your code here!
</span></code></pre></td></tr></table></div></figure>


<pre><code>或者

{% codeblock %}
//Your code here!
{% endcodeblock %}
</code></pre>

<p>代码高亮方法</p>

<p>a. 指定codeblock参数：</p>

<pre><code>{% codeblock hello.c - hello.c %} 
#include &lt;stdio.h&gt;
int main(void)
{
    printf("Hello World!\n");
    return 0;
}
{% endcodeblock %}
</code></pre>

<p>结果：</p>

<figure class='code'><figcaption><span>hello.c - hello.c </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'>
</span><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>b. 指定多行代码参数:</p>

<p>标题"Discover if a number is prime", 链接地址"<a href="http://...">http://...</a>&ldquo;, 链接名称"Source Article&rdquo;.</p>

<figure class='code'><figcaption><span>Discover if a number is prime</span><a href='http://www.noulakaz.net/weblog/2007/03/18/a-regular-expression-to-check-for-prime-numbers/'>Source Article</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Fixnum</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">prime?</span>
</span><span class='line'>    <span class="p">(</span><span class="s1">&#39;1&#39;</span> <span class="o">*</span> <span class="nb">self</span><span class="p">)</span> <span class="o">!~</span> <span class="sr">/^1?$|^(11+?)\1+$/</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>Discover if a number is prime</span><a href='http://www.noulakaz.net/weblog/2007/03/18/a-regular-expression-to-check-for-prime-numbers/'>Source Article</a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Fixnum</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">prime?</span>
</span><span class='line'>    <span class="p">(</span><span class="s1">&#39;1&#39;</span> <span class="o">*</span> <span class="nb">self</span><span class="p">)</span> <span class="o">!~</span> <span class="sr">/^1?$|^(11+?)\1+$/</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>3. Syntax Highlight 在 ArchLinux 上的问题：</p>

<p>因为ArchLinux默认的python版本是3, 导致pygments不能正确解析源文件，编辑：
    vim ~/.rvm/gems/ruby-1.9.3-p448/gems/pygments.rb-0.3.4/lib/pygments/mentos.py
    第一行
    /usr/bin/env python &ndash;> /usr/bin/env python2</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/07/03/yong-githubguan-li-octopressyuan-ma/">用github管理octopress源码</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-07-03T11:05:00+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2013</span></span> <span class='time'>11:05 am</span></time>
        
         | <a href="/blog/2013/07/03/yong-githubguan-li-octopressyuan-ma/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1. 新建或改变某个已存在的源码仓库名为"debian_octopress"，以后可以用<a href="https://github.com/kkkttt/debian_octopress.git">&ldquo;https://github.com/kkkttt/debian_octopress.git&rdquo;</a>来访问此仓库。</p>

<p>2. 配置Git:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git init
</span><span class='line'>$ git add README.md   # 这个文件中可以添些项目的描述文字
</span><span class='line'>$ git commit -m "First Commit"
</span><span class='line'># 配置git的本地用户名和email
</span><span class='line'>$ git config --global user.email "kkkttt@gmail.com"
</span><span class='line'>$ git config --global user.name "Trusty"
</span><span class='line'># 将文件夹里所有内容加入到git中并提交
</span><span class='line'>$ git add .
</span><span class='line'>$ git commit -m "First Sourcecode Commit"
</span><span class='line'># 同步到github
</span><span class='line'>$ git remote add origin https://github.com/kkkttt/debian_octopress.git
</span><span class='line'>$ git push -u origin master --force</span></code></pre></td></tr></table></div></figure>


<p>3. 删除本地文件夹并同步到Github的方法:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git rm -rf public.back
</span><span class='line'>$ git commit -m "remove backup directory"
</span><span class='line'>$ git push origin master</span></code></pre></td></tr></table></div></figure>


<p>4. 将本地修改同步到Github:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git commit -m "do some changes"
</span></code></pre></td></tr></table></div></figure>


<p>这时候会列出本地修改过的内容，运行:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git commit -a
</span></code></pre></td></tr></table></div></figure>


<p>修改需要提交的修改后运行下列命令后同步到Github:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git push origin master
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/48">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/23/import-more-isos-in-cobbler/">Import More ISOs in Cobbler</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/19/wh-worktips-5/">WH Worktips(5)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/19/wh-worktips-4/">WH Worktips(4)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/18/use-virtualenv-for-downloading-pip-packages/">Use VirtualEnv for Downloading PIP Packages</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/18/wh-worktips-3/">WH Worktips(3)</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>

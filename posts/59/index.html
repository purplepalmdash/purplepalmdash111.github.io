
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="There are following things to be done in recent days: Mp3 Player Effect. Algorithm in C. STM based example to Arduino in pure C. Music Emotions. PSP &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/59">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//fonts.googleapis.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/28/things-to-be-done-3/">Things to Be Done(3)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-28T08:05:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:05 am</span></time>
        
         | <a href="/blog/2013/10/28/things-to-be-done-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are following things to be done in recent days:</p>

<ul>
<li> Mp3 Player Effect.</li>
<li> Algorithm in C.</li>
<li> STM based example to Arduino in pure C.</li>
<li> Music Emotions.</li>
<li> PSP Like Player Effects.</li>
<li> 101 BASIC Games.</li>
<li> Pacman Games in C/Python, or other languages.</li>
<li> Bombing NJ Games.</li>
<li> Recording of the MP3 Shield.</li>
<li> SwitchOver in Awesome environments.</li>
<li> Lyrics player in Python.</li>
<li> Sweater icon in Weather and Atomosphere application.</li>
<li> RaspberryPI and enc28j60.</li>
<li> Cloud Statistics for PogoPlug data.</li>
<li> Generate a HardDisk usage report and draw pictures.</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/27/automatically-download-all-of-the-full-circle-magazine/">Automatically Download All of the Full-circle Magazine</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-27T20:48:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>8:48 pm</span></time>
        
         | <a href="/blog/2013/10/27/automatically-download-all-of-the-full-circle-magazine/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Following is a little script which could help you download all of the PDF version of the full-circle magazines:</p>

<figure class='code'><figcaption><span>autodownload.sh -autodownload.sh </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="nv">i</span><span class="o">=</span>0
</span><span class='line'><span class="k">for</span> i in <span class="o">{</span>0..78<span class="o">}</span>
</span><span class='line'><span class="k">do</span>
</span><span class='line'>  <span class="c">#echo $i</span>
</span><span class='line'>  <span class="nv">i</span><span class="o">=</span><span class="sb">`</span>expr <span class="nv">$i</span> + 1<span class="sb">`</span>
</span><span class='line'>  <span class="c">#http://dl.fullcirclemagazine.org/issue46_en.pdf</span>
</span><span class='line'>  <span class="nv">url</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;http://dl.fullcirclemagazine.org/issue&quot;</span><span class="nv">$i</span><span class="s2">&quot;_en.pdf&quot;</span><span class="sb">`</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="nv">$url</span>
</span><span class='line'>  wget <span class="nv">$url</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>


<p>If we change the url to CN version, then we can download all of the chinese version PDF:</p>

<figure class='code'><figcaption><span>autodownloadcn.sh -autodownloadcn.sh </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="nv">i</span><span class="o">=</span>0
</span><span class='line'><span class="k">for</span> i in <span class="o">{</span>0..47<span class="o">}</span>
</span><span class='line'><span class="k">do</span>
</span><span class='line'>  <span class="c">#echo $i</span>
</span><span class='line'>  <span class="nv">i</span><span class="o">=</span><span class="sb">`</span>expr <span class="nv">$i</span> + 1<span class="sb">`</span>
</span><span class='line'>  <span class="c">#http://dl.fullcirclemagazine.org/issue47_zh-CN.pdf</span>
</span><span class='line'>  <span class="nv">url</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="s2">&quot;http://dl.fullcirclemagazine.org/issue&quot;</span><span class="nv">$i</span><span class="s2">&quot;_zh-CN.pdf&quot;</span><span class="sb">`</span>
</span><span class='line'>  <span class="nb">echo</span> <span class="nv">$url</span>
</span><span class='line'>  wget <span class="nv">$url</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/27/bricked-actually-not/">Bricked? Actually Not.</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-27T13:05:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>1:05 pm</span></time>
        
         | <a href="/blog/2013/10/27/bricked-actually-not/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday I install wicd, a tool for automatically configure the wired and wireless network, but unfortuately it didn&rsquo;t act proper, then made my pogoplug into a brick-like equipment, I can only log into the terminal for less than 15 seconds, then I will lose the ssh connection. How to de-brick this equipment?</p>

<h3>Solution A</h3>

<p>In the 15 seconds living terminal, quickly input following command, this will remove the wicd and use the previous configuration of the network.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yes | apt-get remove wicd &</span></code></pre></td></tr></table></div></figure>


<p>You should wait for a long time, better longer than 5 mins, next time when you reboot into the system, it will recover to previous configuration.</p>

<h3>Solution B</h3>

<p>Use serial port.  <br/>
In this solution you will need a USB-TTL line to connect to pogoplug&rsquo;s serial port. Use serial port connection will not consider the network configuration. In the serial terminal, simply remove the installed wicd package is OK.</p>

<h3>Solution C</h3>

<p>Change the configuration of startup application.  <br/>
Navigate yourself to /etc/rc3.d/, you will see several links in this folder, change the S30wicd to K30wicd. <br/>
S mean service, while K means we disable this.    The names of these links all start as either K or S, followed by a number. If the name of the link starts with an S, then that indicates the service will be started when you go into that run level. If the name of the link starts with a K, the service will be killed (if running). <br/>
Reboot and then we will fall back to previous IP address again.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/26/wireless-on-pogoplug/">Wireless on PogoPlug</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-26T10:16:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:16 am</span></time>
        
         | <a href="/blog/2013/10/26/wireless-on-pogoplug/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Hardware Preparation</h3>

<p>Insert the usb wireless card and view the dmesg information:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ dmesg | tail
</span><span class='line'>[911884.740000] usb 1-1.3: USB disconnect, device number 4
</span><span class='line'>[911897.530000] usb 1-1.4: new high speed USB device number 5 using oxnas-ehci
</span><span class='line'>[911897.640000] usb 1-1.4: New USB device found, idVendor=0bda, idProduct=8179
</span><span class='line'>[911897.640000] usb 1-1.4: New USB device strings: Mfr=1, Product=2, SerialNumber=3
</span><span class='line'>[911897.650000] usb 1-1.4: Product: 802.11n NIC
</span><span class='line'>[911897.650000] usb 1-1.4: Manufacturer: Realtek
</span><span class='line'>[911897.660000] usb 1-1.4: SerialNumber: 00E04C0001
</span><span class='line'>The model is Mercury FW150US, See details of the lsusb
</span><span class='line'>$ lsusb -v -d 0bda:8179
</span><span class='line'>Bus 001 Device 005: ID 0bda:8179 Realtek Semiconductor Corp. 
</span><span class='line'>......</span></code></pre></td></tr></table></div></figure>


<p>But the output didn&rsquo;t show its information, we google it, knows: <br/>
只是一个8176和8179之分，后来才知道原来这款瑞昱的芯片有两个版本，8176对应的是rtl8192cu，8179对应的是rtl8188eu。 <br/>
8179 is the rtl8188eu, so we need to find rtl8188eu device driver.</p>

<h3>Driver Preparation</h3>

<p>Prepare the cross-compiler, download &ldquo;gcc-linaro-arm-linux-gnueabi-2012.02-20120222_linux.tar.bz2&rdquo;, uncompress it and add it into your system path.  <br/>
Prepare the Linux source code, named &ldquo;linux-3.1.10.pogoplug.tar.bz2&rdquo;, uncompress it.  <br/>
How do we get the cross-compiler version?</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /proc/version
</span><span class='line'>Linux version 3.1.10 (lintel@lintel-ThinkPad-T430) (gcc version 4.6.3 20120201 (prerelease) (Linaro GCC 4.6-2012.02) ) #10 SMP PREEMPT Fri Jun 7 19:14:08 CST 2013</span></code></pre></td></tr></table></div></figure>


<p>From the result, we know the cross-compiler is 4.6.3 version. <br/>
Download the corresponding cross-compiler and add it to the sytem path. Then we download the PogoPlug Linux Source, uncompress it and also get the rtl8188eu from <a href="https://github.com/Red54/linux-shumeipai2/tree/sunxi-3.0/drivers/net/wireless/rtl8188eu" title="GitHub Driver Download">https://github.com/Red54/linux-shumeipai2/tree/sunxi-3.0/drivers/net/wireless/rtl8188eu</a>, copy the rtl8188eu&rsquo;s driver under driver/net/wireless, then modify the Kconfig file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\+source "drivers/net/wireless/rtl8192cu/Kconfig"
</span><span class='line'>source "drivers/net/wireless/rtl8188eu/Kconfig"</span></code></pre></td></tr></table></div></figure>


<p>and also the Makefile:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>obj-$(CONFIG_RTL8192CU)  += rtl8192cu/
</span><span class='line'>\+obj-$(CONFIG_RTL8188EU)  += rtl8188eu/
</span><span class='line'>obj-$(CONFIG_IPW2100) += ipw2x00/
</span><span class='line'>obj-$(CONFIG_IPW2200) += ipw2x00/</span></code></pre></td></tr></table></div></figure>


<p>Then, we get the running kernel&rsquo;s configuration file via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /proc/config.gz | gunzip &gt;running.config</span></code></pre></td></tr></table></div></figure>


<p>upload the configuration file to the directory of the kernel source, then</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ export ARCH=arm
</span><span class='line'>$ export CROSS_COMPILE=arm-linux-gnueabi-
</span><span class='line'>$ make  ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- menuconfig
</span><span class='line'>in menuconfig, load the running.config, then navigate to driver-&gt;net-&gt;wireless, choose rtl8188eu's driver, compile it to kernel
</span><span class='line'>$ make  ARCH=arm CROSS_COMPILE=arm-linux-gnueabi-
</span><span class='line'>$ sudo yaourt mkimage
</span><span class='line'>Install mkimage, then go to arch/arm/boot
</span><span class='line'>$ mkimage -n 'linux-3.1.10' -A arm -O linux -T kernel -C none -a 0x60008000 -e 0x60008000 -d zImage uImage</span></code></pre></td></tr></table></div></figure>


<p>upload the generated uImage to pogoplug, then we have to update the kernel image into our own image</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Install mtd-utils first
</span><span class='line'>$ apt-get install mtd-utils
</span><span class='line'># Erase the mtd partition which contains existing kernel
</span><span class='line'>$ /usr/sbin/flash_erase /dev/mtd1 0xB00000 22
</span><span class='line'># Write newly generated uImage into the mtd partition
</span><span class='line'>$ /usr/sbin/nandwrite -p -s 0xB00000 /dev/mtd1 /root/uImage   </span></code></pre></td></tr></table></div></figure>


<p>Reboot the pogoplug.</p>

<h3>Wireless Configuration</h3>

<p>On pogoplug, install following software:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ apt-get install iw wireless-tools </span></code></pre></td></tr></table></div></figure>


<p>Use wpa_supplicant to generate the configuraiton file and generate the password</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf
</span><span class='line'>wpa_passphrase NETGEAR79 xxxxxx &gt; /etc/wpa_supplicant/NETGEAR79.conf</span></code></pre></td></tr></table></div></figure>


<p>With the generated file we can directly connect to the exisint wireless network. <br/>
Then we have to update the network configration file,</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /etc/network/interfaces
</span><span class='line'>auto lo eth0
</span><span class='line'>iface lo inet loopback
</span><span class='line'>iface eth0 inet dhcp
</span><span class='line'>
</span><span class='line'>auto wlan0
</span><span class='line'>allow-hotplug wlan0
</span><span class='line'>iface wlan0 inet dhcp
</span><span class='line'>wpa-conf /etc/wpa_supplicant/NETGEAR79.conf</span></code></pre></td></tr></table></div></figure>


<p>After everything is done, we can remove the wired connection, and change the wired-bind ip address to wireless binded ip address, everything will be the same as before. But the bootup may be 1 or 2 seconds than the wired connection.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/26/things-to-be-done-2/">Things to Be Done(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-26T06:55:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>6:55 am</span></time>
        
         | <a href="/blog/2013/10/26/things-to-be-done-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Following things got to be done in recent days:</p>

<ul>
<li>Try different distribution and found the difference and package differences between them(edubuntu, opensuse, fedora, etc).</li>
<li>Django/mezzanine, and other python based web development framework.</li>
<li>Write your own django based or mezzenine based blog/CMS.</li>
<li><strong>Repair my own computer, and run some cloud on it. </strong></li>
<li><strong>Pogoplug own kernel image compilation. </strong></li>
<li>RaspberryPI own distribution developement.</li>
<li><strong>Download all of the Full Circle using my own script, use it for practicing programming skills. </strong></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/25/using-wicd-with-awesome/">Using Wicd With Awesome</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-25T16:05:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>4:05 pm</span></time>
        
         | <a href="/blog/2013/10/25/using-wicd-with-awesome/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Install packages</h3>

<p>Install the following packages</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S wicd
</span><span class='line'>$ sudo pacman -S wicd-gtk
</span><span class='line'>$ sudo pacman -S notification-daemon
</span><span class='line'>$ sudo pacman -S python2-notify</span></code></pre></td></tr></table></div></figure>


<h3>Configure</h3>

<p>Add your account to users group</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># gpasswd -a USERNAME users</span></code></pre></td></tr></table></div></figure>


<p>Start Wicd as System Service:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ systemctl start wicd.service</span></code></pre></td></tr></table></div></figure>


<p>Automatically start service at boot-up:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ systemctl enable wicd.service</span></code></pre></td></tr></table></div></figure>


<p>Add the wicd-client as tray in the rc.lua file</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wicd-client --tray</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/25/use-xapian-for-creating-a-local-search-engine/">Use Xapian for Creating a Local Search Engine</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-25T14:22:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>2:22 pm</span></time>
        
         | <a href="/blog/2013/10/25/use-xapian-for-creating-a-local-search-engine/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Install Xapian-core</h3>

<p>Xapian-core is the Xapian library itself. We have to install it from source-code</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://oligarchy.co.uk/xapian/1.2.15/xapian-core-1.2.15.tar.gz
</span><span class='line'>$ tar xzvf xapian-core-1.2.15.tar.gz && cd xapian-core-1.2.15/
</span><span class='line'>$ ./configure --prefix=/usr/local && make && make install</span></code></pre></td></tr></table></div></figure>


<h3>Install Omega</h3>

<p>Omega utilities is an application built on Xapianm, consisting of indexers and a CGI search frontend.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://oligarchy.co.uk/xapian/1.3.1/xapian-omega-1.3.1.tar.gz
</span><span class='line'>$ tar xzvf xapian-omega-1.3.1.tar.gz &&  cd xapian-omega-1.3.1/
</span><span class='line'>$ ./configure --prefix=/usr/local && make && make install</span></code></pre></td></tr></table></div></figure>


<h3>Configure the CGI for apache</h3>

<p>Change the &ldquo;ScriptAlias /cgi-bin/ &rdquo;/usr/lib/cgi-bin/&ldquo;&rdquo;, so the httpd knows cgi binaries is put in the /usr/lib/cgi-bin directory. Then we have to copy the omega library to the /usr/lib/cgi-bin/:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd xapian-omega-1.3.1/
</span><span class='line'>$ cp omega /usr/lib/cgi-bin/omega.cgi
</span><span class='line'>$ cp omega.conf /usr/lib/cgi-bin/
</span><span class='line'>$ chmod 755 /usr/lib/cgi-bin/omega.cgi</span></code></pre></td></tr></table></div></figure>


<p>The Configuration file /usr/lib/cgi-bin/omega.conf should looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>database_dir /var/lib/omega/data
</span><span class='line'>template_dir /var/lib/omega/templates
</span><span class='line'>log_dir /var/log/omega
</span><span class='line'>cdb_dir /var/lib/omega/cdb</span></code></pre></td></tr></table></div></figure>


<p>Copy the templates to the new directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd xapian-omega-1.3.1/
</span><span class='line'>$ cp -ar /templates/* /var/lib/omega/templates/
</span><span class='line'>$ mkdir -p /var/lib/omega/data/default
</span><span class='line'>$ chmod -R 644 /var/lib/omega/data/default</span></code></pre></td></tr></table></div></figure>


<p>Generate the database file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo /usr/local/bin/omindex --db /var/lib/omega/data/default --url / /home/Trusty/code/octo/debian_octopress/public/</span></code></pre></td></tr></table></div></figure>


<h3>Result</h3>

<p>Restart the httpd daemon:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ systemctl restart httpd</span></code></pre></td></tr></table></div></figure>


<p>Browser <a href="http://localhost/cgi-bin/omega.cgi">http://localhost/cgi-bin/omega.cgi</a> you will see the following picture:</p>

<p><img src="/images/xapian.jpg" alt="/images/xapian.jpg" /></p>

<p><img src="/images/xapian.jpg" title="xapian" alt="Alt text" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/24/run-mini-snmpd-on-openwrt/">Run Mini_snmpd on OpenWRT</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-24T10:49:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:49 am</span></time>
        
         | <a href="/blog/2013/10/24/run-mini-snmpd-on-openwrt/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>OpenWRT Configuration</h3>

<p>Install mini_snmpd:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ opkg update
</span><span class='line'>$ opkg install mini-snmpd</span></code></pre></td></tr></table></div></figure>


<p>Configure mini_snmpd: mainly changes: option enabled 1, then change the option contact and location. But infact we can only fetch list interfaces in cacti:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@OpenWrt:~# cat /etc/config/mini_snmpd 
</span><span class='line'>config mini_snmpd
</span><span class='line'>  option enabled 1
</span><span class='line'>  option ipv6 0
</span><span class='line'>  option community 'public'
</span><span class='line'>  option contact 'gwoguowug@gmail.com'
</span><span class='line'>  option location 'Asia/China/Nanjing'
</span><span class='line'>
</span><span class='line'>  # enable basic disk usage statistics on specified mountpoint
</span><span class='line'>  list disks '/jffs'
</span><span class='line'>  list disks '/tmp'
</span><span class='line'>
</span><span class='line'>  # enable basic network statistics on specified interface
</span><span class='line'>  # 4 interfaces maximum, as named in /etc/config/network
</span><span class='line'>  list interfaces 'loopback'
</span><span class='line'>  list interfaces 'lan'
</span><span class='line'>  list interfaces 'wan'</span></code></pre></td></tr></table></div></figure>


<p>Restart the mini_snmpd:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /etc/init.d/mini_snmpd restart</span></code></pre></td></tr></table></div></figure>


<h3>Cacti Configuration</h3>

<p>Add a new device named OpenWRT, the configuration may like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Change the Host Template to Generic SNMP-enabled Host
</span><span class='line'>Downed Device Detection - Ping
</span><span class='line'>Ping Method - ICMP Ping</span></code></pre></td></tr></table></div></figure>


<p>Then you can add your own data sources, graph templates, new graph, new graph Trees, then display them. the picture may looks like as following:</p>

<p><img src="/images/Openwrt_cacti.jpg" title="OpenWRT cacti" alt="Alt text" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/23/add-optional-data-into-snmpd/">Add Optional Data Into Snmpd</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-23T19:25:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2013</span></span> <span class='time'>7:25 pm</span></time>
        
         | <a href="/blog/2013/10/23/add-optional-data-into-snmpd/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Prepare the script</h3>

<p>We get the current system load from /proc/loadavg:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@XXXyyy ~]$ cat /bin/online.sh
</span><span class='line'>#!/bin/sh
</span><span class='line'>echo .1.3.6.1.4.1.102.8
</span><span class='line'>cat /proc/loadavg | awk {'print $1'}</span></code></pre></td></tr></table></div></figure>


<p>Then we have to add this script to our /etc/snmp/snmpd.conf:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>extend .1.3.6.1.4.1.2021.53 online_monitor /bin/sh /bin/online.sh</span></code></pre></td></tr></table></div></figure>


<p>Restart the service:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>systemctl restart snmpd</span></code></pre></td></tr></table></div></figure>


<p>Use snmpwalk to view the newly added item:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>snmpwalk -v 2c -c public 10.0.0.221 .1.3.6.1.4.1.2021.53</span></code></pre></td></tr></table></div></figure>


<h3>Fetch the data</h3>

<p>See the following data is what we want:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@ubuntu:/etc# snmpwalk -v 2c -c public 10.0.0.221 .1.3.6.1.4.1.2021.53.4.1.2.14.111.110.108.105.110.101.95.109.111.110.105.116.111.114.2
</span><span class='line'>iso.3.6.1.4.1.2021.53.4.1.2.14.111.110.108.105.110.101.95.109.111.110.105.116.111.114.2 = STRING: "0.77"</span></code></pre></td></tr></table></div></figure>


<h3>Draw images in cacti</h3>

<p>First, add a data templates:<br/>
Console->Data Templates->Add, <br/>
Data Template Name: MonitorArchCustomized<br/>
Data Source Name: |host_description|-MonitorArchCustomized<br/>
Data Input Method: Get SNMP Data<br/>
Associated RRA&rsquo;s: Hourly(1 Minutes Average)<br/>
Internal Data Source Name: MonitorArchCustom<br/>
Then click &ldquo;Create&rdquo;<br/>
some additional field will be displayed, in the newly field &ldquo;Custom Data [data input: Get SNMP Data]&rdquo; insert the OID field with &ldquo;.1.3.6.1.4.1.2021.53.4.1.2.14.111.110.108.105.110.101.95.109.111.110.105.116.111.114.1&rdquo;(which you got from the snmpwalk output result)</p>

<p>Second, add a graph templates:<br/>
Templat Name: MonitorArchCustomized<br/>
Graph template Title: |host_description|-MonitorArchCustomized<br/>
Create and then insert the Graph Template Items, add like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Graph Item   Data Source     Graph Item Type     CF Type     Item Color
</span><span class='line'>Item # 1  (MonitorArchCustom):    AREA    AVERAGE         FF00FF  Move Down Move Up   Delete
</span><span class='line'>Item # 2  (MonitorArchCustom):    GPRINT  LAST        F5F800  Move Down Move Up   Delete
</span><span class='line'>Item # 3  (MonitorArchCustom): Average    GPRINT  AVERAGE         8D85F3  Move Down Move Up   Delete
</span><span class='line'>Item # 4  (MonitorArchCustom): MAX    GPRINT  MAX         005D57  Move Down Move Up   Delete</span></code></pre></td></tr></table></div></figure>


<p>Also notice the Data Source should be MonitorArchCustom.</p>

<p>Third, add a new graph under Host of ArchLinux.<br/>
Select the Graph template and then click Create.</p>

<p>After some minutes, you will see the newly captured data and the images under graphs-> Arch-> Host:ArchLinux. Maybe Your graphs trees are not the same as mine, you got found your own location.</p>

<p><img src="/images/cacti_image.jpg" title="cacti_image.jpg" alt="cacti_image" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/10/23/cacti-and-snmpd/">Cacti and Snmpd</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-10-23T14:57:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2013</span></span> <span class='time'>2:57 pm</span></time>
        
         | <a href="/blog/2013/10/23/cacti-and-snmpd/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On the machine being monitored, check the snmpd configuration file, you will find some items like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/snmp/snmpd.conf
</span><span class='line'>rocommunity public 
</span><span class='line'>rwcommunity admin
</span><span class='line'>agentaddress tcp:161
</span><span class='line'>If you want to enable Location and contact, add:
</span><span class='line'>syslocation Bat. C2
</span><span class='line'>syscontact someone@somewhere.org</span></code></pre></td></tr></table></div></figure>


<p>On the monitor PC, we can use following command to view the monitored machine&rsquo;s status:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ snmpwalk -c Trusty -v 2c 10.0.0.221:661
</span><span class='line'>or
</span><span class='line'>$ snmpwalk -c Trusty -v 2c 10.0.0.221</span></code></pre></td></tr></table></div></figure>


<h3>How to configure cacti</h3>

<p>Add a new device for monitoring: Console-> Management->Devices, add new, the configuration should like following:</p>

<p><img src="/images/cacti_configure.jpg" title="cacti configuration" alt="Alt text" /></p>

<p>After save, you should view the result displayed like:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ArchLinux (10.0.0.221) 
</span><span class='line'> SNMP Information
</span><span class='line'>System:Linux DashArch 3.11.6-1-ARCH #1 SMP PREEMPT Fri Oct 18 23:22:36 CEST
</span><span class='line'> 2013 x86_64
</span><span class='line'>Uptime: 1137 (0 days, 0 hours, 0 minutes)
</span><span class='line'>Hostname: DashArch
</span><span class='line'>Location: Unknown
</span><span class='line'>Contact: root@localhost</span></code></pre></td></tr></table></div></figure>


<h3>Draw disks</h3>

<p>Add following line into snmpd.conf</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>includeAllDisks</span></code></pre></td></tr></table></div></figure>


<p>But I failed, later will change.</p>

<h3>Add Graphs</h3>

<p>Click &ldquo;Create Graphs for this Host&rdquo;, then you will asked to add the graphs. <br/>
After you add the graphs, add a new graph trees. Then add a Tree Items, Parent -> [root] Tree Item Type &ndash;> Host, Host &ndash;> ArchLinux(10.0.0.221), then save.  <br/>
Now click on graphs, you can get your tree and view all of the images.</p>

<h3>Add Device for Winxp</h3>

<p>Install the snmp service under control pannel. <br/>
enable the snmp service in Administration tools -> Service. <br/>
In cacti, add a new equipment,  host templates choose &ldquo;Windows 2000/XP host&rdquo; , Downed Device Detection choose &ldquo;SNMP uptime&rdquo; , then add your own data source and graphics.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/60">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/58">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/04/06/tips-on-setup-eclipse-che/">Tips on Setup Eclipse CHE</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/05/extend-vagrants-disk/">Extend Vagrant's Disk</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/01/nodemcu-and-1602i2c-1/">NodeMCU and 1602I2C(1)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/31/nodemcu-and-1602i2c/">NodeMCU and 1602I2C</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/29/tips-on-shrinking-vhd-file/">Tips on Shrinking VHD File</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>


<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="Serial Port Support Enable the Device Driver&mdash;-> Character deivces &mdash;-> Serial drivers &mdash;-> Samsung related settings, My setting is &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/30">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//fonts.googleapis.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/25/linux2-dot-6-39-for-utu2440-2/">Linux2.6.39 for Utu2440(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-25T11:10:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>11:10 am</span></time>
        
         | <a href="/blog/2014/10/25/linux2-dot-6-39-for-utu2440-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Serial Port Support</h3>

<p>Enable the Device Driver&mdash;-> Character deivces &mdash;-> Serial drivers &mdash;-> Samsung related settings, My setting is listed as following:   <br/>
<img src="/images/serialport.jpg" alt="/images/serialport.jpg" />   <br/>
Then you will see serial output during kernel boot.</p>

<h3>DM9000 Support</h3>

<p>Add following code into the linux/arch/arm/mach-s3c2440/mach-smdk2440.c:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#include &lt;linux/serial_core.h&gt;
</span><span class='line'>+ /* Added dm9000 support for utu2400 */
</span><span class='line'>+ #include &lt;linux/dm9000.h&gt;
</span><span class='line'>#include &lt;linux/platform_device.h&gt;
</span><span class='line'>
</span><span class='line'>#include &lt;plat/common-smdk.h&gt;
</span><span class='line'>
</span><span class='line'>+ /* DM9000 Base address for SMDK2440 */
</span><span class='line'>+ #define MACH_SMDK2440_DM9K_BASE (S3C2410_CS3 + 0x300)
</span><span class='line'>
</span><span class='line'>static struct map_desc smdk2440_iodesc[] __initdata = {
</span><span class='line'>
</span><span class='line'>+ /* Added for dm9000 */
</span><span class='line'>+ static struct resource smdk2440_dm9k_resource[] = 
</span><span class='line'>+ {
</span><span class='line'>+     [0] = 
</span><span class='line'>+      {
</span><span class='line'>+           .start = MACH_SMDK2440_DM9K_BASE,
</span><span class='line'>+           .end   = MACH_SMDK2440_DM9K_BASE + 3,
</span><span class='line'>+           .flags = IORESOURCE_MEM
</span><span class='line'>+      },
</span><span class='line'>+     [1] = 
</span><span class='line'>+      {
</span><span class='line'>+           .start = MACH_SMDK2440_DM9K_BASE + 4,
</span><span class='line'>+           .end   = MACH_SMDK2440_DM9K_BASE + 7,
</span><span class='line'>+           .flags = IORESOURCE_MEM
</span><span class='line'>+      },
</span><span class='line'>+     [2] = 
</span><span class='line'>+     {
</span><span class='line'>+         .start = IRQ_EINT9,
</span><span class='line'>+         .end   = IRQ_EINT9,
</span><span class='line'>+         .flags = IORESOURCE_IRQ | IORESOURCE_IRQ_HIGHEDGE,
</span><span class='line'>+     }
</span><span class='line'>+ };
</span><span class='line'>+ 
</span><span class='line'>+ /*
</span><span class='line'>+  * The DM9000 has no eeprom, and it's MAC address is set by
</span><span class='line'>+  * the bootloader before starting the kernel.
</span><span class='line'>+  */
</span><span class='line'>+ static struct dm9000_plat_data smdk2440_dm9k_pdata = 
</span><span class='line'>+ {
</span><span class='line'>+     .flags        = (DM9000_PLATF_16BITONLY | DM9000_PLATF_NO_EEPROM),
</span><span class='line'>+ };
</span><span class='line'>+ 
</span><span class='line'>+ static struct platform_device smdk2440_device_eth = 
</span><span class='line'>+ {
</span><span class='line'>+     .name        = "dm9000",
</span><span class='line'>+     .id      = -1,
</span><span class='line'>+     .num_resources = ARRAY_SIZE(smdk2440_dm9k_resource),
</span><span class='line'>+     .resource  = smdk2440_dm9k_resource,
</span><span class='line'>+     .dev       = {
</span><span class='line'>+         .platform_data   = &smdk2440_dm9k_pdata,
</span><span class='line'>+     },
</span><span class='line'>+ };
</span><span class='line'>
</span><span class='line'>static struct platform_device *smdk2440_devices[] __initdata = {
</span><span class='line'>  &s3c_device_ohci,
</span><span class='line'>  &s3c_device_lcd,
</span><span class='line'>  &s3c_device_wdt,
</span><span class='line'>  &s3c_device_i2c0,
</span><span class='line'>  &s3c_device_iis,
</span><span class='line'>+     &smdk2440_device_eth,
</span><span class='line'>};
</span></code></pre></td></tr></table></div></figure>


<p>Then select the dm9000 support from:  <br/>
Device Driver&mdash;-> Network device support -> Ethernet(10 or 100Mbit) &mdash;-> DM9000 support   <br/>
Now testing the kernel, you will see the kernel starts with dm9000 support, thus we could use NFS for booting the system.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/24/python-call-system-command/">Python Call System Command</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-24T09:49:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>9:49 am</span></time>
        
         | <a href="/blog/2014/10/24/python-call-system-command/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Use Popen for running ls</h3>

<p>We could use following python scripts for running the bash command <code>ls -l</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt;&gt;&gt; from subprocess import *
</span><span class='line'>&gt;&gt;&gt; from subprocess import call
</span><span class='line'>&gt;&gt;&gt; from subprocess import Popen
</span><span class='line'>&gt;&gt;&gt; import subprocess
</span><span class='line'>&gt;&gt;&gt; ls_child = Popen(['ls', '-l'], stdout=subprocess.PIPE, stderr = subprocess.PIPE)
</span><span class='line'>&gt;&gt;&gt; ls_result = ls_child.communicate()
</span><span class='line'>&gt;&gt;&gt; print ls_result
</span><span class='line'>.......
</span></code></pre></td></tr></table></div></figure>


<p>The command I want to call is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sed -n 1~2p File_Name
</span></code></pre></td></tr></table></div></figure>


<p>This command will get the half of the file contents.</p>

<h3>Popen Wrapping</h3>

<p>The commands for canling sed is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt;&gt;&gt; sed_child = Popen(['sed', '-n', '1~2p', '/home/Trusty/code/mybash/rtp02_2014_10_23_03_23_36.txt'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
</span><span class='line'>&gt;&gt;&gt; sed_content = sed_child.communicate()
</span></code></pre></td></tr></table></div></figure>


<p>Judge the parameters:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt;&gt;&gt; command_line=raw_input()
</span><span class='line'> sed -n 1~2p /home/Trusty/code/mybash/rtp02_2014_10_23_03_23_36.txt 
</span><span class='line'>&gt;&gt;&gt; args=shlex.split(command_line)
</span><span class='line'>&gt;&gt;&gt; print args
</span></code></pre></td></tr></table></div></figure>


<p>Write the result into the file(half size as the origin input file), notice we remove the first 16 characters:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt;&gt;&gt; f_half = open("./half_result.txt", "w+")
</span><span class='line'>&gt;&gt;&gt; for line in sed_content:
</span><span class='line'>&gt;&gt;&gt;     f_half.write(line.replace(line[:16],''))
</span><span class='line'>&gt;&gt;&gt; f_half.close()
</span></code></pre></td></tr></table></div></figure>


<p>Then the file contains all of the content.</p>

<p>If we want to write into sorted result, then do following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt;&gt;&gt; lines=[]
</span><span class='line'>&gt;&gt;&gt; for line in sed_content:
</span><span class='line'>&gt;&gt;&gt;     lines.append(line.replace(line[:16], ''))
</span><span class='line'>&gt;&gt;&gt; lines.sort()
</span><span class='line'>&gt;&gt;&gt; f_half = open("./half_result.txt", "w+")
</span><span class='line'>&gt;&gt;&gt; for line in lines:
</span><span class='line'>&gt;&gt;&gt;     f_half.write(line)
</span><span class='line'>&gt;&gt;&gt; f_half.close()
</span></code></pre></td></tr></table></div></figure>


<h3>Remote Acticom machine script</h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/23/utu2400-s-kernel-drivers/">Utu2400's Kernel Drivers</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-23T10:32:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>10:32 am</span></time>
        
         | <a href="/blog/2014/10/23/utu2400-s-kernel-drivers/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>sshd replacement</h3>

<p>Since busybox enabled the telnetd by default, we could just use telnet for accessing the board.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@www ~]# ps -ef | grep telnet
</span><span class='line'>  861 root       0:00 /usr/sbin/telnetd -l /bin/login
</span><span class='line'>  893 root       0:00 grep telnet
</span></code></pre></td></tr></table></div></figure>


<h3></h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/22/enable-sshd-on-2440/">Enable Sshd on 2440</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-22T17:20:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>5:20 pm</span></time>
        
         | <a href="/blog/2014/10/22/enable-sshd-on-2440/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Package Preparation</h3>

<p>For openssh requires the following packages, first we have to download them all from internet.  <br/>
zlib, openssl, openssh.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://zlib.net/zlib-1.2.8.tar.gz
</span><span class='line'>$ wget https://www.openssl.org/source/openssl-0.9.8zc.tar.gz
</span><span class='line'>$ wget http://mirror.internode.on.net/pub/OpenBSD/OpenSSH/portable/openssh-6.7p1.tar.gz
</span></code></pre></td></tr></table></div></figure>


<h3>Building</h3>

<h4>Cross-compile zlib</h4>

<p>We have to manually change the following line in Makefile :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>LDSHARED=gcc -shared -Wl,-soname,libz.so.1,--version-script,zlib.map
</span><span class='line'>to
</span><span class='line'>LDSHARED=arm-linux-gcc -shared -Wl,-soname,libz.so.1,--version-script,zlib.map
</span></code></pre></td></tr></table></div></figure>


<p>Then:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./configure --prefix=/media/nfs/rootfs/usr/
</span><span class='line'>$ make CC=arm-linux-gcc AR=arm-linux-ar LD=arm-linux-ld
</span><span class='line'>$ make install
</span></code></pre></td></tr></table></div></figure>


<h4>Cross-compile openssh</h4>

<p>Get the openssl&rsquo;s configure help menus:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ./Configure --help
</span><span class='line'>Usage: Configure [no-&lt;cipher&gt; ...] [enable-&lt;cipher&gt; ...] [experimental-&lt;cipher&gt; ...] [-Dxxx] [-lxxx] [-Lxxx] [-fxxx] [-Kxxx] [no-hw-xxx|no-hw] [[no-]threads] [[no-]shared] [[no-]zlib|zlib-dynamic] [enable-montasm] [no-asm] [no-dso] [no-krb5] [386] [--prefix=DIR] [--openssldir=OPENSSLDIR] [--with-xxx[=vvv]] [--test-sanity] os/compiler[:flags]
</span></code></pre></td></tr></table></div></figure>


<p>Then configure the building via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./Configure --prefix=/media/nfs/rootfs/usr os/compiler:/opt/cross/arm-linux-gcc_4.3.2/bin/arm-linux-gcc
</span><span class='line'>$ make && make install
</span></code></pre></td></tr></table></div></figure>


<h4>Cross-compile openssh</h4>

<p>Configure the openssh via following command, the lib&rsquo;s directory should be adjust to previous installed directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /configure --host=arm-linux --with-libs --with-zlib=/media/nfs/rootfs/usr/ --with-ssl-dir=/media/nfs/rootfs/usr/ --disable-etc-default-login CC=/opt/cross/arm-linux-gcc_4.3.2/bin/arm-linux-gcc
</span></code></pre></td></tr></table></div></figure>


<p>Make but don&rsquo;t install.  <br/>
Install steps:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp sshd /media/nfs/rootfs/usr/local/sbin/
</span><span class='line'>$ cp scp sftp ssh ssh-add ssh-agent ssh-keygen ssh-keyscan /media/nfs/rootfs/usr/local/bin/
</span><span class='line'>$ cp sftp-server ssh-keysign /media/nfs/rootfs/usr/local/libexec/
</span></code></pre></td></tr></table></div></figure>


<p>In 2440 board, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@TrustyArch busybox-1.22.1]# mkdir -p /usr/local/etc/
</span><span class='line'>[root@TrustyArch busybox-1.22.1]# mkdir -p /var/run/
</span><span class='line'>[root@TrustyArch busybox-1.22.1]# mkdir -p /var/empty/sshd
</span><span class='line'>[root@TrustyArch busybox-1.22.1]# chmod 755 /var/empty
</span></code></pre></td></tr></table></div></figure>


<p>Generate the key files:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ssh-keygen -t rsa -f ssh_host_rsa_key -N ""
</span><span class='line'>$ ssh-keygen -t rsa1 -f ssh_host_key -N ""
</span><span class='line'>$ ssh-keygen -t dsa -f ssh_host_dsa_key -N ""
</span><span class='line'>$ cp ssh_host_dsa_key ssh_host_dsa_key.pub ssh_host_key ssh_host_key.pub ssh_host_rsa_key ssh_host_rsa_key.pub /media/nfs/rootfs/usr/local/etc/
</span></code></pre></td></tr></table></div></figure>


<p>Add lines into /etc/passwd and /etc/group in embedded system rootfs:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/passwd
</span><span class='line'>sshd:*:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
</span><span class='line'>$ cat /etc/group
</span><span class='line'>sshd:*:74:
</span></code></pre></td></tr></table></div></figure>


<p>Change the sshd_config file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp sshd_config /media/nfs/rootfs/usr/local/etc/
</span><span class='line'>$ vim /media/nfs/rootfs/usr/local/etc/sshd_config
</span><span class='line'>HostKey /usr/local/etc/ssh_host_key
</span><span class='line'>HostKey /usr/local/etc/ssh_host_rsa_key
</span><span class='line'>HostKey /usr/local/etc/ssh_host_dsa_key
</span><span class='line'>PermitRootLogin yes
</span><span class='line'>PermitEmptyPasswords yes
</span><span class='line'>UsePrivilegeSeparation no
</span><span class='line'>Subsystem sftp    /usr/local/libexec/sftp-server
</span></code></pre></td></tr></table></div></figure>


<p>Then start the sshd via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/usr/local/sbin/sshd
</span></code></pre></td></tr></table></div></figure>


<p>Good, we get segment fault, later will investigate this issue.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/21/install-openvpn-in-raspberrypi/">Install OpenVPN in RaspberryPI</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-21T20:35:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>8:35 pm</span></time>
        
         | <a href="/blog/2014/10/21/install-openvpn-in-raspberrypi/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Packages</h3>

<p>Raspberry PI runs ArchLinux, first install related packages.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S openvpn
</span><span class='line'>$ sudo pacman -S easy-rsa
</span><span class='line'>$ sudo pacman -S dnsmasq
</span></code></pre></td></tr></table></div></figure>


<p>openvpn is the OpenVPN&rsquo;s Kernel.  <br/>
easy-rsa is used for manage the keys.  <br/>
dnsmasq will acts like the domain name server.</p>

<h3>Configuration</h3>

<p>First Make the directory and copy the easy-rsa&rsquo;s files:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mkdir /etc/openvpn/easy-rsa
</span><span class='line'>[root@alarmpi ~]#  cp -r /usr/share/easy-rsa/* /etc/openvpn/easy-rsa
</span><span class='line'>[root@alarmpi ~]# ls /etc/openvpn/easy-rsa/
</span><span class='line'>build-ca  build-key-pkcs12  inherit-inter      sign-req
</span><span class='line'>build-dh  build-key-server  list-crl       vars
</span><span class='line'>build-inter   build-req     openssl-1.0.0.cnf  whichopensslcnf
</span><span class='line'>build-key build-req-pass    pkitool
</span><span class='line'>build-key-pass    clean-all     revoke-full
</span></code></pre></td></tr></table></div></figure>


<p>Now go and run easy-rsa:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@alarmpi ~]# cd /etc/openvpn/easy-rsa/
</span><span class='line'>[root@alarmpi easy-rsa]# source vars
</span><span class='line'>NOTE: If you run ./clean-all, I will be doing a rm -rf on /etc/openvpn/easy-rsa/keys
</span><span class='line'>[root@alarmpi easy-rsa]# ./clean-all 
</span><span class='line'>[root@alarmpi easy-rsa]# ./build-ca
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3>Generate the keys and certifications</h3>

<p>My name is <code>Trusty_delta</code>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@alarmpi easy-rsa]# sh build-key-server Trusty_delta
</span><span class='line'>[root@alarmpi easy-rsa]# ls keys/Trusty_*
</span><span class='line'>keys/Trusty_delta.crt  keys/Trusty_delta.csr  keys/Trusty_delta.key
</span></code></pre></td></tr></table></div></figure>


<h3>Diffie-Hellman Parameters</h3>

<p>This may takes extremely long time, especially on RaspberryPI, OMG&hellip;&hellip;.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@alarmpi easy-rsa]# sh build-dh 
</span><span class='line'># cd keys
</span><span class='line'># cp ca.crt delta.crt delta.key dh2048.pem /etc/openvpn
</span><span class='line'># cd ..
</span></code></pre></td></tr></table></div></figure>


<h3>Generate the private key</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># source vars
</span><span class='line'>NOTE:If you run ./clean-all, I will be doing a rm -rf on /etc/openvpn/easy-rsa/keys
</span><span class='line'>root@delta:/etc/openvpn/easy-rsa# ./build-key laptop
</span><span class='line'>Generating a 1024 bit RSA private key
</span></code></pre></td></tr></table></div></figure>


<p>The private key called &ldquo;laptop&rdquo; then we could make a directory for holding private keys and copy them into that directory.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mkdir ~/ovpn-client
</span><span class='line'># cp ca.crt laptop.crt laptop.key ~/ovpn-client
</span></code></pre></td></tr></table></div></figure>


<p>If you develier these 3 files to client, client could use them for connecting your VPN server.</p>

<h3>OpenVPN Server</h3>

<p>Copy the server.conf file into /etc/openvpn/:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd /usr/share/openvpn/examples/
</span><span class='line'># cp server.conf /etc/openvpn/Trusty_delta.conf
</span><span class='line'># vim Trusty_delta.conf
</span><span class='line'>cert delta.crt
</span><span class='line'>key delta.key
</span><span class='line'>dh dh2048.pem
</span><span class='line'>push "redirect-gateway def1"
</span><span class='line'>push "dhcp-option DNS 172.8.0.1"
</span></code></pre></td></tr></table></div></figure>


<p>Make service start automatically:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># systemctl start openvpn@Trusty_delta.conf
</span><span class='line'># systemctl enable openvpn@Trusty_delta.conf
</span></code></pre></td></tr></table></div></figure>


<p>Then we could test the vpn in other linux servers, using modified client.conf file.</p>

<h3>Check service</h3>

<p>Use netstat for check the status of openvpn server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>netstat -anp| grep openvpn
</span></code></pre></td></tr></table></div></figure>


<p>Following is directly copy from the ubuntu related.</p>

<h3>DNS Server</h3>

<p>Edit the dnsmasq.conf:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>listen-address = 127.0.0.1, 172.8.0.1
</span><span class='line'>bind-interfaces
</span></code></pre></td></tr></table></div></figure>


<p>Then restart the dnsmasq.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/21/make-videos-in-linux/">Make Videos in Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-21T16:03:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>4:03 pm</span></time>
        
         | <a href="/blog/2014/10/21/make-videos-in-linux/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Capture Window</h3>

<p>Sometimes we want to record the window operation, we could use <code>gtk-recordMyDesktop</code> for doing this.
Open the gtk-recordMyDesktop then select the window, start and it will automatically capture all of your input, and save it to ogg file.</p>

<h3>Add Background Music</h3>

<p>use Mencoder to add a mp3 file as the background of the captured video:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mencoder output.ogv -o video_final.ogv -ovc copy -oac copy -audiofile xxx.mp3
</span></code></pre></td></tr></table></div></figure>


<h3>Convert Video Formats</h3>

<p>Using mencoder for convert the ogv to mp4 file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ffmpeg -i output.ogv -vcodec libx264 -strict -2  output.mp4 
</span></code></pre></td></tr></table></div></figure>


<h3>7z for split</h3>

<p>Install 7zip, and use following command for split the big file into several 10M-size small files:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ 7z a -v10M output.7z output.mp4
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/20/quick-start-for-setting-up-wp-and-vpn-server-on-digitalocean/">Quick-start for Setting Up WP and VPN Server on DigitalOcean</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-20T20:32:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:32 pm</span></time>
        
         | <a href="/blog/2014/10/20/quick-start-for-setting-up-wp-and-vpn-server-on-digitalocean/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Prerequisite</h3>

<p>First you should check your Linux Version, for this tutorial is only works for ubuntu, that means, if you run archlinux/centos/debian on DigitalOcean, this tutorial won&rsquo;t be fit for your need.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@justfordemo:~# cat /etc/issue
</span><span class='line'>Ubuntu 14.04.1 LTS \n \l
</span></code></pre></td></tr></table></div></figure>


<p>Upgrade to the newest system via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@justfordemo:~# apt-get update && apt-get upgrade
</span></code></pre></td></tr></table></div></figure>


<p>Enter Y if system asks you to confirm.</p>

<h3>NGINX and PHP</h3>

<p>Following commands refers to:  <br/>
<a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-ubuntu-14-04">https://www.digitalocean.com/community/tutorials/how-to-install-linux-nginx-mysql-php-lemp-stack-on-ubuntu-14-04</a>  and <a href="https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-with-nginx-on-ubuntu-14-04">https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-with-nginx-on-ubuntu-14-04</a>.</p>

<h4>Install nginx</h4>

<p>Install the nginx server via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install nginx
</span></code></pre></td></tr></table></div></figure>


<p>Get the ip address via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ip addr show eth0 | grep inet | awk '{ print $2; }' | sed 's/\/.*$//'
</span><span class='line'>10.0.0.6
</span><span class='line'>fe80::a00:27ff:fe38:b7c5
</span></code></pre></td></tr></table></div></figure>


<p>Use you browser to visit <a href="http://10.0.0.6,">http://10.0.0.6,</a> you will see following page which indiciates the nginx works for you.    <br/>
<img src="/images/nginxworks.jpg" alt="/images/nginxworks.jpg" /></p>

<h4>Install mysql server</h4>

<p>Install it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get install mysql-server
</span></code></pre></td></tr></table></div></figure>


<p>When you see following window, choose your password(You should remember this password, for it&rsquo;s for administration!!!)  <br/>
<img src="/images/mysqlpasswd.jpg" alt="/images/mysqlpasswd.jpg" /></p>

<p>Then you should run following commands for install the database and enable secure installation. The suggested answer is listed as following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@justfordemo:~# mysql_install_db
</span><span class='line'>root@justfordemo:~# mysql_secure_installation 
</span><span class='line'>Change the root password? [Y/n] n
</span><span class='line'>Remove anonymous users? [Y/n] Y
</span><span class='line'>Disallow root login remotely? [Y/n] Y
</span><span class='line'>Remove test database and access to it? [Y/n] Y
</span><span class='line'>Reload privilege tables now? [Y/n] Y
</span></code></pre></td></tr></table></div></figure>


<h4>Install PHP</h4>

<p>Install php for processing:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install php5-fpm php5-mysql
</span></code></pre></td></tr></table></div></figure>


<p>Open the main php5-fpm configuration file with root privileges:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># nano /etc/php5/fpm/php.ini
</span></code></pre></td></tr></table></div></figure>


<p>Change</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>;cgi.fix_pathinfo=1
</span></code></pre></td></tr></table></div></figure>


<p>to</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cgi.fix_pathinfo=0
</span></code></pre></td></tr></table></div></figure>


<p>Save and restart the php5-fpm service:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># service php5-fpm restart
</span><span class='line'>php5-fpm stop/waiting
</span><span class='line'>php5-fpm start/running, process 15959
</span></code></pre></td></tr></table></div></figure>


<h4>Enable php prcessor in NGINX</h4>

<p>Change the configuration file /etc/nginx/sites-available/default:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>server {
</span><span class='line'>    listen 80 default_server;
</span><span class='line'>    listen [::]:80 default_server ipv6only=on;
</span><span class='line'>
</span><span class='line'>    root /usr/share/nginx/html;
</span><span class='line'>    index index.html index.htm;
</span><span class='line'>
</span><span class='line'>    server_name localhost;
</span><span class='line'>
</span><span class='line'>    location / {
</span><span class='line'>        try_files $uri $uri/ =404;
</span><span class='line'>    }
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>to</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>server {
</span><span class='line'>    listen 80 default_server;
</span><span class='line'>    listen [::]:80 default_server ipv6only=on;
</span><span class='line'>
</span><span class='line'>    root /usr/share/nginx/html;
</span><span class='line'>    index index.php index.html index.htm;
</span><span class='line'>
</span><span class='line'>    server_name server_domain_name_or_IP;
</span><span class='line'>
</span><span class='line'>    location / {
</span><span class='line'>        try_files $uri $uri/ =404;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    error_page 404 /404.html;
</span><span class='line'>    error_page 500 502 503 504 /50x.html;
</span><span class='line'>    location = /50x.html {
</span><span class='line'>        root /usr/share/nginx/html;
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>    location ~ \.php$ {
</span><span class='line'>        try_files $uri =404;
</span><span class='line'>        fastcgi_split_path_info ^(.+\.php)(/.+)$;
</span><span class='line'>        fastcgi_pass unix:/var/run/php5-fpm.sock;
</span><span class='line'>        fastcgi_index index.php;
</span><span class='line'>        include fastcgi_params;
</span><span class='line'>    }
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>Visit <a href="http://10.0.0.6/info.php">http://10.0.0.6/info.php</a>(assume our ipaddress is 10.0.0.6), then the picture may seems like following:   <br/>
<img src="/images/phprun.jpg" alt="/images/phprun.jpg" /></p>

<p>Now your webserver with php support is ready for use.</p>

<h3>Wordpress</h3>

<h4>Create MYSQL database and users</h4>

<p>The steps is quite simple, listed as following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@justfordemo:~# mysql -u root -p
</span><span class='line'>Enter password: 
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span><span class='line'>Your MySQL connection id is 48
</span><span class='line'>Server version: 5.5.40-0ubuntu0.14.04.1 (Ubuntu)
</span><span class='line'>
</span><span class='line'>Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved.
</span><span class='line'>
</span><span class='line'>Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.
</span><span class='line'>
</span><span class='line'>Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
</span><span class='line'>
</span><span class='line'>mysql&gt; CREATE DATABASE wordpress;
</span><span class='line'>Query OK, 1 row affected (0.00 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; CREATE USER wordpressuser@localhost IDENTIFIED BY 'password';
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; GRANT ALL PRIVILEGES ON wordpress.* TO wordpressuser@localhost;
</span><span class='line'>Query OK, 0 rows affected (0.00 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; FLUSH PRIVILEGES;
</span><span class='line'>Query OK, 0 rows affected (0.01 sec)
</span><span class='line'>
</span><span class='line'>mysql&gt; exit
</span><span class='line'>Bye
</span></code></pre></td></tr></table></div></figure>


<h4>Wordpress</h4>

<p>Download the latest wordpress installation file in home directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd ~
</span><span class='line'># wget http://wordpress.org/latest.tar.gz
</span></code></pre></td></tr></table></div></figure>


<p>Unzip the tar.gz file and install, but we have to install php-gd and libssh2-php first:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install php5-gd libssh2-php
</span><span class='line'># tar xzvf latest.tar.gz
</span><span class='line'># cd wordpress
</span><span class='line'># cp wp-config-sample.php wp-config.php
</span><span class='line'># nano wp-config.php
</span><span class='line'>. . .
</span><span class='line'>// ** MySQL settings - You can get this info from your web host ** //
</span><span class='line'>/** The name of the database for WordPress */
</span><span class='line'>define('DB_NAME', 'wordpress');
</span><span class='line'>
</span><span class='line'>/** MySQL database username */
</span><span class='line'>define('DB_USER', 'wordpressuser');
</span><span class='line'>
</span><span class='line'>/** MySQL database password */
</span><span class='line'>define('DB_PASSWORD', 'password');
</span><span class='line'>. . .
</span></code></pre></td></tr></table></div></figure>


<p>Make wordpress running directory and copy the source code here:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mkdir -p /var/www/html
</span><span class='line'># rsync -avP ~/wordpress/ /var/www/html/
</span><span class='line'># chown -R www-data:www-data /var/www/html/*
</span><span class='line'># cd /var/www/html/
</span><span class='line'>root@justfordemo:/var/www/html# mkdir wp-content/uploads
</span><span class='line'>root@justfordemo:/var/www/html# chown -R :www-data /var/www/html/wp-content/uploads
</span></code></pre></td></tr></table></div></figure>


<h4>Modify nginx blocks</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cp /etc/nginx/sites-available/default /etc/nginx/sites-available/wordpress
</span><span class='line'># nano /etc/nginx/sites-available/wordpress
</span><span class='line'>server {
</span><span class='line'>        listen 80 default_server;
</span><span class='line'>        listen [::]:80 default_server ipv6only=on;
</span><span class='line'>
</span><span class='line'>        root /var/www/html;
</span><span class='line'>        index index.php index.html index.htm;
</span><span class='line'>
</span><span class='line'>        server_name your_domain.com;
</span><span class='line'>
</span><span class='line'>        location / {
</span><span class='line'>                # try_files $uri $uri/ =404;
</span><span class='line'>                try_files $uri $uri/ /index.php?q=$uri&$args;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        error_page 404 /404.html;
</span><span class='line'>
</span><span class='line'>        error_page 500 502 503 504 /50x.html;
</span><span class='line'>        location = /50x.html {
</span><span class='line'>                root /usr/share/nginx/html;
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>        location ~ \.php$ {
</span><span class='line'>                try_files $uri =404;
</span><span class='line'>                fastcgi_split_path_info ^(.+\.php)(/.+)$;
</span><span class='line'>                fastcgi_pass unix:/var/run/php5-fpm.sock;
</span><span class='line'>                fastcgi_index index.php;
</span><span class='line'>                include fastcgi_params;
</span><span class='line'>        }
</span><span class='line'>}
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>Now restart the service via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ln -s /etc/nginx/sites-available/wordpress /etc/nginx/sites-enabled/
</span><span class='line'># service nginx restart
</span><span class='line'># service php5-fpm restart
</span></code></pre></td></tr></table></div></figure>


<p>Now visit: <br/>
<a href="http://10.0.0.6">http://10.0.0.6/</a> you will get the wordpress configuration window, Enjoy it!!!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/19/trouble-shooting-on-lxc-of-archlinux/">Trouble-Shooting on LXC of ArchLinux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-19T20:37:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:37 pm</span></time>
        
         | <a href="/blog/2014/10/19/trouble-shooting-on-lxc-of-archlinux/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I try to install ubuntu on ArchLinux using LXC, for the nfs server in ArchLinux seems forbidden the nfsv3&rsquo;s client request, but in my joggler(which runs 12.04 server) the nfs server works OK, so I installed this version for validation.</p>

<h3>Install method</h3>

<p>Install the ubuntu machine via following method:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>lxc-create -n Ubuntu_Container -t /usr/share/lxc/templates/lxc-ubuntu
</span></code></pre></td></tr></table></div></figure>


<h3>Trouble Shooting</h3>

<h4>qemu-debootstrap</h4>

<p>No debootstrap in Archlinux:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>which: no qemu-debootstrap in
</span></code></pre></td></tr></table></div></figure>


<p>Solution: create a soft link from debootstrap to qemu-debootstrap:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>lrwxrwxrwx 1 root root            11 Oct 19 20:13 qemu-debootstrap -&gt; debootstrap
</span></code></pre></td></tr></table></div></figure>


<h4>Keyrings</h4>

<p>No keyring file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>I: Keyring file not available at /usr/share/keyrings/ubuntu-archive-keyring.gpg;
</span></code></pre></td></tr></table></div></figure>


<p>directly copy one keyring file from installed ubuntu system to local machine.</p>

<h4>gpg Checking</h4>

<p>gpg1v for checking signature error:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Error executing gpg1v to check Release signature
</span></code></pre></td></tr></table></div></figure>


<p>Solution: use &ndash;no-check-gpg  <br/>
Edit the /usr/share/lxc/templates/lxc-ubuntu file, add &ndash;no-check-gpg after all of the debootstrap:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>debootstrap --arch=amd64 --verbose --no-check-gpg
</span></code></pre></td></tr></table></div></figure>


<p>Now everything should goes OK, and you could enjoy the ubuntu installed on your lxc container.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/18/embedded-environment-on-arch/">Embedded Environment on Arch</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-18T20:04:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:04 pm</span></time>
        
         | <a href="/blog/2014/10/18/embedded-environment-on-arch/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>NFS Server</h3>

<p>Server Setup</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S nfs-utils
</span><span class='line'>$ sudo vim /etc/idmapd.conf
</span><span class='line'>[General]
</span><span class='line'>
</span><span class='line'>#Verbosity = 0
</span><span class='line'>Verbosity = 1
</span><span class='line'>Pipefs-Directory = /var/lib/nfs/rpc_pipefs
</span><span class='line'>Domain = localdomain
</span><span class='line'>
</span><span class='line'>[Mapping]
</span><span class='line'>
</span><span class='line'>Nobody-User = nobody
</span><span class='line'>Nobody-Group = nobody
</span><span class='line'>
</span><span class='line'>$ sudo vim /etc/conf.d/nfs-common.conf
</span><span class='line'>STATD_OPTS="-p 32765 -o 32766 -T 32803"
</span><span class='line'>
</span><span class='line'>$ sudo vim  /etc/conf.d/nfs-server.conf
</span><span class='line'>MOUNTD_OPTS="-p 20048"
</span><span class='line'>
</span><span class='line'>$ sudo mkdir -p /srv/nfs4/music
</span><span class='line'>$ cat /etc/exports
</span><span class='line'>/srv/nfs4/ 10.0.0.0/24(rw,fsid=root,no_subtree_check)
</span><span class='line'>/srv/nfs4/music 10.0.0.0/24(rw,no_subtree_check,nohide) # note the nohide option which is applied to mounted directories on the file system.
</span><span class='line'>$ sudo exportfs -rav
</span><span class='line'>$ sudo systemctl restart nfs-server.service
</span></code></pre></td></tr></table></div></figure>


<p>Testing Server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo mount -t nfs 10.0.0.221:/srv/nfs4 /mnt
</span><span class='line'>$ ls /mnt
</span></code></pre></td></tr></table></div></figure>


<h3>tftpd Server</h3>

<p>Server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S tftp-hpa
</span><span class='line'>$ sudo vim /etc/systemd/system/tftpd.service
</span><span class='line'>[Unit]
</span><span class='line'>Description=hpa's original TFTP daemon
</span><span class='line'>
</span><span class='line'>[Service]
</span><span class='line'>ExecStart=/usr/sbin/in.tftpd -s /srv/tftp/
</span><span class='line'>StandardInput=socket
</span><span class='line'>StandardOutput=inherit
</span><span class='line'>StandardError=journal
</span><span class='line'>$ sudo systemctl start tftpd.socket
</span><span class='line'>$ sudo systemctl enable tftpd.socket
</span></code></pre></td></tr></table></div></figure>


<p>Client(10.0.0.230):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ tftp 10.0.0.221
</span><span class='line'>tftp&gt; get abc.txt
</span><span class='line'>tftp&gt; quit
</span><span class='line'>$ ls -l abc.txt
</span><span class='line'>-rw-r--r-- 1 root root 0 Oct 18 20:23 abc.txt
</span></code></pre></td></tr></table></div></figure>


<h3>NFS Servers(Easy)</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S nfs-utils
</span><span class='line'>$ cat /etc/exports
</span><span class='line'>/media/home/xxxx *(rw,sync,no_subtree_check)
</span><span class='line'>$ sudo systemctl enable rpcbind.service
</span><span class='line'>$ sudo systemctl start rpcbind.service
</span><span class='line'>$ sudo systemctl enable nfs-server.service
</span><span class='line'>$ sudo systemctl start nfs-server.service</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/10/18/linux-tips/">Linux Tips</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-18T19:21:00+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>7:21 pm</span></time>
        
         | <a href="/blog/2014/10/18/linux-tips/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>1. Know the System Installation Date</h3>

<p>You can use tune2fs to know the installation date of your Linux System, be ware the /dev/sda[] should be the root partition of your disk. See my following example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tune2fs -l /dev/sda1 or /dev/sdb1* | grep 'Filesystem created:'
</span><span class='line'>$ sudo tune2fs -l /dev/sda2  | grep 'Filesystem created:' 
</span><span class='line'>Filesystem created:       Mon May  5 17:31:40 2014
</span></code></pre></td></tr></table></div></figure>


<h3>2. View Thread Status</h3>

<p>View the thread status via proc filesystem.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ps -ef | grep conky
</span><span class='line'>Trusty      1396     1  0 19:15 ?        00:00:03 conky
</span><span class='line'>Trusty      7410  6161  0 19:23 pts/5    00:00:00 grep --color=always conky
</span><span class='line'>$ cd /proc/1396/task
</span><span class='line'>$ ls
</span><span class='line'>1396  1397  1398  1399  1400  1401  1402  1403
</span><span class='line'>$ cat 1396/status| grep "State"
</span><span class='line'>State:    S (sleeping)
</span></code></pre></td></tr></table></div></figure>


<h3>3. Write to other users</h3>

<p>Use w to get the tty, then write to other users.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@lilimarleen:/# w
</span><span class='line'> 00:47:04 up 28 min,  2 users,  load average: 0.00, 0.01, 0.02
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'>root     pts/0    1xx.xxx.xxx.xxx  00:26    0.00s  0.08s  0.00s w
</span><span class='line'>root     pts/2    18x.xxx.xxx.xx   00:40   32.00s  0.03s  0.03s -bash
</span><span class='line'>root@lilimarleen:/# echo "Hi, LiliMarleen"&gt;/dev/pts/2
</span><span class='line'>root@lilimarleen:/# echo "Do you have lunch"&gt;/dev/pts/2
</span></code></pre></td></tr></table></div></figure>


<h3>4. Share Terminals</h3>

<p>Make sure the screen command is available on your machine, then:  <br/>
Server side:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ screen -S share
</span></code></pre></td></tr></table></div></figure>


<p>Client side:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ screen -x share
</span></code></pre></td></tr></table></div></figure>


<p>Now both side input could be seen.</p>

<h3>5. Create xz file</h3>

<p>xz file will greatly decrease the file size, we use following command for create a xz file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tar cvfJ tar_xz_file.tar.xz folder_or_file
</span></code></pre></td></tr></table></div></figure>


<p>extract from xz from could be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tar -xJf tar_xz_file.tar.xz
</span></code></pre></td></tr></table></div></figure>


<h3>6. Login issue</h3>

<p>When you met</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>file /home/xxx/.Xauthority does not exist
</span></code></pre></td></tr></table></div></figure>


<p>simply run following command once you login:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ startx
</span></code></pre></td></tr></table></div></figure>


<p>Next time you won&rsquo;t met this complains.</p>

<h3>7. Execution priviledge</h3>

<p>Login to Opensuse, run ifconfig will complains it needs root priviledge:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Absolute path to 'ifconfig' is '/sbin/ifconfig', so running it may require superuser privileges (eg. root)
</span></code></pre></td></tr></table></div></figure>


<p>Simply add one line to the end of your ~/.bashrc file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export PATH=/sbin/:$PATH
</span></code></pre></td></tr></table></div></figure>


<p>Next time you could directly run <code>ifconfig</code>, or if you don&rsquo;t want to change your .bashrc file, do <code>/sbin/ifconfig</code>.</p>

<h3>8. Show history timestap</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@Linux01 ~]$  export HISTTIMEFORMAT="%F %T `whoami` "
</span><span class='line'>[Trusty@Linux01 ~]$ history | more
</span><span class='line'>    6  2014-10-29 03:33:01 Trusty ls | grep trb
</span><span class='line'>    7  2014-10-29 03:33:01 Trusty ./trbTest.py 
</span><span class='line'>    8  2014-10-29 03:33:01 Trusty history |grep export
</span><span class='line'>    9  2014-10-29 03:33:01 Trusty su root
</span></code></pre></td></tr></table></div></figure>


<h3>9. Vrome setting</h3>

<p>Chromium install the vrome then set the options of</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>set useletters=0
</span></code></pre></td></tr></table></div></figure>


<p>The keyshorts: go to address line Ctrl+L, in MAC Win+L.</p>

<h3>10. Replace the word until end of the line</h3>

<p>In vim by following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:%s/\&lt;foo\&gt;.*//
</span><span class='line'>On each line, delete the whole word "foo" and all following text (to end of line).
</span></code></pre></td></tr></table></div></figure>


<h3>11. Managing all of the running vagrants</h3>

<p>See following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@/media/y/Vagrant/vccw/myproxy/vccw-1.9.1]$ VBoxManage list runningvms
</span><span class='line'>"vccw-191_default_1417846604747_55987" {7b802d9e-dee2-4662-9694-e7cff6cbc49b}
</span><span class='line'>[Trusty@/media/y/Vagrant/vccw/myproxy/vccw-1.9.1]$ VBoxManage controlvm vccw-191_default_1417846604747_55987 savestate
</span><span class='line'>0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%
</span></code></pre></td></tr></table></div></figure>


<h3>12. Battery</h3>

<p>To know the current battery via acpi, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ acpi -b
</span></code></pre></td></tr></table></div></figure>


<p>To know the more detailed info of Battery, goto:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cd /sys/class/power_supply/BAT0
</span></code></pre></td></tr></table></div></figure>


<h3>13. Add arp entry</h3>

<p>So if you have rebooted the existing testing environment, your arp entries may be lost, simply use following command for adding it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ arp -s 192.168.1.10 00:01:02:03:04:05
</span></code></pre></td></tr></table></div></figure>


<p>Now you will directly reached 192.168.1.10 via the specified mac address.</p>

<h3>14. Enable opera proxy</h3>

<p>After Opera upgraded to latest version its configuration for proxy is failed, so I change the startup command from <code>opera</code> to:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ opera --proxy-server="socks://127.0.0.1:1395"
</span><span class='line'>$ alias opera='opera --proxy-server="socks://127.0.0.1:1395"'
</span></code></pre></td></tr></table></div></figure>


<h3>15. Delete a package and its configuration file</h3>

<p>Use <code>pacman -R --help</code> for more detailed infos, so remove the vagrant including its configuration will be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -R vagrant -n
</span></code></pre></td></tr></table></div></figure>


<h3>16. Install rar/unrar on CentOS</h3>

<p>Install the rar/unrar via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#  wget http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.i686.rpm
</span><span class='line'>#  sudo rpm -ivh rpmforge-release-0.5.2-2.el6.rf.i686.rpm
</span><span class='line'>#  sudo yum install rar unrar
</span></code></pre></td></tr></table></div></figure>


<p></p>

<h3>17. zsh History</h3>

<p>The default installed zsh has no history record, thus we have to enable the history via following setting:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ touch $HOME/.zsh_history
</span><span class='line'>$ tail ~/.zshrc
</span><span class='line'># For setting zsh history
</span><span class='line'>HISTFILE=$HOME/.zsh_history
</span><span class='line'>setopt INC_APPEND_HISTORY
</span><span class='line'>setopt SHARE_HISTORY
</span><span class='line'>HISTSIZE=5000
</span><span class='line'>SAVEHIST=5000
</span></code></pre></td></tr></table></div></figure>


<p>Now you will got the history recorded for 5000 lines, and each of them could be shared to each other.</p>

<h3>18. Calculate Code Lines</h3>

<p>We could use cloc for calculate the code lines. In Ubuntu, simply run following commands for installing cloc:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install cloc
</span></code></pre></td></tr></table></div></figure>


<p>cloc via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cloc Your_Source_Code_Directory
</span></code></pre></td></tr></table></div></figure>


<p>After a while your statistics result will be displayed on the screen.</p>

<h3>19. CMAKE prefix</h3>

<p>For specify the cmake&rsquo;s prefix we use following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr ./ && make && sudo make install
</span></code></pre></td></tr></table></div></figure>


<h3>20. xclip</h3>

<p>Sometimes we have to quickly redirect some output from the system output to system clipboard, we use xclip, add following alias to your ~/.bashrc or ~/.zshrc:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Alias the xclip for directly to my system buffer, thus we could use shift+insert for copy the content.
</span><span class='line'>alias myclip='xclip -selection clipboard'
</span></code></pre></td></tr></table></div></figure>


<h3>21. Virtualbox Fixed Address</h3>

<p>The host-only adapter should have the static addresses, thus you won&rsquo;t mix each other.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/network/interfaces
</span><span class='line'>auto eth1
</span><span class='line'>iface eth1 inet static
</span><span class='line'>    address 192.168.56.101
</span><span class='line'>    netmask 255.255.255.0
</span><span class='line'>    gateway 192.168.56.1
</span></code></pre></td></tr></table></div></figure>


<h3>22. Autologin Using ssh</h3>

<p>When you add the rsa content into the ~/.ssh/authorized_keys, but you still can&rsquo;t auto-login, then you have to consider the priviledge problem:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls ~/.ssh/authorized_keys  -l 
</span><span class='line'>-rw-r--r--. 1 Trusty Trusty 392 Feb 11 11:36 /home/Trusty/.ssh/authorized_keys
</span><span class='line'>$ chmod g-w ~/.ssh/authorized_keys
</span></code></pre></td></tr></table></div></figure>


<p>Now you could reach the machine without inputting password.</p>

<h3>23. Change Static Address For CentOS</h3>

<p>Change the following file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/sysconfig/network-scripts/ifcfg-eth*
</span><span class='line'>DEVICE=eth0 
</span><span class='line'>BOOTPROTO=none 
</span><span class='line'>ONBOOT=yes 
</span><span class='line'>NETWORK=10.0.1.0 
</span><span class='line'>NETMASK=255.255.255.0 
</span><span class='line'>IPADDR=10.0.1.27 
</span><span class='line'>USERCTL=no
</span></code></pre></td></tr></table></div></figure>


<p>Restart and then you could find your CentOS have static address.</p>

<h3>24. Disable Touchpad</h3>

<p>First use <code>xinput list</code> for list all of the input devices for X, then set the property of them via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ xinput list
</span><span class='line'> Virtual core pointer                          id=2    [master pointer  (3)]
</span><span class='line'>    Virtual core XTEST pointer                id=4    [slave  pointer  (2)]
</span><span class='line'>    Logitech USB Optical Mouse                id=9    [slave  pointer  (2)]
</span><span class='line'>    PS/2 Generic Mouse                        id=12   [slave  pointer  (2)]
</span><span class='line'>    SynPS/2 Synaptics TouchPad                id=13   [slave  pointer  (2)]
</span><span class='line'>
</span><span class='line'>......
</span><span class='line'>
</span><span class='line'>$ xinput set-prop 13 "Device Enabled" 0
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3>25. visudo</h3>

<p>Sometimes in the visudo we set NOPASSWD, but it didn&rsquo;t take effects, why? because you are belong to some groups, while these group rules overwrite the previous rules you set, simply change all of the corresponding rules to:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>NOPASSWD:ALL
</span></code></pre></td></tr></table></div></figure>


<p>Save the file and now you will see <code>sudo command</code> won&rsquo;t ask you input anything.</p>

<h3>26. Youtube download</h3>

<p>Ubuntu could directly download youtube videos via install youtube-dl:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install youtube-dl
</span></code></pre></td></tr></table></div></figure>


<h3>27. perl-rename</h3>

<p>As ArchLinux&rsquo;s default rename tool is very simple use following rename tools provided via perl:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pacman -S perl-rename
</span><span class='line'>$  vim ~/.zshrc
</span><span class='line'>### The default rename didn't support regex, use perl-rename instead.
</span><span class='line'>alias rename='perl-rename'
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<h3>28. udiskie</h3>

<p>udiskie is for automatically mount/umount usb disks, but the ubuntu won&rsquo;t support it in official repository, we could install it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pip install udiskie
</span></code></pre></td></tr></table></div></figure>


<p>mount and umount disks via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo udiskie-mount -a
</span><span class='line'>$ sudo udiskie-umount -a
</span></code></pre></td></tr></table></div></figure>


<h3>29. git merge conflicts</h3>

<p>Sometimes when you <code>git pull</code> from remote repository, you will got some anoying hint messages which shows you have merge conflicts, following is the steps for solving this issue:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git pull
</span><span class='line'>$ git stash
</span><span class='line'>$ git pull
</span></code></pre></td></tr></table></div></figure>


<p>Now you are ready to work under merged trees.</p>

<h3>30. Git remote repository</h3>

<p>When first git clone to local, then git push origin master, it will complains:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[Trusty@~/Code/herokublog]$ git push origin master
</span><span class='line'>fatal: remote error: 
</span><span class='line'>  You can't push to git://github.com/xxxx/herokublog.git
</span><span class='line'>  Use https://github.com/xxxx/herokublog.git
</span><span class='line'>[Trusty@~/Code/herokublog]$ ssh -T git@github.com
</span><span class='line'>X11 forwarding request failed on channel 0
</span><span class='line'>Hi xxxx! You've successfully authenticated, but GitHub does not provide shell access.
</span><span class='line'>[Trusty@~/Code/herokublog]$ git remote set-url origin git@github.com:xxxx/herokublog.git
</span></code></pre></td></tr></table></div></figure>


<p>After setting this, we could use <code>git push origin master</code> for submitting our changes.</p>

<h3>31. Replace all of the strings under one folder</h3>

<p>Simply use sed for replacing these strings:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Trusty@MassTestOnUbuntu1404:~/charms/trusty$ grep -rl "http://archive.ubuntu.com" ./ | wc -l
</span><span class='line'>3
</span><span class='line'>Trusty@MassTestOnUbuntu1404:~/charms/trusty$ grep -rl "http://archive.ubuntu.com" ./ | xargs sed -i 's|http://archive.ubuntu.com|http://http://mirrors.aliyun.com|g'
</span><span class='line'>Trusty@MassTestOnUbuntu1404:~/charms/trusty$ grep -rl "http://archive.ubuntu.com" ./ | wc -l
</span><span class='line'>0
</span><span class='line'>Trusty@MassTestOnUbuntu1404:~/charms/trusty$ grep -rl "http://mirrors" ./ | wc -l
</span><span class='line'>3
</span></code></pre></td></tr></table></div></figure>


<h3>32. Use local LXC repository</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>So, let's say you downloaded the ubuntu trusty amd64 tarballs, you need to do:
</span><span class='line'> - mkdir -p /var/cache/lxc/download/ubuntu/trusty/amd64/default/
</span><span class='line'> - copy rootfs.tar.xz in /var/cache/lxc/download/ubuntu/trusty/amd64/default/
</span><span class='line'> - unpack the content of meta.tar.xz in /var/cache/lxc/download/ubuntu/trusty/amd64/default/
</span><span class='line'> - Then run the download template with: -d ubuntu -r trusty -a amd64
</span></code></pre></td></tr></table></div></figure>


<h3>33. Use rsync for syncing the files</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rsync -e 'ssh -p 1234' username@hostname:SourceFile DestFile
</span><span class='line'>Example:    
</span><span class='line'>$ rsync -avH --progress '-e ssh -p 2223' Trusty@1xx.xxx.xxx.xxx:/home/Trusty/charms/trusty/ ~/charms/trusty/
</span></code></pre></td></tr></table></div></figure>


<h3>34. Use dmidecode to view your hardware configuration</h3>

<p>dmidecode is a tool-set for dump out your SMIBIOS configuration in readable format, use following command for readout the maximum support moemory of your system, and the already installed memory information on your system:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo dmidecode -t 16
</span><span class='line'>$ sudo dmidecode -t 17
</span></code></pre></td></tr></table></div></figure>


<h3>35. Use fslint for searching out the duplicated files</h3>

<p>fslint could search the directory and find out the duplicated files. <br/>
Install it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install fslint
</span><span class='line'>$ fslint-gui
</span></code></pre></td></tr></table></div></figure>


<h3>36. Limitation Bandwidth</h3>

<p>Use following command could limit the specified userspace programs' bandwidth:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ trickle -s -d 50 -w 100 firefox
</span><span class='line'>http://stackoverflow.com/questions/10328568/simulate-limited-bandwidth-from-within-chrome
</span></code></pre></td></tr></table></div></figure>


<h3>37. Grep with color</h3>

<p>grep&rsquo;s default output is without colorful output, do following for enable the colorful output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>alias grep='grep --color=always'
</span></code></pre></td></tr></table></div></figure>


<p>Add this into your .zshrc, so everytime it boots up the grep will output with colors.</p>

<h3>38. RaspberryPI items</h3>

<p>For optimize the RaspberryPI, need to do following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>relatime/atime, use relatime
</span><span class='line'>cat /sys/block/mmcblk0/queue/scheduler/
</span><span class='line'>noop deadline cfq
</span><span class='line'>use noop
</span><span class='line'>[noop] deadline cfq
</span></code></pre></td></tr></table></div></figure>


<h3>39. Install OpenStack On CentOS</h3>

<p>The following tips:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   35  packstack --answer-file=/root/answer.txt
</span><span class='line'>   41  cat /etc/sysconfig/selinux
</span><span class='line'>   42  vim /etc/selinux/config
</span><span class='line'>Disable selinux, then try it again
</span></code></pre></td></tr></table></div></figure>


<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>

<h3>40. Install OpenContrail/OpenStack</h3>

<p><a href="https://fosskb.wordpress.com/2014/10/18/openstack-juno-on-ubuntu-14-10/">https://fosskb.wordpress.com/2014/10/18/openstack-juno-on-ubuntu-14-10/</a></p>

<h1><a href="https://techwiki.juniper.net/Documentation/Contrail/Contrail_Controller_Getting_Started_Guide/10_In_Context%3A_Contrail_Controller_Getting_Started_Guide">https://techwiki.juniper.net/Documentation/Contrail/Contrail_Controller_Getting_Started_Guide/10_In_Context%3A_Contrail_Controller_Getting_Started_Guide</a>     </h1>

<h3>40. Docker save/load</h3>

<p>In the server, do:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker save ubuntu&gt;/root/myubuntu.tar
</span></code></pre></td></tr></table></div></figure>


<p>Scp it to client machine, and in client machine, do:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>docker load&lt;/root/myubuntu.tar
</span></code></pre></td></tr></table></div></figure>


<p>Examine it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@10-17-17-183 ~]# docker images
</span><span class='line'>REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
</span><span class='line'>ubuntu              latest              d0955f21bf24        2 weeks ago         188.3 MB
</span></code></pre></td></tr></table></div></figure>


<h3>41. Build Maas Based CentOS Image</h3>

<p>Following is just the commands:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@pc121:~/iso/CentOSImage/maas-image-builder# #./bin/maas-image-builder -o centos6-amd64-root-tgz centos --edition 6                        
</span><span class='line'>root@pc121:~/iso/CentOSImage/maas-image-builder# pwd
</span><span class='line'>/home/clouder/iso/CentOSImage/maas-image-builder
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>58372fecc80eeda12cddd4001534fc541cab8f30</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>

<h3>42. View multiply errors</h3>

<p>For displaying all of the error/warnings.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for file in $(ls /var/log/nova/); do cat /var/log/nova/$file | grep -iE 'error|warn' ; done
</span></code></pre></td></tr></table></div></figure>


<h3>43. Reference for docker and contrail</h3>

<p><a href="http://www.opencontrail.org/docker-with-opencontrail/">http://www.opencontrail.org/docker-with-opencontrail/</a></p>

<h3>44. Run Jobs at certain time</h3>

<p>Following is an example for automatically download the iso file at the spare time of the office network.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># echo "wget http://mirrors.aliyun.com/ubuntu-releases/15.04/ubuntu-15.04-server-amd64.iso -O /home/juju/iso/ubuntu-15.04-server-amd64.iso " | at 12:27
</span></code></pre></td></tr></table></div></figure>


<h3>45. Check kvm</h3>

<p>We could use <code>kvm-ok</code> for checking your cpu is compatible for use kvm acceleration.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install cpu-checker
</span><span class='line'>$ kvm-ok
</span></code></pre></td></tr></table></div></figure>


<p>The output will shows whether your cpu support kvm or not.</p>

<h3>46. Quickly Installation the Desktop</h3>

<p>Turn your minimal CentOS into a full Desktop:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$  sudo yum install system-config-kickstart
</span><span class='line'>$  sudo yum install gnome-desktop
</span><span class='line'>$  sudo yum -y groupinstall "X Window System" "Desktop"
</span></code></pre></td></tr></table></div></figure>


<p>Enter the desktop via <code>startx</code></p>

<h3>47. Restart bluetooth in Ubuntu</h3>

<p>Sometimes the bluetooth will fail on Ubuntu, using following command for restart the bluetooth service:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo /etc/init.d/bluetooth restart
</span></code></pre></td></tr></table></div></figure>


<p>Now you could continue to detect the devices and setup the configuration.</p>

<h3>48. Control the network flow</h3>

<p>Use wondershapt for controlling the network flow:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># wondershaper eth0 3000 500</span></code></pre></td></tr></table></div></figure>


<p>The first parameter is the download rate, while the second parameter is the upload rate..</p>

<h3>49. Can&rsquo;t git remote</h3>

<p>You should edit the remote branch like following to enable the git push origin:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git push origin master
</span><span class='line'>fatal: remote error: 
</span><span class='line'>  You can't push to git://github.com/User/xxx.git
</span><span class='line'>  Use https://github.com/User/xxx.git
</span><span class='line'>  Use https://github.com/purplepalmdash/NewBlog.git
</span><span class='line'>$ git remote rm origin
</span><span class='line'>$ git remote add origin git@github.com:User/xxx.git
</span><span class='line'>$ git push origin master
</span></code></pre></td></tr></table></div></figure>


<h3>50. Quickly Setup NFS Server</h3>

<p>On Ubuntu, first install the nfs-server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install nfs-kernel-server
</span><span class='line'>$ sudo vim /etc/exports 
</span><span class='line'>/media/repo     192.168.1.0/255.255.255.0(rw,sync,no_subtree_check)
</span><span class='line'>$ sudo /etc/init.d/nfs-kernel-server restart</span></code></pre></td></tr></table></div></figure>


<p>Mount it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo mount -t nfs 192.168.1.13:/media/repo /mnt</span></code></pre></td></tr></table></div></figure>


<h3>51. Set Aliyun For CentOS7</h3>

<p>Run following commands will update the CentOS repository and import the epel repository for CentOS7</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
</span><span class='line'># wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
</span><span class='line'># yum makecache
</span><span class='line'>wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
</span><span class='line'># yum  -y  update</span></code></pre></td></tr></table></div></figure>


<h3>52. Set apt-proxy for Ubuntu</h3>

<p>If you have set the apt-proxy, remember the listening port is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/apt/apt.conf
</span><span class='line'>Acquire::http::Proxy "http://10.3.3.5:3142"</span></code></pre></td></tr></table></div></figure>


<p>The configuration for apt-proxy could be found via google.</p>

<h3>54. Use gem taobao source</h3>

<p>For avoiding the GFW.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/opt/chef/embedded/bin/gemsources -a http://ruby.taobao.org/</span></code></pre></td></tr></table></div></figure>


<h3>53. Use Aliyun Repository</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem source -r https://rubygems.org/
</span><span class='line'>gem source -a http://mirrors.aliyun.com/rubygems/</span></code></pre></td></tr></table></div></figure>


<h3>54. XDMCP Error</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> XDMCP fatal error: Session declined Maximum number of open sessions from your host reached from .
</span><span class='line'>
</span><span class='line'>[root:~]# cat /etc/gdm/custom.conf
</span><span class='line'>[xdmcp]
</span><span class='line'>Port=177
</span><span class='line'>+ DisplaysPerHost=5
</span><span class='line'>Enable=true
</span><span class='line'>
</span><span class='line'># reboot</span></code></pre></td></tr></table></div></figure>


<p>Now your client will successfully login to the remote server.</p>

<h3>55. Upgrade Ubuntu14.04.2 Kernel</h3>

<p>For upgrade it to 3.16.xxx, simplying use following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo apt-get install linux-image-generic-lts-utopic</span></code></pre></td></tr></table></div></figure>


<h3>56. Install Docker on Ubuntu</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget -qO- https://get.docker.com/ | sh</span></code></pre></td></tr></table></div></figure>


<h3>57. Permanent Change Hostname on Fedora</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo hostnamectl set-hostname --static "YOUR-HOSTNAME-HERE"</span></code></pre></td></tr></table></div></figure>


<h3>58. Remote VNC via SSH</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Home machine:     
</span><span class='line'>ssh -R *:6234:localhost:5901 xxxx@1xxx.xxx.xxx.xxx -p xxxx4
</span><span class='line'>
</span><span class='line'>Server, forward 6234 to 16234:    
</span><span class='line'>ssh -NfL *:16234:localhost:6234 localhost -p xxxx4
</span><span class='line'>
</span><span class='line'>Company:    
</span><span class='line'>vncviewer 1zxxx.xxx.xxx.xxx:16234</span></code></pre></td></tr></table></div></figure>


<h3>59. Disable byobu from scrolling</h3>

<p>This is because the byobu use tmux for the backend. Change it into screen.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ byobu-select-backend 
</span><span class='line'># and selecting screen (option 2).</span></code></pre></td></tr></table></div></figure>


<h3>60. Add items into the host file</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ifconfig | awk -v MYHOST=$(hostname) '/inet addr/{print substr($2,6),"\t",MYHOST}'&gt;&gt;/etc/hosts</span></code></pre></td></tr></table></div></figure>


<h3>61. GPG Issues</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://help.ubuntu.com/community/GnuPrivacyGuardHowto#Using_GnuPG_to_generate_a_key</span></code></pre></td></tr></table></div></figure>


<h3>62. Mirror Whole Website</h3>

<p>Use Wget for retrieving all of the items:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root:/home/juju/Fuel61Repository]# wget --recursive -c -np -k -L http://mirror.fuel-infra.org/</span></code></pre></td></tr></table></div></figure>


<h3>63. Grouplist for yum</h3>

<p>yum install the group of the X window System, thus we could forwarding X11.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo yum grouplist
</span><span class='line'>$ sudo yum groupinstall "X Window System"</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/31">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/29">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/01/04/purge-cloudstack-env/">Purge CloudStack Env</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/01/03/tips-on-veewee-and-vagrant/">Tips on Veewee and Vagrant</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/30/rtl-sdr-steps/">Rtl-sdr Steps</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/30/integrate-freenas/">Integrate FreeNAS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/28/elastistor-data/">Elastistor Data</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>

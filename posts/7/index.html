
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dash</title>
  <meta name="author" content="Dash">

  
  <meta name="description" content="1. XenCenter Installation Just use your windows&rsquo;s browser point to your XenServer IP Address, Download the XenCenter, and install it. Update &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://purplepalmdash.github.io/posts/7">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/purplepalmdash/atom.xml" rel="alternate" title="Dash" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Dash</a></h1>
  
    <h2>Get busy living, or get busy dying.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/purplepalmdash/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:purplepalmdash.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/29/linux-tips-2/">Linux Tips(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-29T09:27:17+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:27 am</span></time>
        
         | <a href="/blog/2015/06/29/linux-tips-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>1. XenCenter Installation</h3>

<p>Just use your windows&rsquo;s browser point to your XenServer IP Address, Download the XenCenter, and install it.</p>

<p>Update Some tools on XenServer:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /etc/yum.repos.d/CentOS-Base.repo
</span><span class='line'>...
</span><span class='line'>enabled=1
</span><span class='line'>...
</span><span class='line'>$ yum install -y lm_sensors</span></code></pre></td></tr></table></div></figure>


<p>After installation of lm_sensors you could see more detailed information on XenServer.</p>

<h3>2. Disable Specified Repository</h3>

<p>Since citrix have no data in its repository, simply disable it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yum update --disablerepo=citrix</span></code></pre></td></tr></table></div></figure>


<h3>3. Yum Shell</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum shell
</span><span class='line'>remove ffmpeg-libpostproc
</span><span class='line'>remove ffmpeg
</span><span class='line'>install ffmpeg-compat
</span><span class='line'>run</span></code></pre></td></tr></table></div></figure>


<h3>4. Install lm_sensors In XenServer</h3>

<p>The default lm_sensors could not be insalled due to dependency errors, so we download the source code from lm_sensors website and manually build and install it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://dl.lm-sensors.org/lm-sensors/releases/lm_sensors-3.4.0.tar.bz2
</span><span class='line'>$ tar xzvf lm_sensors-3.4.0.tar.bz2
</span><span class='line'>$ cd lm_sensors
</span><span class='line'>$ yum install -y gcc make flex bison 
</span><span class='line'>$ make && make install
</span><span class='line'>$ export PATH=/usr/local/bin:$PATH
</span><span class='line'>$ sensors-detect
</span><span class='line'>$ sensors</span></code></pre></td></tr></table></div></figure>


<p>In 79 machine, sensors won&rsquo;t printout cpu fan, solved by:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ modprobe it87 force_id=0x8728</span></code></pre></td></tr></table></div></figure>


<p>Or configure the modprobe.d:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root:/etc/modprobe.d]# cat it87.conf 
</span><span class='line'>options it87 force_id=0x8603
</span><span class='line'>
</span><span class='line'>[root:/etc/modprobe.d]# pwd
</span><span class='line'>/etc/modprobe.d</span></code></pre></td></tr></table></div></figure>


<h3>5. Detect an AMD Chipset</h3>

<p>First using <code>sensors-detect</code> for detecting the sensors, the result is listed as:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Now follows a summary of the probes I have just done.
</span><span class='line'>
</span><span class='line'>Driver `w83627ehf':
</span><span class='line'>  * ISA bus, address 0x290
</span><span class='line'>    Chip `Nuvoton W83677HG-I (NCT5572D/NCT6771F/NCT6772F/NCT6775F) Super IO Sensors' (confidence: 9)
</span><span class='line'>
</span><span class='line'>Driver `k10temp' (autoloaded):
</span><span class='line'>  * Chip `AMD Family 12h and 14h thermal sensors' (confidence: 9)</span></code></pre></td></tr></table></div></figure>


<p>Now go to the modules directory for finding out the corresponding driver:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@xenserver-WolfHunter 3.10.0+2]# find . | grep -i w83
</span><span class='line'>./kernel/drivers/hwmon/w83795.ko
</span><span class='line'>./kernel/drivers/hwmon/w83627hf.ko
</span><span class='line'>./kernel/drivers/hwmon/w83l786ng.ko
</span><span class='line'>./kernel/drivers/hwmon/w83792d.ko
</span><span class='line'>./kernel/drivers/hwmon/w83l785ts.ko
</span><span class='line'>./kernel/drivers/hwmon/w83791d.ko
</span><span class='line'>./kernel/drivers/hwmon/w83793.ko
</span><span class='line'>./kernel/drivers/hwmon/w83781d.ko
</span><span class='line'>./kernel/drivers/hwmon/w83627ehf.ko
</span><span class='line'>[root@xenserver-WolfHunter 3.10.0+2]# pwd
</span><span class='line'>/lib/modules/3.10.0+2
</span><span class='line'>[root@xenserver-WolfHunter 3.10.0+2]# modprobe w83627ehf.ko</span></code></pre></td></tr></table></div></figure>


<p>Now you could detect more infos, add to automatically:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@xenserver-WolfHunter modprobe.d]# cat w83627ehf.conf
</span><span class='line'>#!/bin/sh 
</span><span class='line'>/sbin/insmod /lib/modules/3.10.0+2/kernel/drivers/hwmon/w83627ehf.ko</span></code></pre></td></tr></table></div></figure>


<h3>6. Headless Ubuntu</h3>

<p>Headless Ubuntu, for updating grub.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Add: GRUB_RECORDFAIL_TIMEOUT = 15 in /etc/default/grub, and run "sudo update-grub". You can change the 15 to any arbitrary number of seconds that you like.</span></code></pre></td></tr></table></div></figure>


<h3>7.Joggler Bootloader Configuration</h3>

<p>Notice there are 2 systems available on Joggler.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[dash@/run/media/dash/linux-boot]$ cat grub.cfg
</span><span class='line'>loadfont /unicode.pf2
</span><span class='line'>terminal_output gfxterm
</span><span class='line'>set timeout=5
</span><span class='line'>menuentry "Ubuntu 12.04 LTS (Precise) - 3.2.32joggler1" {
</span><span class='line'>  # text mode
</span><span class='line'>  #linux /vmlinuz-3.2.32joggler1 root=LABEL=linux-root 3 ro text pci=routeirq
</span><span class='line'>  # Graphical mode
</span><span class='line'>  linux /vmlinuz-3.2.32joggler1 root=LABEL=linux-root 3 ro pci=routeirq
</span><span class='line'>  initrd /initrd.img-3.2.32joggler1
</span><span class='line'>}
</span><span class='line'>###############Xubuntu#####################3
</span><span class='line'>#menuentry "XUbuntu 12.04 LTS (Precise) - 3.2.32joggler1" {
</span><span class='line'>#  linux /vmlinuz-3.2.32joggler1 root=LABEL=Xubuntu ro quiet splash 
</span><span class='line'>#  initrd /initrd.img-3.2.32joggler1
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h3>8. Use Joggler As a DigitalFrame</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/sh
</span><span class='line'>#
</span><span class='line'># Script to run Digital Picture Frame using Feh
</span><span class='line'># drware@thewares.net
</span><span class='line'>#
</span><span class='line'>
</span><span class='line'># Change number below to the duration, in seconds
</span><span class='line'># for each photo to be displayed
</span><span class='line'>DELAY="5"
</span><span class='line'>
</span><span class='line'># hide the cursor after 15 seconds
</span><span class='line'>#/usr/bin/unclutter -idle 15 &
</span><span class='line'>
</span><span class='line'># Start slide show
</span><span class='line'># /usr/bin/feh --quiet --recursive --randomize --full-screen \ --slideshow-delay $DELAY /home/dash/800480/
</span><span class='line'>/usr/bin/feh --hide-pointer -D $DELAY --quiet --recursive --randomize --full-screen \ --slideshow-delay $DELAY /home/dash/800480 &
</span><span class='line'>
</span><span class='line'># Phone home and sync
</span><span class='line'># /home/dsl/frame/rsync.sh
</span><span class='line'>
</span><span class='line'>exit 0</span></code></pre></td></tr></table></div></figure>


<h3>9. Resolving git conflicts</h3>

<p>Once you installed meld or other tools, using following commands.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ git mergetool</span></code></pre></td></tr></table></div></figure>


<h3>10. Enlarge Volume</h3>

<p>Enlarge the qemu disk via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo qemu-img resize abc.qcow2 +200GB</span></code></pre></td></tr></table></div></figure>


<p>Enlarge the disk via following command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@fuel ~]# df -h
</span><span class='line'>Filesystem            Size  Used Avail Use% Mounted on
</span><span class='line'>/dev/mapper/os-root   9.6G  976M  8.1G  11% /
</span><span class='line'>/dev/mapper/os-var     27G  5.4G   20G  22% /var
</span><span class='line'>[root@fuel ~]# lvs
</span><span class='line'>  LV           VG   Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span><span class='line'>  root         os   -wi-ao----  9.78g                                                    
</span><span class='line'>  swap         os   -wi-ao----  2.94g                                                    
</span><span class='line'>  var          os   -wi-ao---- 26.66g       
</span><span class='line'> </span></code></pre></td></tr></table></div></figure>


<p>Use gparted livecd for enlarge the disk, now you could enjoy the whole 300GiB disk size.</p>

<p>Resize the var partition:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Disk /dev/mapper/os-var: 28.6 GB, 28621930496 bytes
</span><span class='line'>255 heads, 63 sectors/track, 3479 cylinders
</span><span class='line'>Units = cylinders of 16065 * 512 = 8225280 bytes
</span><span class='line'>Sector size (logical/physical): 512 bytes / 512 bytes
</span><span class='line'>I/O size (minimum/optimal): 512 bytes / 512 bytes
</span><span class='line'>[root@fuel ~]# lvextend -L+50G /dev/mapper/os-var
</span><span class='line'>  Size of logical volume os/var changed from 26.66 GiB (853 extents) to 76.66 GiB (2453 extents).
</span><span class='line'>  Logical volume var successfully resized
</span><span class='line'>######Reboot to gdisk iso, and resize2fs.   
</span><span class='line'># resize2fs /dev/mapper/os-var</span></code></pre></td></tr></table></div></figure>


<h3>11. gpg Generation</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ apt-get install -y rng-tools
</span><span class='line'>$ rngd -r /dev/urandom
</span><span class='line'>$ gpg --gen-key
</span><span class='line'>$ gpg --list-secret-keys
</span><span class='line'>$ gpg-agent --homedir /home/dash/.gnupg --use-standard-socket --daemon
</span><span class='line'>$ sudo apt-get install gnupg</span></code></pre></td></tr></table></div></figure>


<h3>12. Syslogd related</h3>

<p>Redirect bash script&rsquo;s output to syslogd:   <br/>
<a href="http://urbanautomaton.com/blog/2014/09/09/redirecting-bash-script-output-to-syslog/">http://urbanautomaton.com/blog/2014/09/09/redirecting-bash-script-output-to-syslog/</a></p>

<p>Then limit the syslogd activity:</p>

<p>via logrotate, syslogd don&rsquo;t care about the log file size.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>So in the end the top portion of my /etc/logrotate.conf file looks like this:
</span><span class='line'>
</span><span class='line'>size 250M
</span><span class='line'>rotate 2
</span><span class='line'>create
</span><span class='line'>#compress
</span><span class='line'>include /etc/logrotate.d</span></code></pre></td></tr></table></div></figure>


<h3>13. Brake</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://www.miroslavnovak.com/qemu-brake_en.php</span></code></pre></td></tr></table></div></figure>


<h3>14. install specified pip version</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo pip install "PyOpenSSL&gt;=0.13"</span></code></pre></td></tr></table></div></figure>


<h3>15. Tips for using vFense</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   57  sudo pip install "PyOpenSSL&gt;=0.13"
</span><span class='line'>   58  apt-cache search libffi
</span><span class='line'>   59  sudo apt-get install -y libffi-dev
</span><span class='line'>dash@fenseServer:~$ sudo mkdir /usr/share/rethinkdb
</span></code></pre></td></tr></table></div></figure>


<h3>16. Cgroup error</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>cloudstack4.5.1 在centos7.1 上的 bug 
</span><span class='line'>此bug 会导致 系统vm state 状态获取不到
</span><span class='line'>在agent的log中获取到的错误信息为
</span><span class='line'>Controller 'cpuacct' is not wanted, but 'cpu' is co-mounted: Invalid argument
</span><span class='line'>
</span><span class='line'>解决方法
</span><span class='line'>
</span><span class='line'>注释这个文件中的这行 /usr/lib64/python2.7/site-packages/cloudutils/serviceConfig.py
</span><span class='line'>cfo.addEntry("cgroup_controllers", "[\"cpu\"]")
</span><span class='line'>和这个文件中的这行 /etc/libvirt/qemu.conf
</span><span class='line'>cgroup_controllers=["cpu"]
</span><span class='line'>重启libvirtd服务
</span><span class='line'>
</span><span class='line'>官网bug连接：https://issues.apache.org/jira/browse/CLOUDSTACK-8443</span></code></pre></td></tr></table></div></figure>


<h3>17. PXE Boot Debian:</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Install:   
</span><span class='line'>http://backreference.org/2013/12/23/diskless-iscsi-boot-with-pxe-howto/
</span><span class='line'>iscsi:    
</span><span class='line'>http://www.sysprobs.com/guide-how-to-create-iscsi-storage-disks-freenas-08
</span><span class='line'>Trouble Shooting: Use the latest version!!!
</span><span class='line'>https://www.howtoforge.com/community/threads/debian-boot-over-iscsi-problem.67536/#post-321516
</span><span class='line'>iscsi and kvm:
</span><span class='line'>https://www.berrange.com/posts/2010/05/05/provisioning-kvm-virtual-machines-on-iscsi-the-hard-way-part-2-of-2/</span></code></pre></td></tr></table></div></figure>


<h3>18. Quickly Connect to RDP</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ssh -L 2333:10.0.0.2:3389 192.168.10.187 -l root
</span><span class='line'># rdesktop -u YourUseName -p YourPassword localhost:2333 -g 1400x800</span></code></pre></td></tr></table></div></figure>


<h3>18. nginx enable directory displaying and follow links:</h3>

<p>On CentOS 7, do following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/nginx/nginx.conf
</span><span class='line'>http {
</span><span class='line'>        disable_symlinks off;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>server {
</span><span class='line'>        root         /var/www/html;
</span><span class='line'>
</span><span class='line'>        location / {
</span><span class='line'>                        autoindex on;
</span><span class='line'>        }</span></code></pre></td></tr></table></div></figure>


<p>Restart the nginx service now you could get the local directory avaiable in browser.</p>

<h3>20. Get Back the passwd</h3>

<p>In Grub, add <code>single</code> at the <code>linux   /boot/vmlinuz-</code>&hellip;&hellip;</p>

<p>Press F10, and now you can do whatever you want to do.</p>

<h3>21. Enable Nested KVM</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># virsh edit VM_NAME
</span><span class='line'>&lt;vcpu placement='static' cpuset='0-3'&gt;4&lt;/vcpu&gt;
</span><span class='line'>Also change the cpu model.  
</span><span class='line'>&lt;cpu&gt;
</span><span class='line'>....
</span><span class='line'>&lt;/cpu&gt; 
</span><span class='line'>remove the tsc related item.   </span></code></pre></td></tr></table></div></figure>


<h3>22. Restart Windows Under CMD</h3>

<p>Specify the timeout(5 seconds) under the cmd line:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># shutdown /r /t 5</span></code></pre></td></tr></table></div></figure>


<h3>23. Cleanup Windows7 Disk</h3>

<p>Right click the disk, and select <code>Disk Cleanup</code>, then select <code>Clean up system files</code>, then your winsxs directory will be cleaned, thus saved your partition volumn.</p>

<h3>24. vim spell checking</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>: set spell spelllang=en_us</span></code></pre></td></tr></table></div></figure>


<h3>25. Startup Synergy At System Startup</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># vim /etc/lightdm/lightdm.conf
</span><span class='line'>greeter-setup-script=/usr/bin/synergys --config /home/dash/mysynergy.conf</span></code></pre></td></tr></table></div></figure>


<h3>26. Install Cobbler On Ubuntu</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># wget -qO - http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/xUbuntu_14.04/Release.key | sudo apt-key add -
</span><span class='line'>OK
</span><span class='line'># sudo add-apt-repository "deb http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/xUbuntu_14.04/ ./"
</span><span class='line'># apt-get update</span></code></pre></td></tr></table></div></figure>


<h3>27. Install restricted extra packages</h3>

<p>Install it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> # sudo apt-get install ubuntu-restricted-extras</span></code></pre></td></tr></table></div></figure>


<h3>28. View Allocated DHCP Address</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ more /var/lib/dhcpd/dhcpd.leases</span></code></pre></td></tr></table></div></figure>


<h3>29. apt-mirror for launchpad</h3>

<p>The steps are the same as the ordinary repository.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># vim  /etc/apt/mirror.list
</span><span class='line'> deb http://ppa.launchpad.net/landscape/15.01/ubuntu trusty main
</span><span class='line'># apt-mirror</span></code></pre></td></tr></table></div></figure>


<h3>30. Specify architecture of sources.list</h3>

<p>Only include amd64:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/apt.sources.list
</span><span class='line'>deb [arch=amd64] http://192.168.0.79/landscape/15.01/ubuntu/ trusty main</span></code></pre></td></tr></table></div></figure>


<h3>31. Use Cobbler Repository</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@localhost yum.repos.d]# cat cobbler.repo 
</span><span class='line'>[core-0]
</span><span class='line'>name=core-0
</span><span class='line'>baseurl=http://10.9.10.1/ks_mirror/CentOS-6.5-x86_64
</span><span class='line'>enabled=1
</span><span class='line'>gpgcheck=0
</span><span class='line'>priority=1</span></code></pre></td></tr></table></div></figure>


<h3>32. Jenkins Worktips</h3>

<p>Worktips:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># visudo
</span><span class='line'>jenkins ALL=(ALL) NOPASSWD:ALL</span></code></pre></td></tr></table></div></figure>


<h3>33. Query packages</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yum whatprovides "*/mkpasswd"
</span><span class='line'>-or-
</span><span class='line'>$ repoquery -q --file */mkpasswd</span></code></pre></td></tr></table></div></figure>


<h3>34. Encrypt kickstart used passwd</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># perl -e "print crypt('engine123','sa')"
</span><span class='line'>saWbOtynpFXBA%</span></code></pre></td></tr></table></div></figure>


<h3>35. Disable ssh -X warning</h3>

<p>Problem:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Couldn't connect to accessibility bus: Failed to connect to socket /tmp/dbus-*</span></code></pre></td></tr></table></div></figure>


<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># vim ~/.bashrc
</span><span class='line'>export NO_AT_BRIDGE=1</span></code></pre></td></tr></table></div></figure>


<h3>36. Manually add gpg key</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># wget http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/xUbuntu_15.04/Release.key
</span><span class='line'># cat Release.key |sudo apt-key add -</span></code></pre></td></tr></table></div></figure>


<h3>37. Quick Setup the CentOS7 Network</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat /etc/sysconfig/network-scripts/ifcfg-eth0
</span><span class='line'># Generated by dracut initrd
</span><span class='line'>DEVICE="eth0"
</span><span class='line'>ONBOOT=yes
</span><span class='line'>NETBOOT=yes
</span><span class='line'>UUID="99c6b60e-1932-46f9-a86a-d9836f42cecb"
</span><span class='line'>IPV6INIT=yes
</span><span class='line'>BOOTPROTO=static
</span><span class='line'>IPADDR=10.9.10.100
</span><span class='line'>GATEWAY=10.9.10.1
</span><span class='line'>TYPE=Ethernet
</span><span class='line'>NAME="eth0"
</span><span class='line'>DNS1=223.5.5.5
</span><span class='line'>DNS2=180.76.76.76</span></code></pre></td></tr></table></div></figure>


<h3>38. GPG Key Error</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Retrieving key from file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7
</span><span class='line'>GPG key retrieval failed: [Errno 14] curl#37 - "Couldn't open file
</span><span class='line'>/etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7"</span></code></pre></td></tr></table></div></figure>


<p>Solution:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># wget http://mirrors.aliyun.com/epel/RPM-GPG-KEY-EPEL-7
</span><span class='line'># rpm --import RPM-GPG-KEY-EPEL-7 </span></code></pre></td></tr></table></div></figure>


<h3>39. Sync REpository</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@SpaceWalker ~]# spacewalk-repo-sync -c centos7-x86_64 --url=file:///var/distro-trees/centos7_64/
</span><span class='line'>======================================
</span><span class='line'>| Channel: centos7-x86_64
</span><span class='line'>======================================
</span><span class='line'>
</span><span class='line'>Repo URL: file:///var/distro-trees/centos7_64/
</span><span class='line'>Packages in repo:              8652
</span><span class='line'>No new packages to sync.
</span><span class='line'>Repo file:///var/distro-trees/centos7_64/ has comps file 0e6e90965f55146ba5025ea450f822d1bb0267d0299ef64dd4365825e6bad995-c7-x86_64-comps.xml.gz.
</span><span class='line'>Repo file:///var/distro-trees/centos7_64/ has 0 errata.
</span><span class='line'>Sync completed.
</span><span class='line'>Total time: 0:01:58</span></code></pre></td></tr></table></div></figure>


<h3>40. Resuming until you success</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat ./abc.sh
</span><span class='line'>until sudo xxxxxxx
</span><span class='line'>do
</span><span class='line'>  do something
</span><span class='line'>done
</span><span class='line'># ./abc.sh</span></code></pre></td></tr></table></div></figure>


<h3>41. pacman/yaourt</h3>

<p>Ignore the pacman PGP check:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/pacman.conf
</span><span class='line'>SigLevel = Never</span></code></pre></td></tr></table></div></figure>


<p>yaourt use disable PGP options:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yaourt --m-arg "--skipchecksums --skippgpcheck" -S xxxxxx</span></code></pre></td></tr></table></div></figure>


<h3>42. Install pandoc</h3>

<p>Add 3rd-party repository</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># vim /etc/pacman.conf
</span><span class='line'>[haskell-core]
</span><span class='line'>Server = http://xsounds.org/~haskell/core/x86_64/</span></code></pre></td></tr></table></div></figure>


<p>With the above ignore PGP settting, run <code>proxychains pacman -Sy</code>.</p>

<p>Then you type-in <code>proxychain pacman -S haskell-pandoc</code> for installing the pandoc.</p>

<h3>43. Change Docker Image Save Directory</h3>

<p>Only works under CentOS:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat /etc/sysconfig/docker
</span><span class='line'>other_args='-g /home/xxxxxxx/dockerimage'
</span><span class='line'>``
</span><span class='line'>
</span><span class='line'>### 44. Define locale under CentOS
</span></code></pre></td></tr></table></div></figure>


<h1>localedef -v -c -i en_US -f UTF-8 en_US.UTF-8</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 45. Install nethogs in CentOS 7 
</span></code></pre></td></tr></table></div></figure>


<h1>yum install libpcap-devel -y</h1>

<h1>rpm -ivh <a href="http://cdn.kanachan.me.uk/dl/rpms/nethogs/nethogs-0.8.0-1.el6.x86_64.rpm">http://cdn.kanachan.me.uk/dl/rpms/nethogs/nethogs-0.8.0-1.el6.x86_64.rpm</a></h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 46. CS7 Related
</span></code></pre></td></tr></table></div></figure>


<p>[root@spacewalkercs7 zones]# cat db.spacewalkercs7
;
;
$TTL 604800
@       IN      SOA     spacewalkercs7. root.spacewalker.cs. (
                                3               ;Serial
                                604800          ;Refresh
                                86400           ;Retry
                                2419200         ;Expire
                                604800 )        ;Negative Cache TTL
;
; name servers - NS records
      IN      NS      spacewalkercs7.</p>

<p>; name servers  - A records
spacewalkercs7.         IN      A       10.9.10.12
[root@spacewalkercs7 zones]# pwd
/etc/named/zones
[root@spacewalkercs7 zones]# cat /etc/named.conf
//
// named.conf
//
// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS
// server as a caching only nameserver (as a localhost DNS resolver only).
//
// See /usr/share/doc/bind*/sample/ for example named configuration files.
//</p>

<p>options {
        listen-on port 53 { 127.0.0.1; 10.9.10.12; };
        listen-on-v6 port 53 { ::1; };
        directory       &ldquo;/var/named&rdquo;;
        dump-file       &ldquo;/var/named/data/cache_dump.db&rdquo;;
        statistics-file &ldquo;/var/named/data/named_stats.txt&rdquo;;
        memstatistics-file &ldquo;/var/named/data/named_mem_stats.txt&rdquo;;
        allow-query     { localhost; 10.9.10.0/24;};
        allow-transfer     { localhost; 10.9.10.0/24;};</p>

<pre><code>    /* 
     - If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.
     - If you are building a RECURSIVE (caching) DNS server, you need to enable 
       recursion. 
     - If your recursive DNS server has a public IP address, you MUST enable access 
       control to limit queries to your legitimate users. Failing to do so will
       cause your server to become part of large scale DNS amplification 
       attacks. Implementing BCP38 within your network would greatly
       reduce such attack surface 
    */
    recursion yes;

    dnssec-enable yes;
    dnssec-validation yes;
    dnssec-lookaside auto;

    /* Path to ISC DLV key */
    bindkeys-file "/etc/named.iscdlv.key";

    managed-keys-directory "/var/named/dynamic";

    pid-file "/run/named/named.pid";
    session-keyfile "/run/named/session.key";
</code></pre>

<p>};</p>

<p>logging {
        channel default_debug {
                file &ldquo;data/named.run&rdquo;;
                severity dynamic;
        };
};</p>

<p>zone &ldquo;.&rdquo; IN {
        type hint;
        file &ldquo;named.ca&rdquo;;
};</p>

<p>zone &ldquo;spacewalkercs7&rdquo; {
        type master;
        file &ldquo;/etc/named/zones/db.spacewalkercs7&rdquo;;
};</p>

<p>include &ldquo;/etc/named.rfc1912.zones&rdquo;;
include &ldquo;/etc/named.root.key&rdquo;;</p>

<p>[root@spacewalkercs7 zones]# cat /etc/dhcp/dhcpd.conf
#</p>

<h1>DHCP Server Configuration file.</h1>

<h1>see /usr/share/doc/dhcp*/dhcpd.conf.example</h1>

<h1>see dhcpd.conf(5) man page</h1>

<p>#
option domain-name &ldquo;server.world&rdquo;;</p>

<h1>specify name server&rsquo;s hostname or IP address</h1>

<p>option domain-name-servers dlp.server.world;</p>

<h1>default lease time</h1>

<p>default-lease-time 600;</p>

<h1>max lease time</h1>

<p>max-lease-time 7200;</p>

<h1>this DHCP server to be declared valid</h1>

<p>authoritative;</p>

<h1>specify network address and subnet mask</h1>

<p>subnet 10.9.10.0 netmask 255.255.255.0 {
    # specify the range of lease IP address
    range dynamic-bootp 10.9.10.200 10.9.10.254;
    # specify broadcast address
    option broadcast-address 10.9.10.255;
    # specify default gateway
    option routers 10.9.10.1;
    # Specify default dns server
    option domain-name-servers 10.9.10.12;
}</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 47. On DNS Server
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://www.unixmen.com/setting-dns-server-centos-7/">http://www.unixmen.com/setting-dns-server-centos-7/</a>
<a href="https://www.digitalocean.com/community/tutorials/how-to-configure-bind-as-a-private-network-dns-server-on-centos-7">https://www.digitalocean.com/community/tutorials/how-to-configure-bind-as-a-private-network-dns-server-on-centos-7</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 48. Install X windows under CentOS
</span></code></pre></td></tr></table></div></figure>


<h1>yum groupinstall &lsquo;X Window System&rsquo; -y</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 49. Quickly Create/Start KVM Machine
</span></code></pre></td></tr></table></div></figure>


<h1>virsh dumpxml VM_A>A.xml</h1>

<h1>vim A.xml</h1>

<p>Change its name/uuid/disk file</p>

<h1>virsh start vmname</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 50. View io statistics
</span></code></pre></td></tr></table></div></figure>


<h1>iostat -m 1</h1>

<h1>iotop</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 51. Traffic Control
</span><span class='line'>http://lartc.org/LARTC-zh_CN.GB2312.pdf
</span><span class='line'>
</span><span class='line'>### 52. system-config-kickstart Start Error
</span><span class='line'>Problem:   
</span></code></pre></td></tr></table></div></figure>


<h1>system-config-kickstart</h1>

<p>RuntimeError: Could not read video driver database</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Solution:    
</span></code></pre></td></tr></table></div></figure>


<h1>apt-get remove hwdata</h1>

<h1>wget <a href="ftp://mirror.ovh.net/mirrors/ftp.debian.org/debian/pool/main/h/hwdata/hwdata_0.234-1_all.deb">ftp://mirror.ovh.net/mirrors/ftp.debian.org/debian/pool/main/h/hwdata/hwdata_0.234-1_all.deb</a></h1>

<h1>dpkg -i hwdata_0.267-1_all.deb</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 53. Query Configuration file of yum
</span><span class='line'>Use `rpm -qc` for querying the configuration files of specified software.     
</span></code></pre></td></tr></table></div></figure>


<p>$ rpm -qc xxxxx</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 54. ShellShock
</span></code></pre></td></tr></table></div></figure>


<h1>export foo=&lsquo;() { :; }; echo Hello World&rsquo;</h1>

<h1>env x=&lsquo;() { :;}; echo vulnerable&rsquo;  bash -c &ldquo;echo this is a test&rdquo;</h1>

<h1></h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Detailed info:    
</span><span class='line'>[http://www.cnblogs.com/chenyueyi/p/4520375.html](http://www.cnblogs.com/chenyueyi/p/4520375.html)    
</span><span class='line'>
</span><span class='line'>### 55. Install Wine1.7
</span><span class='line'>Do the following changes:    
</span></code></pre></td></tr></table></div></figure>


<p>$ sudo vim /etc/apt/sources.list
deb [arch=amd64,i386]  <a href="http://mirrors.aliyun.com/ubuntu/">http://mirrors.aliyun.com/ubuntu/</a> trusty main restricted universe multiverse
deb [arch=amd64,i386]  <a href="http://mirrors.aliyun.com/ubuntu/">http://mirrors.aliyun.com/ubuntu/</a> trusty-security main restricted universe multiverse
deb [arch=amd64,i386]  <a href="http://mirrors.aliyun.com/ubuntu/">http://mirrors.aliyun.com/ubuntu/</a> trusty-updates main restricted universe multiverse
deb [arch=amd64,i386]  <a href="http://mirrors.aliyun.com/ubuntu/">http://mirrors.aliyun.com/ubuntu/</a> trusty-proposed main restricted universe multiverse
deb [arch=amd64,i386]  <a href="http://mirrors.aliyun.com/ubuntu/">http://mirrors.aliyun.com/ubuntu/</a> trusty-backports main restricted universe multiverse
$ sudo dpkg &ndash;add-architecture i386
$ sudo apt-get update &amp;&amp; sudo apt-get -y upgrade &amp;&amp; sudo apt-get -y dist-upgrade
$ sudo aptitude &ndash;full-resolver -f install wine1.7
6)  wine1.7 [Not Installed]
7)  wine1.7-amd64 [Not Installed]
8)  wine1.7-i386:i386 [Not Installed]</p>

<p>Accept this solution? [Y/n/q/?] 6
Action &ldquo;6&rdquo;: Removing wine1.7
Accept this solution? [Y/n/q/?] r 6
&hellip;..</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Then you will get wine1.7 installed in your system.    
</span><span class='line'>=======
</span><span class='line'>
</span><span class='line'>### 55. Quickly Remove the know hosts
</span></code></pre></td></tr></table></div></figure>


<p>ssh-keygen -f &ldquo;/home/xxxx/.ssh/known_hosts&rdquo; -R 10.9.10.2</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 56. Install mirrordir from rpmforge
</span><span class='line'>Import rpmforge and install mirrordir.    
</span></code></pre></td></tr></table></div></figure>


<p>$ rpm -Uvh <a href="http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm">http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el7.rf.x86_64.rpm</a>
$ yum search mirrordir
$ yum install mirrordir</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 57. Convert recorded videos into gif
</span><span class='line'>From the ogv into the gif.    
</span></code></pre></td></tr></table></div></figure>


<h1>mplayer -ao null ./chromium.ogv -vo jpeg:outdir=output</h1>

<h1>ls output</h1>

<h1>convert output/* output.gif</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 58. Clear BIOS Password In Linux
</span><span class='line'>[http://www.cgsecurity.org/wiki/CmosPwd#CmosPwd_Download](http://www.cgsecurity.org/wiki/CmosPwd#CmosPwd_Download)    
</span></code></pre></td></tr></table></div></figure>


<h1>sudo ./cmospwd /k</h1>

<p>&hellip;.
1 - Kill cmos
2 - Kill cmos (try to keep date and time)
0 - Abort``</p>

<h1>2</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Reboot and see CMOS.     
</span><span class='line'>
</span><span class='line'>### 59. MATE On CentOS7
</span><span class='line'>First you should switches to the epel and official, then install via groupinstall:    
</span></code></pre></td></tr></table></div></figure>


<p>$  yum groupinstall &ldquo;MATE Desktop&rdquo; -y</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>I don't know why I can install it from my own repository.    
</span><span class='line'>
</span><span class='line'>To change the runlevel of the CentOS Server, use following command:    
</span><span class='line'>
</span><span class='line'>Graphical:    
</span></code></pre></td></tr></table></div></figure>


<h1>systemctl set-default  graphical.target</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>Multi-User:    
</span></code></pre></td></tr></table></div></figure>


<h1>systemctl set-default  multi-user.target</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 60. Re-install CentOS7 Related
</span></code></pre></td></tr></table></div></figure>


<p>Tips for monitor of centos7:
<a href="https://mrkmg.com/posts/changing-the-login-screen-resolution-in-centos-7-for-gnome-3/">https://mrkmg.com/posts/changing-the-login-screen-resolution-in-centos-7-for-gnome-3/</a>
<a href="https://jaketremper.com/?p=23">https://jaketremper.com/?p=23</a></p>

<p>Chinese Input Method:
<a href="http://blog.csdn.net/maokexu123/article/details/44495395">http://blog.csdn.net/maokexu123/article/details/44495395</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 61. Mount Error Solution
</span></code></pre></td></tr></table></div></figure>


<p>3.2.8内核加载模块错误的临时解决方案</p>

<p>论坛用户反映升级3.2.8内核后出现加载内核模块错误，一般的报错信息如：</p>

<p>ERROR: could not insert &lsquo;module-name&rsquo;: Exec format error</p>

<p>原帖在这里，用户cuihao给出了临时的解决方法。</p>

<pre><code>重命名/lib/modules/extramodules-3.2-ARCH/ （官方内核）或/lib/modules/extramodules-3.2-ck/ （ck内核）下对应的模块文件(.ko.gz)，然后重新编译，命令：

make clean
make
make install
depmod -a

之后再加载内核模块即可。 
</code></pre>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 62. Build Fedora Images
</span></code></pre></td></tr></table></div></figure>


<p><a href="https://www.rdoproject.org/Creating_CentOS_and_Fedora_images_ready_for_Openstack">https://www.rdoproject.org/Creating_CentOS_and_Fedora_images_ready_for_Openstack</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Bug for gpg in Fedora21:    
</span></code></pre></td></tr></table></div></figure>


<p>rpmkeys &ndash;import /etc/pki/rpm-gpg/RPM-GPG-KEY-fedora-21-x86_64</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>Error:   
</span></code></pre></td></tr></table></div></figure>


<p>Unable to create appliance : Unable to run [&lsquo;/usr/bin/firewall-offline-cmd&rsquo;, &lsquo;&ndash;disabled&rsquo;]!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 63. KickStart Online Generate
</span><span class='line'>
</span><span class='line'>[https://access.redhat.com/labs/kickstartconfig/](https://access.redhat.com/labs/kickstartconfig/)     
</span><span class='line'>
</span><span class='line'>### 64. Text Based vm Installation
</span><span class='line'>First mount the installation media to /mnt, then run the installtion like following
</span><span class='line'>command.    
</span></code></pre></td></tr></table></div></figure>


<h1>qemu-system-x86_64 &ndash;enable-kvm -m 1024 -smp 2 -hda ./temp_test.qcow2  -cdrom \</h1>

<p>/media/opensuse/dash/iso/CentOS-6.6-x86_64-bin-DVD1.iso &ndash;nographic -bios \
/usr/share/qemu/bios.bin -append console=ttyS0 -kernel /mnt/isolinux/vmlinuz -initrd \
/mnt/isolinux/initrd.img</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 65. Gzip gz file
</span></code></pre></td></tr></table></div></figure>


<p>gzip -c Packages > Packages.gz</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 66. osad problem
</span><span class='line'>Trusty should use saucy debs, try it tomorrow. 
</span><span class='line'>
</span><span class='line'>### 67. Quick Configure CentOS7(newly installed)  
</span></code></pre></td></tr></table></div></figure>


<h1>cd /etc/yum.repos.d/</h1>

<h1>mkdir back &amp;&amp; mv * back/</h1>

<h1>wget <a href="http://192.168.0.79/mrepo7.repo">http://192.168.0.79/mrepo7.repo</a> &amp;&amp; yum makecache</h1>

<h1>vim /etc/sysconfig/network-scripts/ifcfg-****</h1>

<p>IPADDR=192.168.0.xxx
NETMASK=255.255.0.0
GATEWAY=192.168.0.xxxx
DNS1=223.5.5.5
DNS2=180.76.76.76</p>

<h1>useradd -m ccccccc</h1>

<h1>visudo</h1>

<h1>passwd ccccc</h1>

<h1>vim /etc/hostname</h1>

<p>pc0xxx</p>

<h1>vim /etc/hosts</h1>

<p>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4 pc0xx</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Configure the resolution:    
</span></code></pre></td></tr></table></div></figure>


<h1>cat /etc/gdm/Init/Default</h1>

<h1>1440x900 59.89 Hz (CVT 1.30MA) hsync: 55.93 kHz; pclk: 106.50 MHz</h1>

<h1>Modeline &ldquo;1440x900_60.00&rdquo;  106.50  1440 1528 1672 1904  900 903 909 934 -hsync</h1>

<p>xrandr &ndash;newmode &ldquo;1440x900_60.00&rdquo; 106.50  1440 1528 1672 1904  900 903 909 934 -hsync +vsync                                                 <br/>
xrandr &ndash;addmode VGA1 &ldquo;1440x900_60.00&rdquo;                                          <br/>
xrandr &ndash;output VGA1 &ndash;mode &ldquo;1440x900_60.00&rdquo;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Configure the network:    
</span></code></pre></td></tr></table></div></figure>


<p>$ cat /etc/sysconfig/network-scripts/route-enp2s0
172.xx.0.0/16 via 192.168.0.xxx dev enp2s0
$ sudo  systemctl restart network</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 68. Systemd tips
</span><span class='line'>View specified PID status.   
</span></code></pre></td></tr></table></div></figure>


<h1>systemctl status systemd-logind.service</h1>

<p>root:~/ # journalctl _PID=403</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 69. systemd networkd and resolvd
</span><span class='line'>Configuration files are listed as following:    
</span></code></pre></td></tr></table></div></figure>


<p>$ pwd
/etc/systemd/network
$ ls
MyBridge.netdev  MyBridge.network  MyEth.network</p>

<p>$ cat MyBridge.netdev
[NetDev]
Name=br0
MACAddress=xx:xx:xx:xx:xx
Kind=bridge</p>

<p>$ cat MyBridge.network
[Match]
Name=br0</p>

<p>[Network]
DNS=180.76.76.76,223.5.5.5</p>

<p>[Address]
Address=192.168.1.11/24</p>

<p>[Route]
Gateway=192.168.1.1</p>

<p>$ cat MyEth.network
[Match]
Name=enp0s25</p>

<p>[Network]
Bridge=br0</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Enable the systemd service:    
</span></code></pre></td></tr></table></div></figure>


<p>$ sudo systemctl enable systemd-networkd.service
$ sudo systemctl enable systemd-resolved.service
$ sudo  ln -s /run/systemd/resolve/resolv.conf /etc/resolv.conf</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 70. Quickly install vbox extensional 
</span></code></pre></td></tr></table></div></figure>


<p>sudo  VBoxManage extpack install ./Oracle_VM_VirtualBox_Extension_Pack-5.0.0-101573.vbox-extpack</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 71. VNC With Specified Language
</span></code></pre></td></tr></table></div></figure>


<h1>export LANG=zh_CN.utf8</h1>

<h1>vncserver</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Then your vnc will start with zh support.    
</span><span class='line'>
</span><span class='line'>### 72. Proxy With Username/Passwd
</span></code></pre></td></tr></table></div></figure>


<h1>export http_proxy=<a href="http://easwy:123456@192.168.1.1:8080">http://easwy:123456@192.168.1.1:8080</a></h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 73. Combine DVD files
</span><span class='line'>
</span><span class='line'>[https://wiki.centos.org/TipsAndTricks/CDtoDVDMedia](https://wiki.centos.org/TipsAndTricks/CDtoDVDMedia)   
</span><span class='line'>
</span><span class='line'>### 74. Nested CPU For CentOS 7
</span><span class='line'>
</span><span class='line'>[http://www.server-world.info/en/note?os=CentOS_7&p=kvm&f=7](http://www.server-world.info/en/note?os=CentOS_7&p=kvm&f=7)    
</span><span class='line'>
</span><span class='line'>### 75. Add Tag/Branch For Git
</span><span class='line'>Added tag for the last commit:    
</span></code></pre></td></tr></table></div></figure>


<h1>git log</h1>

<h1>git tag -a V1.0 0293c397f62e5b2c025a35615c046fb0ecb40a2f</h1>

<h1>git push &ndash;tags</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>Create a new branch for name version1:    
</span></code></pre></td></tr></table></div></figure>


<h1>git branch version1</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>View all of the branches, and checkout to the specified branch:    
</span></code></pre></td></tr></table></div></figure>


<h1>git branch</h1>

<h1>git checkout master</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>Once you want to delete the branch:    
</span></code></pre></td></tr></table></div></figure>


<h1>git branch -d checkout</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>Commit all of the changes to remote:     
</span></code></pre></td></tr></table></div></figure>


<h1>git push &ndash;all -u</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 76. Auto wrap
</span></code></pre></td></tr></table></div></figure>


<h1>vim ~/.vimrc</h1>

<p>set textwidth=78
set wrap</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>For chinese Wrapped:    
</span></code></pre></td></tr></table></div></figure>


<p>&ldquo; Wrap for Chinese
set formatoptions+=mM</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 77. More Detailed Systemd
</span><span class='line'>Will display more detailed infos via:    
</span></code></pre></td></tr></table></div></figure>


<h1>journalctl -r</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 78. On Build CloudStack
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://giraffeforestg.blog.fc2.com/blog-entry-194.html">http://giraffeforestg.blog.fc2.com/blog-entry-194.html</a>
<a href="http://cloudstack-administration.readthedocs.org/en/latest/templates.html">http://cloudstack-administration.readthedocs.org/en/latest/templates.html</a>
<a href="http://cloudstack-installation.readthedocs.org/en/latest/building_from_source.html#prerequisites-for-building-apache-cloudstack">http://cloudstack-installation.readthedocs.org/en/latest/building_from_source.html#prerequisites-for-building-apache-cloudstack</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 79. CloudInit
</span></code></pre></td></tr></table></div></figure>


<p><a href="http://shankerbalan.net/blog/cloud-init-supports-cloudstack-as-data-source/">http://shankerbalan.net/blog/cloud-init-supports-cloudstack-as-data-source/</a>
<a href="http://www.slideshare.net/shankerbalan/creating-centos-template-for-cloudstack">http://www.slideshare.net/shankerbalan/creating-centos-template-for-cloudstack</a>
<a href="http://serverfault.com/questions/622707/cloud-init-does-not-grow-the-partition-nor-the-filesystem">http://serverfault.com/questions/622707/cloud-init-does-not-grow-the-partition-nor-the-filesystem</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>### 80. View VNC Port
</span></code></pre></td></tr></table></div></figure>


<p>[root@csagent ~]# virsh list</p>

<h2> Id    Name                           State</h2>

<p> 2     v-1-VM                         running
 3     s-2-VM                         running
 4     r-7-VM                         running
 6     i-2-9-VM                       running</p>

<p>[root@csagent ~]# virsh vncdisplay i-2-9-VM
192.168.139.3:3</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>Then you could view it via vncviewer. Get the password for vnc via:   
</span></code></pre></td></tr></table></div></figure>


<p>$ virsh edit 6
xxxxxx
$ vncviewer 192.168.139.3:3
```</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/25/for-deploying-148-tips/">For Deploying 148 Tips</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-25T11:56:41+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:56 am</span></time>
        
         | <a href="/blog/2015/06/25/for-deploying-148-tips/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The whole deployment procedure is listed as following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cobbler system add --name=node148 --profile=CentOS-6.5-x86_64 --mac=52:54:00:9e:ea:58 --interface=eth0 --ip-address=10.47.58.148 --hostname=node148 --gateway=10.47.58.1 --dns-name=node148
</span><span class='line'># vim /root/Code/Ansible/hosts
</span><span class='line'>[node148]
</span><span class='line'>10.47.58.148
</span><span class='line'># ssh-keyscan 10.47.58.148&gt;&gt;/root/.ssh/known_hosts 
</span><span class='line'># ansible-playbook /root/Code/Ansible/ssh-addkey.yml --ask-pass
</span><span class='line'># vim /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml
</span><span class='line'>      ManagementIP: 10.47.58.148
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node148 /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml --tags=pip
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node148 /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml --tags=base
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node148 /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml --tags=mysql
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node148 /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml --tags=mysql3306
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node148 /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml --tags=csmanagement</span></code></pre></td></tr></table></div></figure>


<p>Or, all-in-one for tags:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node149 /root/Code/Ansible/CloudStack-Ansible-Playbook/cloudstack.yml --tags=pip,base,mysql,mysql3306,csmanagement </span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/24/wh-worktips-6/">WH Worktips(6)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-24T11:54:12+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:54 am</span></time>
        
         | <a href="/blog/2015/06/24/wh-worktips-6/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Migration</h3>

<p>So this time we will migrate the whole machine, that is the Cobbler Server from one physical machine to another one. The steps are:  <br/>
1. Transfer the harddisk files.   <br/>
2. Edit the <code>/etc/udev/rules.d/70-persistent-net.rules</code>, Change the eth1 to eth0, and remove the eth0 item.  <br/>
3. Edit the <code>/etc/sysconfig/network-scripts/ifcfg-eth0</code>, its mac address to the one you specified on step 2.   <br/>
4. Restart the machine.</p>

<h3>Modification &amp;&amp; Test</h3>

<p>Create a new machine, which mac address is <code>52:54:00:3a:87:4e</code>, and define it on Cobbler server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@z_WHServer ~]# cobbler system add --name=node147 --profile=CentOS-6.5-x86_64 --mac=52:54:00:3a:87:4e --interface=eth0 --ip-address=10.47.58.147 --hostname=node147 --gateway=10.47.58.1 --dns-name=node147</span></code></pre></td></tr></table></div></figure>


<p>Now bootup the machine and let it be deployed by cobbler server. The deployment time depends on your disk speed.</p>

<p>At the same time, edit the Ansible configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@z_WHServer Ansible]# cat hosts
</span><span class='line'>[node147]
</span><span class='line'>10.47.58.147
</span><span class='line'>[root@z_WHServer Ansible]# pwd
</span><span class='line'>/root/Code/Ansible</span></code></pre></td></tr></table></div></figure>


<p>Copy the repository to the <code>10.47.58.2:/var/www/html/</code>, and edit the Ansible configuration.   <br/>
And Also configure the nfs server for the second host, previously we use the one we got from the external nfs server.  <br/>
Also the download vhd template files.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ scp -r ./4.4/ root@10.47.58.2:/var/www/html/
</span><span class='line'>[root@z_WHServer html]# chmod 777 -R 4.4
</span><span class='line'>[root@z_WHServer CloudStack-Ansible-Playbook]# vim templates/cloudstack.repo.j2
</span><span class='line'>[cloudstack]
</span><span class='line'>name=cloudstack
</span><span class='line'>baseurl=http://10.47.58.2/4.4/
</span><span class='line'>clouder@pc121:/home/juju$ scp ./systemvm64template-* root@10.47.58.2:/var/www/html/
</span><span class='line'>root@10.47.58.2's password: 
</span><span class='line'>systemvm64template-2014-06-23-master-xen.vhd.bz2                                                             100%  237MB  59.4MB/s   00:04 
</span><span class='line'>systemvm64template-4.4.1-7-kvm.qcow2.bz2                                                                     100%  291MB  36.4MB/s   00:08
</span><span class='line'>clouder@pc121:/home/juju$ scp ./vhd-util root@10.47.58.2:/var/www/html/
</span><span class='line'>[root@z_WHServer html]# chmod 777 systemvm64template-*
</span><span class='line'>[root@z_WHServer html]# chmod 777 vhd-util
</span><span class='line'>[root@z_WHServer html]# vim /etc/exports 
</span><span class='line'>/home/export *(rw,async,no_root_squash,no_subtree_check)
</span><span class='line'>[root@z_WHServer html]# mkdir -p /home/export
</span><span class='line'>[root@z_WHServer html]# chmod 777 -R /home/export/
</span><span class='line'>[root@z_WHServer html]# chkconfig nfs on
</span><span class='line'>[root@z_WHServer html]# chkconfig rpcbind on
</span><span class='line'>[root@z_WHServer html]# service nfs restart
</span><span class='line'>[root@z_WHServer html]# service rpcbind restart
</span><span class='line'>[root@z_WHServer html]# iptables -D INPUT -j REJECT --reject-with icmp-host-prohibited
</span><span class='line'>[root@z_WHServer home]# chown -R nobody /home/export/
</span><span class='line'>[root@z_WHServer CloudStack-Ansible-Playbook]# vim cloudstack.yml
</span><span class='line'>.......
</span><span class='line'>    CSManagement:
</span><span class='line'>      ManagementIP: 10.47.58.147
</span><span class='line'>      SecondaryMount: /secondary
</span><span class='line'>      NFSHost: 10.47.58.2
</span><span class='line'>      NFSSecondaryShare: /home/export
</span><span class='line'>      SysTemplateURLurl43: http://10.47.58.2/systemvm64template-2014-06-23-master-xen.vhd.bz2
</span><span class='line'>      SysTemplateURLurl44: http://10.47.58.2/systemvm64template-4.4.1-7-kvm.qcow2.bz2 
</span><span class='line'>      SysTemplateURLhv: xenserver
</span><span class='line'>      VhdutilURL: http://10.47.58.2/vhd-util
</span><span class='line'>.....</span></code></pre></td></tr></table></div></figure>


<p>Now deploy the playbooks via the same process in:   <br/>
<a href="http://purplepalmdash.github.io/blog/2015/06/19/wh-worktips-4/">http://purplepalmdash.github.io/blog/2015/06/19/wh-worktips-4/</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd /root/Code/Ansible/CloudStack-Ansible-Playbook
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=pip
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=base
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=mysql
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=mysql3306
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=csmanagement </span></code></pre></td></tr></table></div></figure>


<p>Visit
<a href="http://10.47.58.147:8080/client">http://10.47.58.147:8080/client</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/24/install-newest-version-of-cobbler/">Install Newest Version of Cobbler</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-24T09:38:50+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:38 am</span></time>
        
         | <a href="/blog/2015/06/24/install-newest-version-of-cobbler/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Background</h3>

<p>Cobbler has changed its homepage from <code>www.cobblerd.org</code> to <code>http://cobbler.github.io/</code>, thus some configuration will be be failed. In order to solve these problems, we have to upgrade to the newest version, current newest version is <code>2.6.9</code>.</p>

<h3>Download And Install</h3>

<p>Go to <a href="http://cobbler.github.io/downloads/2.6.x.html">http://cobbler.github.io/downloads/2.6.x.html</a> for selecting your distribution, and download them to your folder. Mine is configured via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/CentOS_CentOS-6/home:libertas-ict:cobbler26.repo
</span><span class='line'>$ cp home\:libertas-ict\:cobbler26.repo /etc/yum.repos.d/cobbler26.repo
</span><span class='line'>$ yum install -y cobbler cobbler-web</span></code></pre></td></tr></table></div></figure>


<h3>Configuration</h3>

<p>After installation, configure your newest cobbler via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cobbler sync
</span><span class='line'>$ reboot
</span><span class='line'>$ cobbler signature update</span></code></pre></td></tr></table></div></figure>


<p>By updating the signature of the cobbler, the newest system will be supported, like Ubuntu15.04, etc.</p>

<p>You can also update all of the loaders via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cobbler get-loaders --force
</span><span class='line'># cobbler sync</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/23/import-more-isos-in-cobbler/">Import More ISOs in Cobbler</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-23T20:52:09+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>23</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>8:52 pm</span></time>
        
         | <a href="/blog/2015/06/23/import-more-isos-in-cobbler/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Ubuntu12.04</h3>

<p>Since you have the iso files, import it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer iso]# mount -t iso9660 -o loop /mnt/iso/ubuntu-12.04.3-server-amd64.iso /mnt1
</span><span class='line'>[root@CobblerServer iso]# cobbler import --name=Ubuntu-12.04 --arch=x86_64 --path=/mnt1/
</span><span class='line'>[root@CobblerServer iso]# cobbler profile list
</span><span class='line'>   CentOS-7-x86_64
</span><span class='line'>   Ubuntu-12.04-x86_64
</span><span class='line'>   Ubuntu14.04-x86_64</span></code></pre></td></tr></table></div></figure>


<p>To make it quickly deployment, visit:    <br/>
<a href="http://purplepalmdash.github.io/blog/2015/05/18/my-configuration-on-cobbler-for-deploying-ubuntu12-dot-04/">http://purplepalmdash.github.io/blog/2015/05/18/my-configuration-on-cobbler-for-deploying-ubuntu12-dot-04/</a></p>

<p>Edit its profile like following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer kickstarts]# cobbler profile edit --name=Ubuntu-12.04-x86_64 --kickstart=/var/lib/cobbler/kickstarts/ubuntu1204.seed </span></code></pre></td></tr></table></div></figure>


<p>Create a new virtual machine for testing.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer kickstarts]# cobbler system add --name=test1204 --profile=Ubuntu-12.04-x86_64 --mac=52:54:00:e4:2c:df --interface=eth0 --ip-address=10.3.3.33 --hostname=test1204 --gateway=10.3.3.1 --dns-name=test1204</span></code></pre></td></tr></table></div></figure>


<p>Testing the tftpserver via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[dash@~]$ tftp 10.3.3.3   
</span><span class='line'>tftp&gt; get /pxelinux.0
</span><span class='line'>tftp&gt; quit
</span><span class='line'>[dash@~]$ ls pxelinux.0 
</span><span class='line'>pxelinux.0</span></code></pre></td></tr></table></div></figure>


<p>Trouble-Shooting, you should very careful on your pxelinux.0 file, make sure you have the correct ones. Recently it&rsquo;s hard to get the right pxelinux.0 from cobbler loader sync.</p>

<h3>Ubuntu15.04</h3>

<p>Import the iso via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer iso]# mount -t iso9660 -o loop ./ubuntu-15.04-server-amd64.iso /mnt1/
</span><span class='line'>[root@CobblerServer iso]# cobbler import --name=Ubuntu-15.04 --arch=x86_64 --path=/mnt1</span></code></pre></td></tr></table></div></figure>


<p>Notice, here you will met Signature mismatch problem, do following:   <br/>
First update Cobbler: ?</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vim /etc/yum.repos.d/cobbler26.repo
</span><span class='line'>[home_libertas-ict_cobbler26]
</span><span class='line'>name=Cobbler (2.6.x) (CentOS_CentOS-6)
</span><span class='line'>type=rpm-md
</span><span class='line'>baseurl=http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/CentOS_CentOS-6/
</span><span class='line'>gpgcheck=1
</span><span class='line'>gpgkey=http://download.opensuse.org/repositories/home:/libertas-ict:/cobbler26/CentOS_CentOS-6/repodata/repomd.xml.key
</span><span class='line'>enabled=1
</span><span class='line'>$ sudo yum install -y cobbler cobbler-web</span></code></pre></td></tr></table></div></figure>


<p>And Trouble-Shooting for iptables(If you use redsocks):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># iptables -t nat -I OUTPUT -d 10.3.3.0/24 -j RETURN</span></code></pre></td></tr></table></div></figure>


<p>Then signature update will OK:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer redsocks]# cobbler signature update
</span><span class='line'>task started: 2015-06-23_144247_sigupdate
</span><span class='line'>task started (id=Updating Signatures, time=Tue Jun 23 14:42:47 2015)
</span><span class='line'>Successfully got file from http://cobbler.github.com/signatures/2.6.x/latest.json
</span><span class='line'>*** TASK COMPLETE ***
</span></code></pre></td></tr></table></div></figure>


<p>Re-import:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer iso]# cobbler import --name=Ubuntu-12.04 --arch=x86_64 --path=/mnt1/
</span><span class='line'>*** TASK COMPLETE ***
</span><span class='line'>[root@CobblerServer mnt]# cobbler profile list
</span><span class='line'>   CentOS-7-x86_64
</span><span class='line'>   Ubuntu-12.04-x86_64
</span><span class='line'>   Ubuntu-15.04-x86_64
</span><span class='line'>   Ubuntu14.04-x86_64</span></code></pre></td></tr></table></div></figure>


<p>Edit the profile via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@CobblerServer lib]# cd /var/lib/cobbler/kickstarts/
</span><span class='line'>[root@CobblerServer kickstarts]# ls
</span><span class='line'>default.ks    esxi5-ks.cfg      legacy.ks     sample_autoyast.xml  sample_esx4.ks   sample_esxi5.ks  sample_old.seed  ubuntu1204.seed
</span><span class='line'>esxi4-ks.cfg  install_profiles  pxerescue.ks  sample_end.ks        sample_esxi4.ks  sample.ks        sample.seed
</span><span class='line'>[root@CobblerServer kickstarts]# vim ubuntu1504.seed</span></code></pre></td></tr></table></div></figure>


<p>Test it via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ qemu-img create -f qcow2 Cobbler1504Test.qcow2 100G
</span><span class='line'>$ cobbler profile edit --name=Ubuntu-15.04-x86_64 --kickstart=/var/lib/cobbler/kickstarts/ubuntu1504.seed
</span><span class='line'>$  cobbler system add --name=test1504 --profile=Ubuntu-15.04-x86_64 --mac=52:54:00:2e:c0:ff --interface=eth0 --ip-address=10.3.3.34 --hostname=test1504 --gateway=10.3.3.1 --dns-name=test1504
</span></code></pre></td></tr></table></div></figure>


<p>Installed failed, verify it tomorrow.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/19/wh-worktips-5/">WH Worktips(5)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-19T15:29:56+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:29 pm</span></time>
        
         | <a href="/blog/2015/06/19/wh-worktips-5/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This worktips will enable the visibility for ansible deployed nodes.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@z_WHServer Code]# cd ansible-tower-setup-2.1.5/
</span><span class='line'>[root@z_WHServer ansible-tower-setup-2.1.5]# ls
</span><span class='line'>ansible.cfg  configure  group_vars  host_vars  README.md  roles  setup.sh  site.yml</span></code></pre></td></tr></table></div></figure>


<p>Later I will finish this. But remember the tutorial pdf works well.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/19/wh-worktips-4/">WH Worktips(4)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-19T11:32:04+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:32 am</span></time>
        
         | <a href="/blog/2015/06/19/wh-worktips-4/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>A Whole Deployment</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pwd
</span><span class='line'>/home/juju/img/WolfHunter/WH
</span><span class='line'>$ qemu-img create -f qcow2 z_Node113.qcow2 100G
</span><span class='line'>$ </span></code></pre></td></tr></table></div></figure>


<p>Create Virtual Machine:</p>

<p><img src="/images/2015_06_19_11_39_45_474x366.jpg" alt="/images/2015_06_19_11_39_45_474x366.jpg" /></p>

<p>Memory:</p>

<p><img src="/images/2015_06_19_11_40_51_477x363.jpg" alt="/images/2015_06_19_11_40_51_477x363.jpg" /></p>

<p><img src="/images/2015_06_19_11_41_58_482x369.jpg" alt="/images/2015_06_19_11_41_58_482x369.jpg" /></p>

<p>Click <code>Customize configuration before install</code>:</p>

<p>VirtIO Disk 1:</p>

<p><img src="/images/2015_06_19_11_43_22_478x309.jpg" alt="/images/2015_06_19_11_43_22_478x309.jpg" /></p>

<p>Virtual Network Interface:</p>

<p><img src="/images/2015_06_19_11_44_12_553x205.jpg" alt="/images/2015_06_19_11_44_12_553x205.jpg" /></p>

<p>Notice the mac address is <code>52:54:00:9a:73:1a</code>.</p>

<h3>Cobbler Customization</h3>

<p>Define the node:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@z_WHServer ~]#  cobbler system add --name=node113 --profile=CentOS-6.5-x86_64 --mac=52:54:00:9a:73:1a --interface=eth0 --ip-address=10.47.58.113 --hostname=node113 --gateway=10.47.58.1 --dns-name=node113</span></code></pre></td></tr></table></div></figure>


<h3>Begin Installation</h3>

<p><img src="/images/2015_06_19_11_49_09_685x401.jpg" alt="/images/2015_06_19_11_49_09_685x401.jpg" /></p>

<h3>Configure</h3>

<p>Notice the ssh failed to 112 because we poweroff this node.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh-keyscan 10.47.58.113&gt;&gt;/root/.ssh/known_hosts 
</span><span class='line'># 10.47.58.113 SSH-2.0-OpenSSH_5.3
</span><span class='line'>
</span><span class='line'># cd /root/Code/Ansible
</span><span class='line'># ansible-playbook ssh-addkey.yml --ask-pass
</span><span class='line'>SSH password: 
</span><span class='line'>
</span><span class='line'>PLAY [all] ******************************************************************** 
</span><span class='line'>
</span><span class='line'>TASK: [install ssh key] ******************************************************* 
</span><span class='line'>changed: [10.47.58.113]
</span><span class='line'>fatal: [10.47.58.112] =&gt; SSH Error: ssh: connect to host 10.47.58.112 port 22: Connection timed out
</span><span class='line'>    while connecting to 10.47.58.112:22
</span><span class='line'>It is sometimes useful to re-run the command using -vvvv, which prints SSH debug output to help diagnose the issue.
</span><span class='line'>
</span><span class='line'>PLAY RECAP ******************************************************************** 
</span><span class='line'>           to retry, use: --limit @/root/ssh-addkey.retry
</span><span class='line'>
</span><span class='line'>10.47.58.112               : ok=0    changed=0    unreachable=1    failed=0   
</span><span class='line'>10.47.58.113               : ok=1    changed=1    unreachable=0    failed=0  </span></code></pre></td></tr></table></div></figure>


<p>Check:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># ansible all -m shell -a "uptime"
</span><span class='line'>10.47.58.113 | success | rc=0 &gt;&gt;
</span><span class='line'> 04:32:21 up 32 min,  3 users,  load average: 0.00, 0.00, 0.00
</span><span class='line'>
</span><span class='line'>10.47.58.112 | FAILED =&gt; SSH Error: ssh: connect to host 10.47.58.112 port 22: No route to host
</span><span class='line'>    while connecting to 10.47.58.112:22
</span><span class='line'>It is sometimes useful to re-run the command using -vvvv, which prints SSH debug output to help diagnose the issue.</span></code></pre></td></tr></table></div></figure>


<p>Deployed via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cd /root/Code/Ansible/CloudStack-Ansible-Playbook
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=base
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=mysql
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=mysql3306
</span><span class='line'># ansible-playbook -i /root/Code/Ansible/hosts --limit=node113 ./cloudstack.yml --tags=csmanagement -vvvv</span></code></pre></td></tr></table></div></figure>


<p>Now you could enjoy a new node&rsquo;s ansible deployment.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/18/use-virtualenv-for-downloading-pip-packages/">Use VirtualEnv for Downloading PIP Packages</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-18T20:56:30+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:56 pm</span></time>
        
         | <a href="/blog/2015/06/18/use-virtualenv-for-downloading-pip-packages/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In order to use offline installation of pip, I tried following steps for retrieving the packages.</p>

<h3>Fetch Packages</h3>

<p>First install virtualenv packages on CentOS7.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo yum install -y python-virtualenv
</span><span class='line'>$ virtualenv venv
</span><span class='line'>New python executable in venv/bin/python
</span><span class='line'>Installing Setuptools..............................................................................................................................................................................................................................done.
</span><span class='line'>Installing Pip.....................................................................................................................................................................................................................................................................................................................................done.
</span><span class='line'>$ ls venv
</span><span class='line'>bin  include  lib  lib64
</span><span class='line'>$ source venv/bin/activate
</span><span class='line'>(venv)$      
</span><span class='line'>(venv)$ pip install --download-cache=/home/dash/pipcache cloudmonkey
</span><span class='line'>(venv)$ ls pipcache/
</span><span class='line'>https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fa%2Fargcomplete%2Fargcomplete-0.8.9.tar.gz
</span><span class='line'>https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fa%2Fargcomplete%2Fargcomplete-0.8.9.tar.gz.content-type
</span><span class='line'>https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fc%2Fcloudmonkey%2Fcloudmonkey-5.3.1-0.tar.gz
</span><span class='line'>https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fc%2Fcloudmonkey%2Fcloudmonkey-5.3.1-0.tar.gz.content-type
</span><span class='line'>https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2FP%2FPrettyTable%2Fprettytable-0.7.2.tar.bz2
</span><span class='line'>......
</span><span class='line'>(venv)$ mkdir ~/pipcache2
</span><span class='line'>(venv)$ pip install cloudmonkey --download=/home/dash/pipcache2
</span><span class='line'>(venv)$ ls pipcache2
</span><span class='line'>argcomplete-0.8.9.tar.gz    Pygments-2.0.2.tar.gz
</span><span class='line'>cloudmonkey-5.3.1-0.tar.gz  requests-2.7.0.tar.gz
</span><span class='line'>prettytable-0.7.2.tar.bz2</span></code></pre></td></tr></table></div></figure>


<h3>Use Packages</h3>

<p>In order to use packages, we did following things.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ scp xxx@xxx.xxx.xxx.xx:/home/xxx/pipcache2.tar.gz ./
</span><span class='line'>$ tar xzvf pipcache2.tar.gz 
</span><span class='line'>$ pip install --no-index --find-links ~/pipcache2 cloudmonkey</span></code></pre></td></tr></table></div></figure>


<p>Now the package has been installed. enjoy them.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/18/wh-worktips-3/">WH Worktips(3)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-18T15:50:11+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:50 pm</span></time>
        
         | <a href="/blog/2015/06/18/wh-worktips-3/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Prepare Packages</h3>

<h4>System Pacakges</h4>

<p>Since CentOS6.5 already deprecated, we need to use <code>http://vault.centos.org/6.5/</code> for download the packages.  <br/>
Or we could remove all of the repo definition files except the cobbler deployed one.</p>

<p>We need python-pip for usage. Download it via yum firstly to the directory.</p>

<p>Download the following packages, these packages may have problems because I downloaded them from the latest repository.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ yum install yum-plugin-downloadonly
</span><span class='line'>$ yum install --downloadonly --downloaddir=/root/Code/repo/ python-pip
</span><span class='line'>$ yum install --downloadonly --downloaddir=/root/Code/repo/ nethogs
</span><span class='line'>$ yum reinstall --downloadonly --downloaddir=/root/Code/repo/ java7
</span><span class='line'>$ yum reinstall --downloadonly --downloaddir=/root/Code/repo/ mysql-devel
</span><span class='line'>$ yum install --downloadonly --downloaddir=/root/Code/repo/ java-1.7.0-openjdk-devel
</span><span class='line'>$ yum install --downloadonly --downloaddir=/root/Code/repo/ mysql-server
</span><span class='line'>$ yum install --downloadonly --downloaddir=/root/Code/repo/ mysql-devel
</span><span class='line'>[root@z_WHServer repo]# ls
</span><span class='line'>python-pip-1.3.1-4.el6.noarch.rpm
</span><span class='line'>....</span></code></pre></td></tr></table></div></figure>


<h4>Cloudstack Packages</h4>

<p>Download all of the cloudstack packages from <code>http://cloudstack.apt-get.eu/rhel/4.4/</code>, and put them into a directory, run <code>createrepo</code> for generating the repodata.</p>

<h4>PIP Packages</h4>

<p>Manually create the offline installation resources.</p>

<h3>Deployment</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#  ansible-playbook -i /root/Code/Ansible/hosts --limit=node112 ./cloudstack.yml --tags=base
</span><span class='line'>#  ansible-playbook -i /root/Code/Ansible/hosts --limit=node112 ./cloudstack.yml --tags=mysql
</span><span class='line'>#  ansible-playbook -i /root/Code/Ansible/hosts --limit=node112 ./cloudstack.yml --tags=mysql3306
</span><span class='line'>#  ansible-playbook -i /root/Code/Ansible/hosts --limit=node112 ./cloudstack.yml --tags=csmanagement -vvvv</span></code></pre></td></tr></table></div></figure>


<p>
There may be some problems in deployment in <code>/etc/hosts</code>, so manually add itself to the hostname:  <br/>
!!! node112 !!!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@node112 yum.repos.d]# cat /etc/hosts
</span><span class='line'>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
</span><span class='line'>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
</span><span class='line'>10.47.58.112    node112</span></code></pre></td></tr></table></div></figure>


<p>From now on, you could visit the management server via:</p>

<p><a href="http://10.47.58.112:8080/client/">http://10.47.58.112:8080/client/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/18/wh-worktips-2/">WH Worktips(2)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-18T10:20:48+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:20 am</span></time>
        
         | <a href="/blog/2015/06/18/wh-worktips-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Cobbler Web</h3>

<p>Visit the following website:</p>

<p><a href="http://10.47.58.2/cobbler_web">http://10.47.58.2/cobbler_web</a></p>

<p>You will see:</p>

<p><img src="/images/2015_06_18_10_21_45_755x413.jpg" alt="/images/2015_06_18_10_21_45_755x413.jpg" /></p>

<h3>Added More Profiles</h3>

<p>The default kickstart configuration file could found under:   <br/>
<code>/var/lib/cobbler/kickstarts/sample_end.ks</code>, copy it to your own.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cp /var/lib/cobbler/kickstarts/sample_end.ks CentOS65Desktop.cfg
</span><span class='line'>$ vim CentOS65Desktop.cfg
</span><span class='line'># Allow anaconda to partition the system as needed
</span><span class='line'># autopart
</span><span class='line'># 1G Swap and remains others to be ext4
</span><span class='line'>part swap --fstype="swap" --size=1024
</span><span class='line'>part / --asprimary --fstype="ext4" --grow --size=1
</span><span class='line'>.......
</span><span class='line'>%packages
</span><span class='line'># Added from here
</span><span class='line'>@additional-devel
</span><span class='line'>@basic-desktop
</span><span class='line'>@chinese-support
</span><span class='line'>@desktop-platform
</span><span class='line'>@development
</span><span class='line'>@fonts
</span><span class='line'>@general-desktop
</span><span class='line'>@input-methods
</span><span class='line'>@x11
</span><span class='line'>git
</span><span class='line'>-ibus-table-cangjie
</span><span class='line'>-ibus-table-erbi
</span><span class='line'>-ibus-table-wubi
</span><span class='line'># End of added
</span><span class='line'>$SNIPPET('func_install_if_enabled')
</span><span class='line'>%end
</span></code></pre></td></tr></table></div></figure>


<p>More configurations could be customized.</p>

<h3>Fixed IP Address Via DHCP</h3>

<p>By adding the configuration in dhcp configuration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo vim /etc/cobbler/dhcp.template
</span><span class='line'>     max-lease-time             43200;      
</span><span class='line'>     next-server                $next_server; 
</span><span class='line'>
</span><span class='line'>     host ns111 {
</span><span class='line'>         next-server $next_server;
</span><span class='line'>         hardware ethernet 52:54:00:e0:cc:18;
</span><span class='line'>         fixed-address 10.47.58.111;
</span><span class='line'>     }
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>     class "pxeclients" {
</span><span class='line'>$ sudo cobbler sync</span></code></pre></td></tr></table></div></figure>


<p>Now restart the deployed node, you will easily see the node.</p>

<h3>Specify Fixed IP For Host</h3>

<p>Add the configration of the node112, then this machine will start with our specified parameters:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cobbler system add --name=node112 --profile=CentOS6.5-Desktop --mac=52:54:00:92:8c:4d --interface=eth0 --ip-address=10.47.58.112 --hostname=node112 --gateway=10.47.58.1 --dns-name=node112</span></code></pre></td></tr></table></div></figure>


<p>Now bootup the machine, then this computer will have the fixed IP address.</p>

<p><img src="/images/2015_06_18_11_38_48_794x263.jpg" alt="/images/2015_06_18_11_38_48_794x263.jpg" /></p>

<h3>Use Ansible For Administrate The Added Nodes</h3>

<p>Install ansible via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># yum install -y ansible sshpass
</span><span class='line'># vim /etc/hosts
</span><span class='line'>10.47.58.112    node112
</span><span class='line'>
</span><span class='line'># mkdir -p ~/Code/Ansible
</span><span class='line'># cd ~/Code/Ansible
</span><span class='line'># vim ansible.cfg
</span><span class='line'>    [defaults]
</span><span class='line'>    hostfile=/root/Code/Ansible/hosts
</span><span class='line'>
</span><span class='line'># vim hosts
</span><span class='line'>    [node112]
</span><span class='line'>    10.47.58.112
</span><span class='line'>
</span><span class='line'># vim ssh-addkey.yml
</span><span class='line'>    ---
</span><span class='line'>    - hosts: all
</span><span class='line'>      sudo: yes
</span><span class='line'>      gather_facts: no
</span><span class='line'>      remote_user: root
</span><span class='line'>    
</span><span class='line'>      tasks:
</span><span class='line'>    
</span><span class='line'>      - name: install ssh key
</span><span class='line'>        authorized_key: user=root
</span><span class='line'>                        key="" 
</span><span class='line'>                        state=present
</span><span class='line'>
</span><span class='line'># ssh-keyscan 10.47.58.112&gt;&gt;/root/.ssh/known_hosts
</span><span class='line'># ansible-playbook ssh-addkey.yml --ask-pass</span></code></pre></td></tr></table></div></figure>


<p>Now the node112 is under controlled by you.  <br/>
Take refers to:  <br/>
<a href="https://sysadmincasts.com/episodes/45-learning-ansible-with-vagrant-part-2-4">https://sysadmincasts.com/episodes/45-learning-ansible-with-vagrant-part-2-4</a></p>

<p>Test via:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@z_WHServer Ansible]# ansible all -m shell -a "uptime"
</span><span class='line'>10.47.58.112 | success | rc=0 &gt;&gt;
</span><span class='line'> 06:18:59 up  1:32,  2 users,  load average: 0.00, 0.00, 0.00</span></code></pre></td></tr></table></div></figure>


<p>In following parts we will try to deploy Cloudstack using playbook.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/8">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/6">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/10/18/cloudstackonubuntuissue/">CloudStackOnUbuntuIssue</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/17/tips-on-setting-virtual-machine-networking/">Tips on Setting Virtual Machine Networking</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/15/use-openwrt-router-for-lan-forwarding/">Use OpenWRT Router for Lan Forwarding</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/14/tips-for-20151014/">Tips for 20151014</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/10/14/tips-on-cloud-init-and-cloudstack/">Tips on Cloud-Init and CloudStack(2)</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Dash -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'dashsagittariussglory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
